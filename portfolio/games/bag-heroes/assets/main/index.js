System.register("chunks:///_virtual/animationUI.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,o,i,a,c,r,s,l,p;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,i=t.Node,a=t.BlockInputEvents,c=t.UITransform,r=t.UIOpacity,s=t.tween,l=t.v3,p=t.Component}],execute:function(){var d;n._RF.push({},"a05e5ex0PBBGKnHqFKc4eio","animationUI",void 0);var u=o.ccclass;o.property,t("animationUI",u("animationUI")(d=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))||this)._during=.1,e._blocker=null,e}e(n,t);var o=n.prototype;return o.onLoad=function(){var t=this.node.getChildByName("blocker");if(t)this._blocker=t;else{var e=new i("blocker");e.addComponent(a),e.addComponent(c),e.parent=this.node,e.getComponent(c).setContentSize(this.node.getComponent(c).contentSize),this._blocker=e}},o.close=function(t){var e=this;this._blocker.active=!0;var n=this.node.getChildByName("Bg"),o=this.node.getChildByName("Content");n.getComponent(r)||n.addComponent(r),s(n.getComponent(r)).to(this._during,{opacity:0},{easing:"backIn"}).start(),s(o).to(this._during,{scale:l(.5,.5,.5)}).call((function(){e._blocker.active=!1,t&&t()})).start()},o.open=function(t){var e=this;this._blocker.active=!0;var n=this.node.getChildByName("Bg"),o=this.node.getChildByName("Content");n.getComponent(r)?(n.getComponent(r).opacity=0,s(n.getComponent(r)).to(this._during,{opacity:255},{easing:"backOut"}).start()):(n.addComponent(r),n.getComponent(r).opacity=0,s(n.getComponent(r)).to(this._during,{opacity:255},{easing:"backOut"}).start()),o.setScale(.5,.5,.5),s(o).to(this._during,{scale:l(1,1,1)}).call((function(){e._blocker.active=!1,t&&t()})).start()},n}(p))||d);n._RF.pop()}}}));

System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourcesUtil.ts","./CfgMgr.ts","./SoundModel.ts","./Configuration.ts","./Constants.ts"],(function(t){var e,i,s,u,n,o,c,r,a,h,l,d,m,p,f,_;return{setters:[function(t){e=t.createForOfIteratorHelperLoose,i=t.createClass,s=t.asyncToGenerator,u=t.regeneratorRuntime},function(t){n=t.cclegacy,o=t.Node,c=t.director,r=t.Button,t.Toggle,a=t.AudioSource,h=t.assetManager,l=t.AudioClip},function(t){d=t.ResourcesUtil},function(t){m=t.CfgMgr},function(t){p=t.SoundCfg},function(t){f=t.Configuration},function(t){_=t.Constants}],execute:function(){n._RF.push({},"05fc0Ua1slE04pfKYS6Neg/","AudioManager",void 0),t("AudioManager",function(){function t(){this.dictWeaponSoundIndex={},this.mainVolume=1,this._musicVolume=1,this._soundVolume=1,this._musicSwitch=1,this._soundSwitch=1,this._mapSound=new Map,this._mapMusic=new Map,this._persistRootNode=null,this._musicSource=null,this._curSounds=[]}var n=t.prototype;return n.init=function(){this._persistRootNode||(this._persistRootNode=new o("audio"),c.getScene().addChild(this._persistRootNode),c.addPersistRootNode(this._persistRootNode),this.SetButtonSound(),this._musicSwitch=this.getAudioSetting(!0)?1:0,this._soundSwitch=this.getAudioSetting(!1)?1:0,this.soundVolume=1,this.musicVolume=1)},n.SetButtonSound=function(){r.prototype.touchBeganClone||(r.prototype.touchBeganClone=r.prototype._onTouchEnded,r.prototype._onTouchEnded=function(e){this.interactable&&this.enabledInHierarchy&&t.instance.playSound(3),this.touchBeganClone(e)})},n._setCurMusicVolume=function(){for(var t,i=e(this._mapMusic.values());!(t=i()).done;){t.value.volume=this.musicVolume}},n._setCurSoundVolume=function(){for(var t,i=this,s=e(this._mapSound.values());!(t=s()).done;){t.value.forEach((function(t){t.volume=i.soundVolume}))}},n.getAudioSetting=function(t){var e;return!(e=t?f.instance.getConfigData("music"):f.instance.getConfigData("sound"))||"true"===e},n._getAudioSource=function(t){var e,i=this;return this._mapSound.forEach((function(s,u){if(t.name!=u);else if(s.length>0){var n=s.pop();e=n,i._mapSound.set(u,s)}})),e||(e=this._persistRootNode.addComponent(a)),e.clip=t,e.currentTime=0,e},n.playMusic=function(){var t=s(u().mark((function t(e,i,s){var n,o,c,r,h,m;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this._geAudioNameById(e)){t.next=3;break}return t.abrupt("return");case 3:if(o=n.Mp3,c=_.AUDIO_FILE_PATH.MUSIC+o,(r=this._musicSource)&&r.stop(),!r||r.clip.name!=o){t.next=10;break}t.next=23;break;case 10:if(!this._mapMusic.get(o)){t.next=15;break}r&&!this._mapMusic.get(r.clip.name)&&this._mapMusic.set(r.clip.name,r),r=this._mapMusic.get(o),t.next=23;break;case 15:if(h=this._getExistMusicSource(o)){t.next=22;break}return t.next=19,d.loadResNew(c,l);case 19:m=t.sent,(h=this._getExistMusicSource(o))||((h=this._persistRootNode.addComponent(a)).clip=m,this._mapMusic.set(o,h));case 22:r=h;case 23:r.currentTime=0,r.volume=n.Volume*this.musicVolume,r.loop=i,r.playOnAwake=!1,this._musicSource=r,this._musicSwitch&&r.play(),s&&s();case 30:case"end":return t.stop()}}),t,this)})));return function(e,i,s){return t.apply(this,arguments)}}(),n._getExistMusicSource=function(t){for(var e=this._persistRootNode.components.length-1;e>=0;e--){var i=this._persistRootNode.components[e];if(i instanceof a&&i.clip.name==t)return console.log("###已经有这个音乐组件了",t),i}return null},n._geAudioNameById=function(t){return m.getDataById(new p,t)},n.playSound=function(){var t=s(u().mark((function t(e,i,s){var n,o,c,r,a,h=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===i&&(i=!1),n=this._geAudioNameById(e)){t.next=4;break}return t.abrupt("return");case 4:return o=n.Mp3,c=_.AUDIO_FILE_PATH.SOUND+o,t.next=8,d.loadResNew(c,l);case 8:r=t.sent,(a=this._getAudioSource(r)).volume=n.Volume*this.soundVolume,a.loop=i,a.playOnAwake=!1,this._curSounds.push(a),this._soundSwitch&&(a.play(),setTimeout((function(){if(h._curSounds.indexOf(a)>=0&&h._curSounds.splice(h._curSounds.indexOf(a),1),h._mapSound.get(o)){var t=h._mapSound.get(o);t.push(a),h._mapSound.set(o,t)}else h._mapSound.set(o,[a]);null==s||s()}),1e3*a.duration));case 15:case"end":return t.stop()}}),t,this)})));return function(e,i,s){return t.apply(this,arguments)}}(),n.isSoundPlaying=function(t){return this._curSounds.some((function(e){var i;return(null==(i=e.clip)?void 0:i.name)==t}))},n.isMusicExist=function(t){return null!=this._mapMusic.get(t)},n.isMusicPlaying=function(t){return this._musicSource&&this._musicSource.clip.name==t&&this._musicSource.playing},n.preLoadMusics=function(){var t=s(u().mark((function t(e){var i,s,n,o,c,r,h;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=0;case 1:if(!(i<e.length)){t.next=15;break}if(s=e[i],n=this._geAudioNameById(s)){t.next=6;break}return t.abrupt("continue",12);case 6:return o=n.Mp3,c=_.AUDIO_FILE_PATH.MUSIC+o,t.next=10,d.loadResNew(c,l);case 10:(r=t.sent)&&((h=this._persistRootNode.addComponent(a)).clip=r,this._mapMusic.set(o,h));case 12:i++,t.next=1;break;case 15:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.switchMusic=function(t){t?this.resumeMusic():this.stopMusic(),f.instance.setConfigData("music",""+t)},n.switchSound=function(t){t?this.resumeSound():this.pauseSound(),f.instance.setConfigData("sound",""+t)},n.stopAllAudio=function(){this.stopMusic(),this.pauseSound()},n.stopMusic=function(){this._musicSwitch=0,this._musicSource&&this._musicSource.pause()},n.stopAllMusic=function(){for(var t,i=e(this._mapMusic.values());!(t=i()).done;){var s=t.value;s&&s.playing&&s.stop()}},n.destroyMusic=function(){this._musicSource.clip&&(this._mapMusic.has(this._musicSource.clip.name)&&this._mapMusic.delete(this._musicSource.clip.name),this._musicSource&&(this._musicSource.destroy(),this._musicSource=null))},n.pauseSound=function(){this._soundSwitch=0,this._curSounds.forEach((function(t){t.playing&&t.pause()}))},n.stopAllSound=function(){for(var t,i=e(this._mapSound.values());!(t=i()).done;){var s=t.value;s&&s.length&&s.forEach((function(t){t&&t.playing&&t.stop()}))}for(var u=0;u<this._curSounds.length;u++){var n=this._curSounds[u];n&&n.playing&&n.stop()}},n.stopSoundArr=function(t){for(var i,s=e(this._mapSound.values());!(i=s()).done;){var u=i.value;u&&u.length&&u.forEach((function(e){e&&e.playing&&-1!=t.indexOf(e.clip.name)&&e.stop()}))}for(var n=0;n<this._curSounds.length;n++){var o=this._curSounds[n];o&&o.playing&&-1!=t.indexOf(o.clip.name)&&o.stop()}},n.stopMusicArr=function(t){for(var i,s=e(this._mapMusic.values());!(i=s()).done;){var u=i.value;u&&u.playing&&-1!=t.indexOf(u.clip.name)&&u.stop()}},n.resumeAll=function(){this.resumeMusic(),this.resumeSound()},n.resumeMusic=function(){this._musicSwitch=1,this._musicSource&&(this._musicSource.volume=this.musicVolume,this._musicSource.play())},n.resumeSound=function(){var t=this;this._soundSwitch=1,this._curSounds.forEach((function(e){e.state==a.AudioState.PAUSED&&(e.volume=t.soundVolume,e.play())}))},n.removeMusic=function(t){for(var e=0;e<t.length;e++){var i=t[e],s=this._mapMusic.get(i);this._mapMusic.delete(i),s&&(h.releaseAsset(s.clip),s.destroy(),this._mapMusic[i]=null)}},n.removeSound=function(t){for(var e=0;e<t.length;e++){var i=t[e],s=this._mapSound.get(i);s&&s.length&&(this._mapSound.delete(i),s.forEach((function(t){h.releaseAsset(t.clip),t.destroy()})))}},n.setMusic=function(t){this.musicVolume=t;for(var i,s=e(this._mapMusic.values());!(i=s()).done;){var u=i.value;u&&(u.volume=this.musicVolume*this.mainVolume)}},n.setMusicWithoutSave=function(t){for(var i,s=e(this._mapMusic.values());!(i=s()).done;){var u=i.value;u&&(u.volume=t*this.mainVolume)}},n.setSound=function(t){var i=this;this.soundVolume=t;for(var s,u=e(this._mapSound.values());!(s=u()).done;){var n=s.value;n&&n.length&&n.forEach((function(t){t.volume=i.soundVolume*i.mainVolume}))}for(var o=0;o<this._curSounds.length;o++){this._curSounds[o].volume=this.soundVolume*this.mainVolume}},i(t,[{key:"musicSource",get:function(){return this._musicSource}},{key:"musicVolume",get:function(){return this._musicVolume*this._musicSwitch},set:function(t){this._musicVolume=t,this._setCurMusicVolume()}},{key:"soundVolume",get:function(){return this._soundVolume*this._soundSwitch},set:function(t){this._soundVolume=t,this._setCurSoundVolume()}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/BackgroundAdapter.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,o,r,i,a;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,r=t.screen,i=t.UITransform,a=t.Component}],execute:function(){var c;n._RF.push({},"71ae6w0ow1ACok/pAFH3tJT","BackgroundAdapter",void 0);var h=o.ccclass;o.property,t("BackgroundAdapter",h("BackgroundAdapter")(c=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.onLoad=function(){var t=r.windowSize,e=this.node.getComponent(i).contentSize,n=Math.min(t.width/e.width,t.height/e.height),o=e.width*n,a=e.height*n,c=Math.max(t.width/o,t.height/a);this.node.setScale(c,c,c)},n}(a))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/BagModel.ts",["cc"],(function(i){var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"2d3ad7YaddLVaGcEN1TRnbz","BagModel",void 0);i("BagCfg",(function(){this.ClassName="Bag",this.Id=void 0,this.name=void 0,this.private_gridLen=void 0,this.max_gridLen=void 0,this.private_gridWidth=void 0,this.private_gredHeight=void 0,this.private_space=void 0,this.picture=void 0,this.private_grid=void 0,this.max_grid=void 0}));t._RF.pop()}}}));

System.register("chunks:///_virtual/BaseComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameDefine.ts","./GameController.ts"],(function(e){var t,n,i,o,a;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e.Component},function(e){o=e.GameDefine},function(e){a=e.default}],execute:function(){n._RF.push({},"12e28pWfOpKyIbZwZp3vv5F","BaseComponent",void 0);e("default",function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this)._now_time=0,t}t(n,e);var i=n.prototype;return i.childUpdate=function(e){},i.update=function(e){if(!a.pause_data.state_b)for(this._now_time+=e;this._now_time>=o.frameTime;)this.childUpdate(o.frameTime),this._now_time-=o.frameTime},n}(i));n._RF.pop()}}}));

System.register("chunks:///_virtual/BattleLevelModel.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"c25beFq2cdPHpZ9fLzDLadI","BattleLevelModel",void 0);e("BattleLevelCfg",(function(){this.ClassName="BattleLevel",this.Id=void 0,this.Level=void 0,this.Exp=void 0}));t._RF.pop()}}}));

System.register("chunks:///_virtual/BattleUIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventListener.ts","./GameEvent.ts","./PoolManager.ts","./DamageItem.ts","./ResourcesUtil.ts","./BlastItem.ts","./HeroHpItem.ts","./MonsterHpItem.ts","./Constants.ts","./Shadow.ts"],(function(t){var e,a,n,i,o,r,s,l,h,f,b,c,d,m,u,I,g,P,C;return{setters:[function(t){e=t.applyDecoratedDescriptor,a=t.inheritsLoose,n=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,r=t._decorator,s=t.Node,l=t.Vec3,h=t.Component},function(t){f=t.EventListener},function(t){b=t.GameEvent},function(t){c=t.PoolManager},function(t){d=t.DamageItem},function(t){m=t.ResourcesUtil},function(t){u=t.BlastItem},function(t){I=t.HeroHpItem},function(t){g=t.MonsterHpItem},function(t){P=t.Constants},function(t){C=t.Shadow}],execute:function(){var p,_,D,U,H,N,E;o._RF.push({},"8b377pXlFFISI2cYT0s3FLN","BattleUIManager",void 0);var M=r.ccclass,S=r.property;t("BattleUIManager",(p=M("BattleUIManager"),_=S(s),D=S(s),p((N=e((H=function(t){function e(){for(var e,a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o))||this,n(e,"battleUIParent",N,i(e)),n(e,"battleUIDownParent",E,i(e)),e._battlerUIPrefabData=new Map,e._battleUiNode=new Map,e}a(e,t);var o=e.prototype;return o.onEnable=function(){f.on(b.CREATE_DAMAGER_NUM,this.onCreateDamageNum,this),f.on(b.SHOW_MONSTER_DIE_EFFECT,this.onCreateDieEffect,this),f.on(b.SHOW_HERO_HP,this.onCreateHeroHp,this),f.on(b.SHOW_MONSTER_HP,this.onCreateMonsterHp,this),f.on(b.SHOW_MONSTER_SHADOW,this.onCreateMonsterShadow,this)},o.onDisable=function(){f.off(b.CREATE_DAMAGER_NUM,this.onCreateDamageNum,this),f.off(b.SHOW_MONSTER_DIE_EFFECT,this.onCreateDieEffect,this),f.off(b.SHOW_HERO_HP,this.onCreateHeroHp,this),f.off(b.SHOW_MONSTER_HP,this.onCreateMonsterHp,this),f.off(b.SHOW_MONSTER_SHADOW,this.onCreateMonsterShadow,this)},o.onCreateDamageNum=function(t,e,a,n){var i=this,o="damageNum",r=null,s=null;if(this._battlerUIPrefabData.has(o))s=this._battlerUIPrefabData.get(o),r=c.instance.getNodeItem(s),this.battleUIParent.addChild(r),r.setPosition(t),r.getComponent(d).init(e,a);else{var l=P.battlePath+o;m.getPrefab(l).then((function(n){i._battlerUIPrefabData.set(o,n),r=c.instance.getNodeItem(n),i.battleUIParent.addChild(r),r.setPosition(t),r.getComponent(d).init(e,a)}))}},o.onCreateDieEffect=function(t){var e=this,a="blastItem",n=null,i=null,o=this.battleUIDownParent.getChildByName("Die");if(this._battlerUIPrefabData.has(a))i=this._battlerUIPrefabData.get(a),n=c.instance.getNodeItem(i),o.addChild(n),n.setPosition(t),n.getComponent(u).init();else{var r=P.battlePath+a;m.getPrefab(r).then((function(i){e._battlerUIPrefabData.set(a,i),n=c.instance.getNodeItem(i),o.addChild(n),n.setPosition(t),n.getComponent(u).init()}))}},o.onCreateHeroHp=function(t){var e=this,a="heroHpItem",n=null,i=null,o=this.battleUIParent,r=new l(t.x,t.y-30,0);if(this._battlerUIPrefabData.has(a))i=this._battlerUIPrefabData.get(a),n=c.instance.getNodeItem(i),o.addChild(n),n.setPosition(r),n.getComponent(I).init();else{var s=P.battlePath+a;m.getPrefab(s).then((function(t){e._battlerUIPrefabData.set(a,t),n=c.instance.getNodeItem(t),o.addChild(n),n.setPosition(r),n.getComponent(I).init()}))}},o.onCreateMonsterHp=function(t){var e=this,a="monsterHpItem",n=null,i=null,o=this.battleUIParent;if(this._battlerUIPrefabData.has(a))i=this._battlerUIPrefabData.get(a),n=c.instance.getNodeItem(i),o.addChild(n),n.getComponent(g).init(t),t.monsterHpItem=n.getComponent(g);else{var r=P.battlePath+a;m.getPrefab(r).then((function(i){e._battlerUIPrefabData.set(a,i),n=c.instance.getNodeItem(i),o.addChild(n),n.getComponent(g).init(t),t.monsterHpItem=n.getComponent(g)}))}},o.onCreateMonsterShadow=function(t){var e=this,a="shadown",n=null,i=null,o=this.battleUIDownParent.getChildByName("Shadow");if(this._battlerUIPrefabData.has(a))i=this._battlerUIPrefabData.get(a),n=c.instance.getNodeItem(i),o.addChild(n),n.getComponent(C).init(t),t.monsterShadow=n.getComponent(C);else{var r=P.battlePath+a;m.getPrefab(r).then((function(i){e._battlerUIPrefabData.set(a,i),n=c.instance.getNodeItem(i),o.addChild(n),n.getComponent(C).init(t),t.monsterShadow=n.getComponent(C)}))}},o.clear=function(){this._battlerUIPrefabData.clear(),this._battleUiNode.clear(),this.battleUIParent.removeAllChildren(),this.battleUIDownParent.getChildByName("Die").removeAllChildren(),this.battleUIDownParent.getChildByName("Shadow").removeAllChildren()},e}(h)).prototype,"battleUIParent",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(H.prototype,"battleUIDownParent",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=H))||U));o._RF.pop()}}}));

System.register("chunks:///_virtual/BgManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./ResourcesUtil.ts"],(function(t){var e,r,n,i,a,s,o,c,p,u,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,n=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,s=t._decorator,o=t.Node,c=t.Sprite,p=t.Component},function(t){u=t.Constants},function(t){g=t.ResourcesUtil}],execute:function(){var l,f,h,m,B;a._RF.push({},"bba98kwfVtJD5TEjlbR665q","BgManager",void 0);var b=s.ccclass,d=s.property;t("BgManager",(l=b("BgManager"),f=d(o),l((B=e((m=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,n(e,"bgs",B,i(e)),e}r(e,t);var a=e.prototype;return a.init=function(){this.setBattleBgRes(),this.setGridBgRes()},a.setBattleBgRes=function(){var t=u.mapPath+"battleBg/spriteFrame",e=this.bgs[0].getComponent(c);g.geSpriteFrame(t).then((function(t){e.spriteFrame=t}))},a.setGridBgRes=function(){var t=u.mapPath+"gridBg/spriteFrame",e=this.bgs[1].getComponent(c);g.geSpriteFrame(t).then((function(t){e.spriteFrame=t}))},a.clear=function(){},e}(p)).prototype,"bgs",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h=m))||h));a._RF.pop()}}}));

System.register("chunks:///_virtual/BlastItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts"],(function(t){var e,n,i,r,o,a,s,c,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,s=t.sp,c=t.Component},function(t){l=t.PoolManager}],execute:function(){var p,u,f,m,h;o._RF.push({},"6cdfbbCEVFPtarMgjH7Ar9b","BlastItem",void 0);var y=a.ccclass,d=a.property;t("BlastItem",(p=y("BlastItem"),u=d(s.Skeleton),p((h=e((m=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"spine",h,r(e)),e}return n(e,t),e.prototype.init=function(){var t=this;this.spine.setAnimation(0,"animation",!1),this.spine.setCompleteListener((function(e){"animation"==e.animation.name&&l.instance.putNode(t.node)}))},e}(c)).prototype,"spine",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=m))||f));o._RF.pop()}}}));

System.register("chunks:///_virtual/BoxManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts","./EventListener.ts","./GameEvent.ts","./ResourcesUtil.ts","./Constants.ts","./WeaponData.ts","./Util.ts"],(function(t){var n,e,o,i,r,a,s,c,u,l,p,f,h,m,v,x,C,b;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,s=t.Node,c=t.instantiate,u=t.sp,l=t.UITransform,p=t.v3},function(t){f=t.default},function(t){h=t.EventListener},function(t){m=t.GameEvent},function(t){v=t.ResourcesUtil},function(t){x=t.Constants},function(t){C=t.CoinObj},function(t){b=t.Util}],execute:function(){var B,E,d,g,_;r._RF.push({},"847ceV2XWlA37OAqupKooMM","BoxManager",void 0);var y=a.ccclass,P=a.property;t("BoxManager",(B=y("BoxManager"),E=P(s),B((_=n((g=function(t){function n(){for(var n,e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return n=t.call.apply(t,[this].concat(r))||this,o(n,"boxParent",_,i(n)),n._pickBox=!1,n}e(n,t);var r=n.prototype;return r.onEnable=function(){h.on(m.CREATE_DROP_BOX,this.onCreateDropBox,this)},r.onDisable=function(){h.off(m.CREATE_DROP_BOX,this.onCreateDropBox,this)},r.onCreateDropBox=function(t){var n=this,e=x.battlePath+"boxItem";this.boxParent.setPosition(0,0),v.getPrefab(e).then((function(e){var o=c(e);o.parent=n.boxParent,o.setPosition(t);var i=o.getChildByName("box").getComponent(u.Skeleton),r=o.getComponent(l).convertToWorldSpaceAR(p(0,0,0));n.scheduleOnce((function(){n.showFlyGoldAnim(r)}),.5),i.setCompleteListener((function(){o.destroy(),h.emit(m.RESERT_SELECT_BAG)}))}))},r.showFlyGoldAnim=function(t){var n=new C;n.wpos=t,n.num=b.getRandomInt(5,10),h.emit(m.WEAPON_CHANGE_COIN,n)},r.clear=function(){this._pickBox=!1},n}(f)).prototype,"boxParent",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=g))||d));r._RF.pop()}}}));

System.register("chunks:///_virtual/CfgMgr.ts",["cc","./Debug.ts"],(function(t){var a,f;return{setters:[function(t){a=t.cclegacy},function(t){f=t.Debug}],execute:function(){a._RF.push({},"8f0fcdZNgJLlbkVxJmLK0oC","CfgMgr",void 0);var n=t("CfgMgr",function(){function t(){}return t.addCfgData=function(t,a){if(null!=t&&this.CfgDataList.has(t)){var n=this.CfgData.get(t),s=this.CfgDataList.get(t);a.forEach((function(a){if(a.hasOwnProperty("Id")){var e=a.Id;n[e]=a,s.push(a)}else f.info("配置表Id字段错误:",t)}))}else f.info("Error: 不存在配置表"+t)},t.setCfgData=function(t,a){var n={},s=[];a.forEach((function(a){if(a.hasOwnProperty("Id")){var e=a.Id;n[e]=a,s.push(a)}else f.info("配置表Id字段错误:",t)})),this.CfgData.set(t,n),this.CfgDataList.set(t,s)},t.getCfgData=function(t){var a=t.ClassName;return this.CfgData.has(a)?this.CfgData.get(a):(f.info("Error: 不存在配置表"+a),null)},t.hasCfg=function(t){return!!this.CfgData.has(t)},t.getCfgDataArray=function(t){var a=t.ClassName;return null!=a&&this.CfgDataList.has(a)?this.CfgDataList.get(a):(f.info("Error: 不存在配置表"+a),null)},t.getDataById=function(t,a){var n=t.ClassName,s=null;if(this.CfgData.has(n)){var e=this.CfgData.get(n);e[a]?s=e[a]:f.info(n+":不存在ID "+a)}else f.info(n+"配置不存在。"+a);return s},t.clearByKey=function(t){this.CfgData.delete(t),this.CfgDataList.delete(t)},t}());n.CfgData=new Map,n.CfgDataList=new Map,a._RF.pop()}}}));

System.register("chunks:///_virtual/ChapterData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CfgMgr.ts","./ChapterModel.ts"],(function(t){var n,e,a,r;return{setters:[function(t){n=t.createClass},function(t){e=t.cclegacy},function(t){a=t.CfgMgr},function(t){r=t.ChapterCfg}],execute:function(){e._RF.push({},"037c1pT24xDKr9WjwmVRWAA","ChapterData",void 0),t("ChapterData",function(){function t(){}var e=t.prototype;return e.getChapterData=function(){return a.getCfgDataArray(new r)},e.getChapterCfgById=function(t){return a.getDataById(new r,t)},n(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=null,e._RF.pop()}}}));

System.register("chunks:///_virtual/ChapterEventModel.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"32241t2YThK/bgnFGmH36of","ChapterEventModel",void 0);t("ChapterEventCfg",(function(){this.ClassName="ChapterEvent",this.Id=void 0,this.Chapter=void 0,this.Wave=void 0,this.eType=void 0,this.Event=void 0,this.HpUp=void 0,this.Box=void 0})),t("BrushMonsterType",function(t){return t[t.NORMAL=1]="NORMAL",t[t.BOSS=2]="BOSS",t}({})),t("MonsterType",function(t){return t[t.LITTLE=1]="LITTLE",t[t.ELITE=2]="ELITE",t[t.BOSS=3]="BOSS",t}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/ChapterMapData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./CfgMgr.ts","./Debug.ts","./ChapterModel.ts","./PlayerData.ts"],(function(t){var a,e,r,n,i,s,p;return{setters:[function(t){a=t.createClass},function(t){e=t.cclegacy},function(t){r=t.Constants},function(t){n=t.CfgMgr},function(t){i=t.Debug},function(t){s=t.ChapterCfg},function(t){p=t.PlayerData}],execute:function(){e._RF.push({},"76678VIX75Efa0Bu8ve9nTW","ChapterMapData",void 0),t("ChapterMapData",function(){function t(){this._chapterMapData=null,this._ChapterDropRewardData=new Map}var e=t.prototype;return e.init=function(){this.setChapterMapData()},e.setChapterMapData=function(){var t=p.instance.playerInfo.curChapter;this._chapterMapData=n.getDataById(new s,t),r.selectLoadConfig=[this._chapterMapData.cMonsterId],i.log("游戏章节数据",this._chapterMapData)},e.setChapterRewardData=function(t,a){var e=a.split("|"),r=null,n=Number(e[0]),i=Number(e[1]);t.has(n)?r.Num+=i:((r=new h).ItemId=n,r.Num=i,t.set(n,r))},e.getChapterRewardData=function(t){var a=new Map;if(this._chapterMapData.StarReward)for(var e=this._chapterMapData.StarReward.split(","),r=0;r<e.length;r++){var n=e[r];this.setChapterRewardData(a,n)}if(t&&this._chapterMapData.WinReward)for(var i=this._chapterMapData.WinReward.split(","),s=0;s<i.length;s++){var p=i[s];this.setChapterRewardData(a,p)}return Array.from(a.values())},e.clear=function(){this._chapterMapData=null,this._ChapterDropRewardData.clear()},a(t,[{key:"chapterMapData",get:function(){return this._chapterMapData}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=null;var h=t("ChapterDropRewardObj",(function(){this.ItemId=void 0,this.Num=void 0}));e._RF.pop()}}}));

System.register("chunks:///_virtual/ChapterModel.ts",["cc"],(function(i){var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"2530f+OzZ9CfYvZ5BsmGlGp","ChapterModel",void 0);i("ChapterCfg",(function(){this.ClassName="Chapter",this.Id=void 0,this.Name=void 0,this.lType=void 0,this.MapId=void 0,this.LoopMap=void 0,this.MonsterId=void 0,this.MonsterAtk=void 0,this.MonsterDef=void 0,this.HpUp=void 0,this.cMonsterId=void 0,this.StarReward=void 0,this.RandomReward=void 0,this.WinReward=void 0,this.FirstPass=void 0,this.ReSkills=void 0,this.ReBorn=void 0,this.PlaceReward=void 0,this.BattlePower=void 0,this.IsUseSkill=void 0,this.Entry=void 0,this.Difficulty=void 0,this.NextChapter=void 0})),i("ChapterRewardCfg",(function(){this.ClassName="ChapterReward",this.Id=void 0,this.ChapterId=void 0,this.Lock=void 0,this.Reward=void 0}));t._RF.pop()}}}));

System.register("chunks:///_virtual/Configuration.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./Util.ts"],(function(n){var e,t,a,i,o;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy,a=n.sys},function(n){i=n.Constants},function(n){o=n.Util}],execute:function(){t._RF.push({},"8cb26FZvcBCFoeNEIZPrPgl","Configuration",void 0),n("Configuration",function(){function n(){this._jsonData={},this._markSave=!1}var t=n.prototype;return t.init=function(){var n=a.localStorage.getItem(i.gameConfigId);n&&n.startsWith("@")&&(n=n.substring(1),n=o.decrypt(n),this._jsonData=JSON.parse(n)),setInterval(this.scheduleData.bind(this),500)},t.clearConfigDataToVersion=function(){var n=this,e=this.getConfigData(i.cacheVersion);if(e){var t=JSON.parse(e),a=o.clone(i.cacheVersionConfig);i.cacheVersionConfig.forEach((function(e,i){t.forEach((function(t,i){e.versionName==t.versionName&&e.version>t.version&&"gameData"==t.versionName?(n.clearConfigData(),n._jsonData={}):(e.versionName==t.versionName&&e.version>t.version&&n._jsonData.hasOwnProperty(e.versionName)&&delete n._jsonData[e.versionName],a.some((function(n,e){if(n.versionName==t.versionName)return a.splice(e,1),!0})))}))})),a.forEach((function(e){n._jsonData.hasOwnProperty(e.versionName)&&delete n._jsonData[e.versionName]}))}else i.cacheVersionConfig.forEach((function(e){n._jsonData.hasOwnProperty(e.versionName)&&delete n._jsonData[e.versionName]}));this.setConfigData(i.cacheVersion,JSON.stringify(i.cacheVersionConfig))},t.clearByKey=function(n){this._jsonData.hasOwnProperty(n)&&(delete this._jsonData[n],this._markSave=!0)},t.clearConfigData=function(){a.localStorage.clear()},t.getConfigData=function(n){return this._jsonData[n]||null},t.setConfigData=function(n,e){this._jsonData[n]=e,this._markSave=!0},t.scheduleData=function(){if(this._markSave){var n=JSON.stringify(this._jsonData);a.localStorage.setItem(i.gameConfigId,"@"+o.encrypt(n)),this._markSave=!1}},e(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}())._instance=null,t._RF.pop()}}}));

System.register("chunks:///_virtual/Constants.ts",["cc"],(function(e){var a;return{setters:[function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"38f6antDZNCibijc56rqZbp","Constants",void 0);var t=e("Constants",(function(){}));t.toastPath="Prefab/Popup/Common/toast",t.monsterPath="Prefab/Game/Monster/MonsterPrefab",t.weaponPath="Prefab/Game/Weapon/weaponItem",t.weaponBgPath="Prefab/Game/Weapon/weaponBgItem",t.heroPath="Prefab/Game/Hero/heroItem",t.battSkillPath="Prefab/Game/Skill/skillBulletItem",t.battlePath="Prefab/Game/Battle/",t.synPath="Prefab/Game/Battle/synEffect",t.qualityPath="Common/quality",t.skillSelectIconPath="Game/Skill/",t.mapPath="Game/Map/",t.itemPath="Game/Item/",t.weaponIconPath="Game/Weapon/",t.gridPath="Game/Grid/",t.monsterSpinePath="Spine/Monster/",t.monsterIconPath="Game/Monster/",t.monsterAnimPath="Anim/Monster/common/",t.chaterMapPath="Map/Chapter/",t.SysConstant={},t.ConfigPath="ConfigData/",t.selectLoadConfig=[],t.AUDIO_FILE_PATH={MUSIC:"Audio/Music/",SOUND:"Audio/Sound/"},t.PopupUI={ChapterPopup:"Prefab/Popup/Chapter/chapterPopup",GamePopup:"Prefab/Popup/Game/gamePopup",GameOverPopup:"Prefab/Popup/Game/gameOverPopup",WeaponDetailPopup:"Prefab/Popup/Weapon/weaponDetailPopup",PausePopup:"Prefab/Popup/Game/pausePopup",tipsPopup:"Prefab/Popup/Common/tipsPopup",SetPopup:"Prefab/Popup/Set/setPopup",SkillSelectPopup:"Prefab/Popup/Skill/skillSelectPopup"},t.cacheVersion="cacheVersion",t.gameConfigId="gameData",t.playerConfigId="playerData",t.cacheVersionConfig=[{versionName:"gameData",version:1.03},{versionName:"playerData",version:1.01}],a._RF.pop()}}}));

System.register("chunks:///_virtual/ContentAdapter.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,o,i,r,h,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,i=t.screen,r=t.UITransform,h=t.Size,c=t.Component}],execute:function(){var s;n._RF.push({},"494f9k+dAhM/KtYR67LvtYz","ContentAdapter",void 0);var d=o.ccclass;o.property,t("ContentAdapter",d("ContentAdapter")(s=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.onLoad=function(){var t=i.windowSize,e=this.node.getComponent(r).contentSize,n=Math.min(t.width/e.width,t.height/e.height),o=e.width*n,c=e.height*n,s=new h;s.width=e.width*(t.width/o),s.height=e.height*(t.height/c),this.node.getComponent(r).setContentSize(s)},n}(c))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/ContentScale.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Util.ts"],(function(t){var e,n,o,c,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,c=t.Component},function(t){r=t.Util}],execute:function(){var a;n._RF.push({},"29ec8b7A9ZAfpoh28pIYAGQ","ContentScale",void 0);var i=o.ccclass;o.property,t("ContentScale",i("ContentScale")(a=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.start=function(){var t=r.adapterScale();this.node.setScale(t,t)},n}(c))||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/ContentWidthAdapter.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,o,i,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,i=t.view,r=t.UITransform,s=t.Component}],execute:function(){var d;n._RF.push({},"9d1beTZsZVLLodLFMhkBa8y","ContentWidthAdapter",void 0);var c=o.ccclass;o.property,t("ContentWidthAdapter",c("ContentWidthAdapter")(d=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.onLoad=function(){var t=i.getVisibleSize(),e=i.getDesignResolutionSize(),n=t.width>e.width?e.width:t.width;this.node.getComponent(r).width=n},n}(s))||d);n._RF.pop()}}}));

System.register("chunks:///_virtual/DamageItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts"],(function(t){var e,n,o,i,a,s,r,c,l,u,f,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,s=t._decorator,r=t.Label,c=t.v3,l=t.tween,u=t.Color,f=t.Component},function(t){m=t.PoolManager}],execute:function(){var p,h,d,g,v;a._RF.push({},"6c20chu39hHKYv9Mua9Oz/X","DamageItem",void 0);var b=s.ccclass,y=s.property;t("DamageItem",(p=b("DamageItem"),h=y(r),p((v=e((g=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,o(e,"numLab",v,i(e)),e.monsterKey="",e}n(e,t);var a=e.prototype;return a.init=function(t,e,n){void 0===n&&(n=25),this.numLab.string=""+t,this.numLab.fontSize=n,this.setsetDamageColor(e),this.setDamageFlyAnim(t,e)},a.setDamageScaleAnim=function(t,e){var n=this;t>0?(this.node.scale=c(1,1,1),l(this.node).to(.25,{scale:c(.8,.8,.8)}).call((function(){m.instance.putNode(n.node)})).start()):m.instance.putNode(this.node)},a.setDamageFlyAnim=function(t,e){var n=this,o=this.numLab.node;if(t>0){var i=new function(){this.position=void 0,this.scale=void 0};i.position=o.getPosition(),i.scale=1.5,l(i).parallel(l().by(.25,{position:c(0,30,0)},{onUpdate:function(t){o.setPosition(t.position)}}),l().to(.25,{scale:1.3},{onUpdate:function(t){o.setScale(t.scale,t.scale)}})).delay(.25).call((function(){o.setPosition(0,0,0),m.instance.putNode(n.node)})).start()}else o.setPosition(0,0,0),m.instance.putNode(this.node)},a.setsetDamageColor=function(t){switch(t){case 0:this.numLab.color=(new u).fromHEX("#ffffff");break;case 1:this.numLab.color=(new u).fromHEX("#FF0000")}},e}(f)).prototype,"numLab",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=g))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/Debug.ts",["cc","./GameDefine.ts"],(function(e){var o,r,n,t;return{setters:[function(e){o=e.cclegacy,r=e.Graphics,n=e.Node},function(e){t=e.GameDefine}],execute:function(){o._RF.push({},"57624QKseNHsYSFOwkcAy/w","Debug",void 0);e("Debug",function(){function e(){}return e.log=function(){if(t.DebugLevel<=0){for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];Promise.resolve(console.log.apply(this,o))}},e.info=function(){if(t.DebugLevel<=1){for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];Promise.resolve(console.info.apply(this,o))}},e.warn=function(){if(t.DebugLevel<=2){for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];Promise.resolve(console.warn.apply(this,o))}},e.error=function(){if(t.DebugLevel<=3){for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];Promise.resolve(console.error.apply(this,o))}},e.drawFillRect=function(e,o){var n=e.addComponent(r);n.fillColor.fromHEX("#ff0000"),n.rect(o.x,o.y,o.width,o.height),n.fill()},e.drawRect=function(e,o){var n=e.addComponent(r);n.lineWidth=2,n.strokeColor.fromHEX("#ff0000"),n.rect(o.x,o.y,o.width,o.height),n.stroke()},e.drawLine=function(e){var o=e.addComponent(r);o.lineWidth=2,o.strokeColor.fromHEX("#ffffff"),o.clear(),o.moveTo(100,100),o.lineTo(100,200),o.lineTo(200,200),o.stroke()},e.drawPolyGon=function(e,o){var t=new n;e.addChild(t);var i=t.addComponent(r);i.lineWidth=10,i.strokeColor.fromHEX("#ffffff");for(var f=0;f<o.length;f++){var l=o[f];0==f?i.moveTo(l.x,l.y):i.lineTo(l.x,l.y)}i.close(),i.stroke()},e.drawBesize=function(e,o,t,i,f,l,a){var s=new n;e.addChild(s);var c=s.addComponent(r);c.lineWidth=10,c.strokeColor.fromHEX("#ffffff"),c.moveTo(o.x,o.y),c.bezierCurveTo(i,f,l,a,t.x,t.y),c.stroke()},e}());o._RF.pop()}}}));

System.register("chunks:///_virtual/EventListener.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"10e50v0/Z9Cuq8TUTgBlAZ2","EventListener",void 0),n("EventListener",function(){function n(){}return n.on=function(n,t,e){this.handle[n]||(this.handle[n]=[]);var r={func:t,target:e};this.handle[n].push(r)},n.off=function(n,t,e){var r=this.handle[n];if(r&&!(r.length<=0))for(var i=0;i<r.length;i++){var a=r[i];if(a.func===t&&(!e||e===a.target)){r.splice(i,1);break}}},n.emit=function(n){var t=this.handle[n];if(t&&!(t.length<=0)){for(var e=t.length,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];for(var h=0;h<t.length;h++){var l=t[h];if(l){l.func.apply(l.target,i);e>t.length&&(h-=e-t.length,e=t.length)}}}},n.clear=function(){this.handle={}},n}()).handle={},t._RF.pop()}}}));

System.register("chunks:///_virtual/Game.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts","./EventListener.ts","./GameController.ts","./OpenPopupManager.ts","./PopupManager.ts","./GameEvent.ts","./BattleUIManager.ts","./BgManager.ts","./BoxManager.ts","./GridManager.ts","./GridMapManager.ts","./HeroManager.ts","./MonsterManager.ts","./SkillManager.ts","./WeaponManager.ts","./GameDefine.ts"],(function(e){var n,t,a,i,r,o,l,s,u,c,g,h,p,M,f,m,T,b,E,v,_,w,C,S,A,G,d,y,O,B;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,o=e._decorator,l=e.Node,s=e.tween,u=e.v3,c=e.Tween,g=e.director,h=e.Vec3,p=e.Input,M=e.Component},function(e){f=e.AudioManager},function(e){m=e.EventListener},function(e){T=e.default},function(e){b=e.OpenPopupManager},function(e){E=e.PopupManager},function(e){v=e.GameEvent},function(e){_=e.BattleUIManager},function(e){w=e.BgManager},function(e){C=e.BoxManager},function(e){S=e.GridManager},function(e){A=e.GridMapManager},function(e){G=e.HeroManager},function(e){d=e.MonsterManager},function(e){y=e.SkillManager},function(e){O=e.WeaponManager},function(e){B=e.GameDefine}],execute:function(){var L,H,U,R,I,z,P,D,N,x,k,W,V,F,Y,j,K,q,J,Q,X,Z,$,ee,ne,te,ae,ie,re;r._RF.push({},"3b31dMje5NGcYFxxYgcs301","Game",void 0);var oe=o.ccclass,le=o.property;e("Game",(L=oe("Game"),H=le(l),U=le(l),R=le(l),I=le(l),z=le(w),P=le(A),D=le(S),N=le(O),x=le(G),k=le(C),W=le(d),V=le(_),F=le(y),L((K=n((j=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n=e.call.apply(e,[this].concat(r))||this,a(n,"gameCtrl",K,i(n)),a(n,"battleMap",q,i(n)),a(n,"removeWeaponList",J,i(n)),a(n,"openBox",Q,i(n)),a(n,"bgManager",X,i(n)),a(n,"gridMapManager",Z,i(n)),a(n,"gridManager",$,i(n)),a(n,"weaponManager",ee,i(n)),a(n,"heroManager",ne,i(n)),a(n,"boxManager",te,i(n)),a(n,"monsterManager",ae,i(n)),a(n,"battleUIManager",ie,i(n)),a(n,"skillManager",re,i(n)),n._battleMapUpPosY=1200,n._battleMapDownPosy=200,n}t(n,e);var r=n.prototype;return r.onLoad=function(){f.instance.playMusic(2,!0),B.gameTouch=!1,b.instance.showGamePopup(),this.init()},r.init=function(){this.gridManager.init(),this.bgManager.init(),this.gridMapManager.init(),this.weaponManager.init(),this.heroManager.init(),this.monsterManager.init(),this.skillManager.init(),this.onTapBtn()},r.onTapBtn=function(){B.gameTouch=!0,this.setTweenAnim(this.removeWeaponList,.3)},r.setTweenAnim=function(e,n){e.active=!0,e.setScale(.5,.5),s(e).to(n,{scale:u(1,1,1)},{easing:"backOut"}).call((function(){})).start()},r.onGameStart=function(){B.gameTouch=!1,B.gameStart=!0,B.gameOver=!1},r.onGameOver=function(){B.gameTouch=!1,B.gameStart=!1,B.gameOver=!0,c.stopAll(),this.clear(),E.instance.hideAll(),T.resume(),g.loadScene("Game")},r.onBattleBtn=function(){var e=this;s(this.battleMap).to(.5,{position:new h(0,this._battleMapDownPosy,0)},{easing:"sineInOut"}).call((function(){e.heroManager.showHideHero(!0),m.emit(v.INIT_HERO_SKILL),e.monsterManager.setCurChapterEvent(),e.weaponManager.showHideRemoveList(!1),e.onGameStart()})).start()},r.onResertSelectBg=function(){var e=this;s(this.battleMap).to(.5,{position:u(0,this._battleMapUpPosY,0)},{easing:"sineInOut"}).call((function(){m.emit(v.SHOW_HIDE_SKILL_LIST,!1),e.heroManager.showHideHero(!1),B.gameStart=!1,m.emit(v.WEAPON_REMOVE_REFRESH),e.weaponManager.showHideRemoveList(!0),e.setTweenAnim(e.removeWeaponList,.3),B.gameTouch=!0})).start()},r.onTouchStart=function(e){if(e.preventSwallow=!0,B.gameTouch){var n=e.getUILocation();m.emit(v.GAME_TOUCH_START,n)}},r.onTouchMove=function(e){if(e.preventSwallow=!0,B.gameTouch){var n=e.getUILocation();m.emit(v.GAME_TOUCH_MOVE,n)}},r.onTouchEnd=function(e){if(e.preventSwallow=!0,B.gameTouch){var n=e.getUILocation();m.emit(v.GAME_TOUCH_END,n)}},r.onTouchCancle=function(e){if(e.preventSwallow=!0,B.gameTouch){var n=e.getUILocation();m.emit(v.GAME_TOUCH_CANCLE,n)}},r.onEnable=function(){this.gameCtrl.on(p.EventType.TOUCH_START,this.onTouchStart,this),this.gameCtrl.on(p.EventType.TOUCH_MOVE,this.onTouchMove,this),this.gameCtrl.on(p.EventType.TOUCH_END,this.onTouchEnd,this),this.gameCtrl.on(p.EventType.TOUCH_CANCEL,this.onTouchCancle,this),m.on(v.GAME_OVER,this.onGameOver,this),m.on(v.GAME_TAP_BTN,this.onTapBtn,this),m.on(v.RESERT_SELECT_BAG,this.onResertSelectBg,this),m.on(v.GAME_BATTLE_START,this.onBattleBtn,this)},r.onDisable=function(){this.gameCtrl.off(p.EventType.TOUCH_START,this.onTouchStart,this),this.gameCtrl.off(p.EventType.TOUCH_MOVE,this.onTouchMove,this),this.gameCtrl.off(p.EventType.TOUCH_END,this.onTouchEnd,this),this.gameCtrl.off(p.EventType.TOUCH_CANCEL,this.onTouchCancle,this),m.off(v.GAME_OVER,this.onGameOver,this),m.off(v.GAME_TAP_BTN,this.onTapBtn,this),m.off(v.RESERT_SELECT_BAG,this.onResertSelectBg,this),m.off(v.GAME_BATTLE_START,this.onBattleBtn,this)},r.clear=function(){this.bgManager.clear(),this.heroManager.clear(),this.gridManager.clear(),this.weaponManager.clear(),this.monsterManager.clear(),this.boxManager.clear(),this.battleUIManager.clear(),this.skillManager.clear()},n}(M)).prototype,"gameCtrl",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=n(j.prototype,"battleMap",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=n(j.prototype,"removeWeaponList",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=n(j.prototype,"openBox",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=n(j.prototype,"bgManager",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=n(j.prototype,"gridMapManager",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=n(j.prototype,"gridManager",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=n(j.prototype,"weaponManager",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=n(j.prototype,"heroManager",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=n(j.prototype,"boxManager",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=n(j.prototype,"monsterManager",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=n(j.prototype,"battleUIManager",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=n(j.prototype,"skillManager",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=j))||Y));r._RF.pop()}}}));

System.register("chunks:///_virtual/GameController.ts",["cc"],(function(e){var t,a,n,i,s,r,c,o,u;return{setters:[function(e){t=e.cclegacy,a=e.game,n=e.Game,i=e.director,s=e.AnimationManager,r=e.sp,c=e.TweenSystem,o=e.Animation,u=e.dragonBones}],execute:function(){var l;t._RF.push({},"c76e0fkdyBP5IBNGua/cGsR","GameController",void 0),function(e){var t=1,l=1;a._calculateDT=function(e){return e||(e=performance.now()),this._deltaTime=e>this._startTime?(e-this._startTime)/1e3:0,this._deltaTime>n.DEBUG_DT_THRESHOLD&&(this._deltaTime=this.frameTime/1e3),this._startTime=e,this._deltaTime=this._deltaTime*t,this._deltaTime},e.getGameTimeScale=function(){return l},e.setGameTimeScale=function(e){l=e},e.changeTimeScale=function(e){t=e};var m=e.pause_data=new(function(){return function(){this.state_b=!1,this.physics_2d_b=void 0,this.physics_3d_b=void 0,this.scheduler_as=void 0,this.anim_as=[],this.tween_target_as=void 0,this.spine_as=void 0,this.spine_TimeScale=new Map}}());function _(e,t){return void 0===t&&(t=[]),e?(t.push(e),e.children.forEach((function(e){t.push(e),_(e)})),t):t}function h(e){(Array.isArray(e)?e:[e]).forEach((function(e){var t;i.getScheduler().resumeTarget(e),null==(t=e.getComponent(o))||t.resume(),e.getComponent(u.ArmatureDisplay)&&(e.getComponent(u.ArmatureDisplay).timeScale=1),c.instance.ActionManager.resumeTarget(e)}))}e.pause_config=function(){this.exclude_as=void 0,this.recu_exclude_as=void 0},e.quick=function(e){i.getScheduler().setTimeScale(e)},e.pause=function(e){if(!m.state_b){m.scheduler_as=i.getScheduler().pauseAllTargets();var t,a=i.getSystem(s.ID);if((t=m.anim_as).splice.apply(t,[0,m.anim_as.length].concat(a._anims.array)),m.anim_as.forEach((function(e){e.pause()})),m.spine_as=i.getScene().getComponentsInChildren(r.Skeleton),m.spine_as.forEach((function(e){e.skeletonData&&(m.spine_TimeScale.set(e.skeletonData.name,e.timeScale),e.timeScale=0)})),m.tween_target_as=c.instance.ActionManager.pauseAllRunningActions(),e){var n,o=[];o.push.apply(o,e.exclude_as),null==(n=e.recu_exclude_as)||n.forEach((function(e){o.push.apply(o,_(e))})),o.forEach((function(e){h(e)}))}m.state_b=!0}},e.resume=function(){i.getScheduler().resumeTargets(m.scheduler_as),m.anim_as.forEach((function(e){e.isPlaying&&e.isPaused&&e.play()})),m.spine_as&&m.spine_as.forEach((function(e){e.skeletonData&&(e.timeScale=m.spine_TimeScale.has(e.skeletonData.name)?m.spine_TimeScale.get(e.skeletonData.name):1)})),c.instance.ActionManager.resumeTargets(m.tween_target_as),m.state_b=!1},e.pause_node=function(e){(Array.isArray(e)?e:[e]).forEach((function(e){var t;i.getScheduler().pauseTarget(e),null==(t=e.getComponent(o))||t.pause(),e.getComponent(u.ArmatureDisplay)&&(e.getComponent(u.ArmatureDisplay).timeScale=0),c.instance.ActionManager.pauseTarget(e)}))},e.resume_node=h}(l||(l={}));e("default",l);t._RF.pop()}}}));

System.register("chunks:///_virtual/GameData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./Configuration.ts"],(function(t){var n,e,i,a;return{setters:[function(t){n=t.createClass},function(t){e=t.cclegacy},function(t){i=t.Constants},function(t){a=t.Configuration}],execute:function(){e._RF.push({},"1d101mQYZlH5YgNDTHpHFON","GameData",void 0),t("GameData",function(){function t(){this._gameTime=0,this._eventTime=0,this._dataInited=!1}var e=t.prototype;return e.init=function(){this.loadFromCache()},e.checkGameEventOver=function(){return!1},e.getRandEquipMaterialByWeight=function(t){var n=t.split(","),e=0,i=0,a=0,o=[],s=[];n.forEach((function(t){var n=t.split("|");o.push(Number(n[0])),s.push(Number(n[1])),a+=Number(n[1])}));var c=Math.floor(Math.random()*a),r=0;return s.some((function(t,n){if(i=e+t,c>=e&&c<i)return r=n,!0;e=i})),o[r]},e.clear=function(){this._gameTime=0,this._eventTime=0},e.loadFromCache=function(){if(!this._dataInited){a.instance.init(),a.instance.clearConfigDataToVersion();a.instance.getConfigData(i.playerConfigId);this._dataInited=!0}},e.clearCacheData=function(){a.instance.clearConfigData()},n(t,[{key:"eventTime",set:function(t){this._eventTime=t}},{key:"gameTime",get:function(){return this._gameTime},set:function(t){this._gameTime=t}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=null,e._RF.pop()}}}));

System.register("chunks:///_virtual/GameDefine.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"fd476d/4/RPHLXXF2HDHdbK","GameDefine",void 0);var t=function(e){return e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARNING=2]="WARNING",e[e.ERROR=3]="ERROR",e}(t||{}),a=e("GameDefine",(function(){}));a.gameStart=!1,a.gameOver=!1,a.gameTouch=!1,a.frameTime=.016,a.defaultFrameTime=.016,a.viewWidth=750,a.viewHeight=1334,a.ScreenShakeLevel=1,a.ScreenShakeCount=1,a.ScreenShakeInteval=.0333,a.DebugLevel=t.DEBUG,n._RF.pop()}}}));

System.register("chunks:///_virtual/GameEvent.ts",["cc"],(function(e){var E;return{setters:[function(e){E=e.cclegacy}],execute:function(){E._RF.push({},"d5d0dY/89NEZKp7PTxaM7GN","GameEvent",void 0);var _=e("GameEvent",(function(){}));_.SAVE_GAME_DATA="saveGameData",_.SCREEN_VIBRATOR="screenVibrator",_.GAME_TOUCH_START="gameTouchStart",_.GAME_TOUCH_MOVE="gameTouchMove",_.GAME_TOUCH_END="gameTouchEnd",_.GAME_TOUCH_CANCLE="gameTouchCancle",_.GAME_TAP_BTN="gameTapBtn",_.GAME_WIN_FAIL="gameWinFail",_.GAME_OVER="gameOver",_.GAME_BATTLE="gameBattle",_.GAME_BATTLE_START="gameBattleStart",_.SET_BATTLE_BTN_STATUS="setBattleBtnStatus",_.CREATE_SKILL_EFFECT="createSkillEffect",_.INIT_BUILD_GRID_LIST="initBuildGridList",_.INIT_BUILD_WEAPON_POS="initBuildWeaponPos",_.WEAPON_MOVE="weaponMove",_.WEAPON_ICON_STATUS_INIT="weaponIconStatusInit",_.WEAPON_ICON_STATUS="weaponIconStatus",_.WEAPON_UPGRADE="weaponGrade",_.WEAPON_SHAKE="weaponShake",_.WEAPON_PlACE="weaponPlace",_.WEAPON_REMOVE="weaponRemove",_.WEAPON_CHANGE_COIN="weaponChangeCoin",_.WEAPON_PROGRESS_BAR="weaponProgressBar",_.ADD_REMOVE_WEAPON_LIST="addRemoveWeaponList",_.ADD_PRE_WEAPON_LIST="addPreWeaponList",_.WEAPON_REMOVE_REFRESH="weaponRemoveRefresh",_.HERO_HURT="heroHurt",_.INIT_HERO_SKILL="initHeroSkill",_.UPDATE_HERO_HP="updateHeroHp",_.INSERT_HERO_CIRCLE_OBJ="insertHeroCircleObj",_.INSERT_SKILL_RELEASE_CIRCLE_OBJ="insertSkillReleaseCircleObj",_.INSERT_QUARD_TREE_RECT_CIRCLE="insertQuardTreeRectCircle",_.DELETE_QUARD_TREE_OBJ="deleteQuardTreeObj",_.CHECK_QUARD_TREE_OBJ="checkQuardTreeObj",_.REFRESH_BOSS_HP="refreshBossHp",_.CREATE_DAMAGER_NUM="createDamageNum",_.SHOW_MONSTER_DIE_EFFECT="showMonsterDieEffect",_.SHOW_HERO_HP="showHeroHp",_.SHOW_MONSTER_HP="showMonsterHp",_.SHOW_MONSTER_SHADOW="showMonsterShadow",_.HERO_ANIM="heroAnim",_.CREATE_DROP_BOX="createDropBox",_.RESERT_SELECT_BAG="resertSelectBag",_.UPDATE_MONSTER_PROGRESS="updateMonsterProgress",_.SHOW_HIDE_SKILL_LIST="showHideSkillList",_.SHOW_HIDE_PLACE_LIST="showHidePlaceList",_.PLACE_GRID_START="placeGridStart",_.PLACE_GRID_MOVE="placeGridMove",_.PLACE_GRID_END="placeGridEnd",_.CLEAR_AREA_DATA="clearAreaData",_.PLACE_GRID_FINISH="placeGridFinish",E._RF.pop()}}}));

System.register("chunks:///_virtual/GameOverPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventListener.ts","./SpriteEx.ts","./GameEvent.ts"],(function(e){var t,n,r,i,o,c,a,u,p,s;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,c=e._decorator,a=e.Component},function(e){u=e.EventListener},function(e){p=e.SpriteEx},function(e){s=e.GameEvent}],execute:function(){var l,f,v,m,h;o._RF.push({},"29c35/kUbZA369Ro0+dD578","GameOverPopup",void 0);var y=c.ccclass,E=c.property;e("GameOverPopup",(l=y("GameOverPopup"),f=E(p),l((h=t((m=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return t=e.call.apply(e,[this].concat(o))||this,r(t,"icon",h,i(t)),t}n(t,e);var o=t.prototype;return o.show=function(e){this.icon.index=e},o.onResetGame=function(){u.emit(s.GAME_OVER)},t}(a)).prototype,"icon",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=m))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/GamePopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./EventListener.ts","./OpenPopupManager.ts","./ResourcesUtil.ts","./Util.ts","./GridData.ts","./MonsterData.ts","./SkillUpgradeData.ts","./WeaponData.ts","./GameEvent.ts","./SkillTypeItem.ts"],(function(t){var e,i,n,o,s,a,l,r,p,c,u,h,f,g,_,d,v,S,L,E,m,T,P,b,I,y,B,x;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,a=t._decorator,l=t.ProgressBar,r=t.Label,p=t.Node,c=t.UITransform,u=t.Button,h=t.Sprite,f=t.view,g=t.instantiate,_=t.Component,d=t.tween,v=t.v3},function(t){S=t.Constants},function(t){L=t.EventListener},function(t){E=t.OpenPopupManager},function(t){m=t.ResourcesUtil},function(t){T=t.Util},function(t){P=t.GridData},function(t){b=t.MonsterData},function(t){I=t.SkillUpgradeData},function(t){y=t.WeaponData},function(t){B=t.GameEvent},function(t){x=t.SkillTypeItem}],execute:function(){var k,w,G,A,H,M,C,D,O,R,N,W,U,z,F,K,V,j,Y;s._RF.push({},"dbe14r+mn5EhrfiOzy+Ys8V","GamePopup",void 0);var q=a.ccclass,J=a.property;t("GamePopup",(k=q("GamePopup"),w=J(l),G=J(r),A=J(r),H=J(r),M=J(r),C=J(p),D=J(p),O=J(p),k((W=e((N=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return e=t.call.apply(t,[this].concat(s))||this,n(e,"expProgerssBar",W,o(e)),n(e,"expLevel",U,o(e)),n(e,"kill",z,o(e)),n(e,"gold",F,o(e)),n(e,"wave",K,o(e)),n(e,"buttonList",V,o(e)),n(e,"placeList",j,o(e)),n(e,"skillTypeList",Y,o(e)),e.weaponSkill=[],e._totalGold=0,e._maxExp=100,e._curExp=0,e._level=0,e}i(e,t);var s=e.prototype;return s.show=function(){this._totalGold=0,this._curExp=0,this._level=0,this._maxExp=I.instance.getBattleLevelByLevel(this._level+1),this.weaponSkill=[],this.gold.string=""+this._totalGold;var t=T.adapterScale();this.buttonList.setScale(t,t),this.expProgerssBar.node.active=!1,this.expProgerssBar.progress=0,this.expProgerssBar.node.setScale(t,t),this.onSetWaveInfo(1),this.updateLevelInfo(),this.clearSkill(),this.buttonList.active=!0,this.expProgerssBar.node.active=!1},s.onGameCoin=function(t){var e=this,i=this.gold.node.getPosition(),n=t.num,o=t.wpos,s=S.battlePath+"goldItem",a=this.gold.node.parent.getComponent(c).convertToNodeSpaceAR(o);m.getPrefab(s).then((function(t){for(var o=function(){var n=g(t),o=2*(Math.random()-.5)*100+a.x,s=2*(Math.random()-.5)*50+a.y;n.parent=e.gold.node.parent,n.setPosition(a),d(n).to(.2,{position:v(o,s,0)},{easing:"sineIn"}).delay(.2).to(.5,{position:i},{easing:"sineInOut"}).call((function(){e._totalGold++,e.gold.string=""+e._totalGold,n.destroy()})).start()},s=0;s<n;s++)o()}))},s.onSetWaveInfo=function(t){this.wave.string="第"+t+"/"+b.instance.MaxWave+"波"},s.onUpdateMonsterProgress=function(t,e){this.kill.string="杀敌数："+t,this._curExp+=e,this._maxExp=I.instance.getBattleLevelByLevel(this._level+1),this._curExp>=this._maxExp&&(this._level++,this._curExp=this._curExp-this._maxExp,this.updateLevelInfo()),this.updateLevelInfo()},s.updateLevelInfo=function(){this.expLevel.string=""+this._level,this.expProgerssBar.progress=this._curExp/this._maxExp},s.setBattleBtnStatus=function(){var t=P.instance.getGridItemDataKeys(),e=this.buttonList.children[1];t.length?(e.getComponent(u).interactable=!0,e.getComponent(h).grayscale=!1):(e.getComponent(u).interactable=!1,e.getComponent(h).grayscale=!0)},s.onRerollBtn=function(){L.emit(B.WEAPON_REMOVE_REFRESH)},s.onBattleBtn=function(){this.buttonList.active=!1,this.expProgerssBar.node.active=!0,L.emit(B.GAME_BATTLE_START)},s.onPlaceFinishBtn=function(){L.emit(B.PLACE_GRID_FINISH),this.placeList.active=!1},s.onShowHidePlaceList=function(t){this.buttonList.active=!t,this.placeList.active=t},s.onShowHideSkillList=function(t){this.skillTypeList.active=t,this.buttonList.active=!t,this.expProgerssBar.node.active=t},s.clearSkill=function(){for(var t=0;t<this.skillTypeList.children.length;t++){var e=this.skillTypeList.children[t];e.active&&e.destroy()}},s.initHeroSkill=function(){this.clearSkill();var t=f.getVisibleSize();this.skillTypeList.active=!0,this.skillTypeList.getComponent(c).width=t.width;var e=this.skillTypeList.children[0],i=10,n=100;this.weaponSkill=[];var o=Array.from(P.instance.getGridItemMapData().values()),s=o.length,a=s>8?8:s,l=Math.floor((t.width-(a+1)*i)/a)>n?n:Math.floor((t.width-(a+1)*i)/a),r=l<n?l/n:1;e.setScale(r,r);for(var p=a%2==0?-(5+(a/2-1)*i+a/2*l-l/2):-Math.floor(a/2)*(i+l),u=s>8?50:0,h=0;h<o.length;h++){var _=o[h],d=_.wid,v=_.id,S=y.instance.getWeaponCfgById(d),L=(S.SkillId,"skillTypeItem"+_.id),E=null,m=h>=8?p+h%8*(l+i):p+h*(l+i),T=h>=8?u-l-i:u;(E=g(e)).parent=this.skillTypeList,E.active=!0,E.setPosition(m,T),E.name=L,E.getComponent(x).init(v,S),this.weaponSkill.push(d)}},s.onPauseBtn=function(){E.instance.showPausePopup()},s.onEnable=function(){L.on(B.WEAPON_CHANGE_COIN,this.onGameCoin,this),L.on(B.GAME_BATTLE,this.onSetWaveInfo,this),L.on(B.UPDATE_MONSTER_PROGRESS,this.onUpdateMonsterProgress,this),L.on(B.SET_BATTLE_BTN_STATUS,this.setBattleBtnStatus,this),L.on(B.INIT_HERO_SKILL,this.initHeroSkill,this),L.on(B.SHOW_HIDE_SKILL_LIST,this.onShowHideSkillList,this),L.on(B.SHOW_HIDE_PLACE_LIST,this.onShowHidePlaceList,this)},s.onDisable=function(){L.off(B.WEAPON_CHANGE_COIN,this.onGameCoin,this),L.off(B.GAME_BATTLE,this.onSetWaveInfo,this),L.off(B.UPDATE_MONSTER_PROGRESS,this.onUpdateMonsterProgress,this),L.off(B.SET_BATTLE_BTN_STATUS,this.setBattleBtnStatus,this),L.off(B.INIT_HERO_SKILL,this.initHeroSkill,this),L.off(B.SHOW_HIDE_SKILL_LIST,this.onShowHideSkillList,this),L.off(B.SHOW_HIDE_PLACE_LIST,this.onShowHidePlaceList,this)},s.onTapBtn=function(){L.emit(B.GAME_TAP_BTN)},e}(_)).prototype,"expProgerssBar",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(N.prototype,"expLevel",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(N.prototype,"kill",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(N.prototype,"gold",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(N.prototype,"wave",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(N.prototype,"buttonList",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(N.prototype,"placeList",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(N.prototype,"skillTypeList",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=N))||R));s._RF.pop()}}}));

System.register("chunks:///_virtual/GridBgItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GridData.ts"],(function(e){var t,i,r,n,o,a,s,c,l,d,u,p,g,f,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized,o=e.createClass},function(e){a=e.cclegacy,s=e._decorator,c=e.Node,l=e.UITransform,d=e.UIOpacity,u=e.Sprite,p=e.Color,g=e.Component},function(e){f=e.GridObj,h=e.GridData}],execute:function(){var y,_,m,b,C;a._RF.push({},"9bfcbt9VBpJXrTYdzarVMdh","GridBgItem",void 0);var G=s.ccclass,V=s.property;e("GridBgItem",(y=G("GridBgItem"),_=V(c),y((C=t((b=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,r(t,"tipsNode",C,n(t)),t._gridObj=new f,t._gridValue="0",t._placeAreaKey="",t}i(t,e);var a=t.prototype;return a.init=function(e,t,i){this.node.getComponent(l).setContentSize(h.instance.gridWidth,h.instance.gridHeight),this.tipsNode.getComponent(l).setContentSize(h.instance.gridWidth,h.instance.gridHeight),this._gridObj.row=e,this._gridObj.col=t,this._gridValue=i,this.node.getComponent(d).opacity=i?255:0},a.setTipsGreen=function(){this.tipsNode.getComponent(u).color=p.GREEN},a.setTipsDefault=function(){this.tipsNode.getComponent(u).color=(new p).fromHEX("ffffff")},a.delPlaceAreaKey=function(e){this._placeAreaKey==e&&(this._placeAreaKey="",this._gridValue&&(this._gridValue="0"))},o(t,[{key:"placeAreaKey",get:function(){return this._placeAreaKey},set:function(e){this._placeAreaKey=e}},{key:"gridObj",get:function(){return this._gridObj}},{key:"gridValue",get:function(){return this._gridValue},set:function(e){this._gridValue=e}}]),t}(g)).prototype,"tipsNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=b))||m));a._RF.pop()}}}));

System.register("chunks:///_virtual/GridData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Util.ts","./WeaponData.ts","./CfgMgr.ts","./BagModel.ts"],(function(t){var i,e,r,a,n,d,g,h,s;return{setters:[function(t){i=t.createClass},function(t){e=t.cclegacy,r=t.Size,a=t.Vec3,n=t.Rect},function(t){d=t.Util},function(t){g=t.WeaponData},function(t){h=t.CfgMgr},function(t){s=t.BagCfg}],execute:function(){e._RF.push({},"fe537oi94JPVo69/FDHGzhg","GridData",void 0),t("GridData",function(){function t(){this._curGrid=109,this._gridMapData=[["0","0","0"],["0","0","0"],["0","0",""]],this._bagCfg=null,this._gridRowLen=3,this._gridColLen=3,this._gridWidth=94,this._gredHeight=94,this._space=10,this._gridItemData=new Map,this._curWeaponTildeIndex=[],this._gridEditMode=!1}var e=t.prototype;return e.init=function(){this.initGridMapData(),this.initGridItemData()},e.initGridMapData=function(){this._bagCfg=h.getDataById(new s,this._curGrid);var t=this._bagCfg.private_gridLen.split("_");this._gridMapData=this._bagCfg.private_grid,this._gridWidth=this._bagCfg.private_gridWidth,this._gredHeight=this._bagCfg.private_gredHeight,this._space=this._bagCfg.private_space,this._gridColLen=Number(t[0]),this._gridRowLen=Number(t[1])},e.initGridItemData=function(){var t=this;this.addWeaponItem(1001),this._gridItemData.forEach((function(i,e){for(var r=i.data,a=0;a<r.length;a++){var n=r[a];t._gridMapData[n.row][n.col]=e}}))},e.addWeaponItem=function(t){var i=g.instance.getWeaponCfgById(t),e=new o;e.id=d.getUuid(10),e.gid=this._curGrid,e.wid=t;for(var r=i.Points,a=[],n=0;n<r.length;n++)for(var h=r[n],s=0;s<h.length;s++){var _=new c;_.row=n,_.col=s,a.push(_)}e.data=a,this._gridItemData.set(e.id,e)},e.setRebuildGridMapData=function(t){var i=t.length,e=t[0].length;this._gridMapData=t,this._bagCfg.private_gridLen=i+"_"+e,this._gridColLen=i,this._gridRowLen=e,this._gridItemData.forEach((function(i,e){for(var r=[],a=0;a<t.length;a++)for(var n=t[a],d=0;d<n.length;d++){if(n[d]==e){var g=new c;g.row=a,g.col=d,r.push(g)}}i.data=r}))},e.getMaxGridMapSize=function(){var t=new r,i=this.bagCfg,e=i.private_gridWidth,a=i.private_gredHeight,n=i.private_space,d=i.max_gridLen.split("_"),g=Number(d[0]),h=Number(d[1]),s=h*e+(h-1)*n,o=g*a+(g-1)*n;return t.width=s,t.height=o,t},e.getGridMapSize=function(){var t=new r,i=this.bagCfg,e=i.private_gridWidth,a=i.private_gredHeight,n=i.private_space,d=i.private_gridLen.split("_"),g=Number(d[1]),h=Number(d[0]),s=g*e+(g-1)*n,o=h*a+(h-1)*n;return t.width=s,t.height=o,t},e.getGridSizeByRowCol=function(t,i){var e=new r,a=this.bagCfg,n=a.private_gridWidth,d=a.private_gredHeight,g=a.private_space,h=t*n+(t-1)*g,s=i*d+(i-1)*g;return e.width=h,e.height=s,e},e.getGridMapData=function(){return this._gridMapData},e.getGridItemData=function(){return Array.from(this._gridItemData.values())},e.getGridItemDataKeys=function(){return Array.from(this._gridItemData.keys())},e.getGridItemMapData=function(){return this._gridItemData},e.getItemPosByTiledObj=function(t){var i=this.getGridPosByTiled(t[0]),e=this.getGridPosByTiled(t[t.length-1]),r=new a(0,0,0);return r.x=(i.x+e.x)/2,r.y=(i.y+e.y)/2,r},e.getGridPosByTiled=function(t){var i=t.col*this._gridWidth+this._gridWidth/2+t.col*this._space,e=t.row*this._gredHeight+this._gredHeight/2+t.row*this._space;return new a(i,-e)},e.getGridIndexByTiled=function(t,i){return t*this._gridRowLen+i},e.getGridTiledByIndex=function(t){var i=Math.floor(t/this._gridRowLen),e=t%this._gridRowLen,r=new c;return r.row=i,r.col=e,r},e.deletGridDataByWeaponId=function(t){if(this._gridItemData.has(t)){for(var i=this._gridItemData.get(t).data,e=0;e<i.length;e++){var r=i[e];this._gridMapData[r.row][r.col]="0"}this._gridItemData.delete(t)}},e.addGridDataByWeaponId=function(t,i,e){var r=new o;r.id=e,r.gid=this._curGrid,r.wid=i,r.data=t,this._gridItemData.set(r.id,r);for(var a=0;a<t.length;a++){var n=t[a];this._gridMapData[n.row][n.col]=r.id}},e.updateGridItemData=function(t,i){this._gridItemData.has(t)&&(this._gridItemData.get(t).wid=i)},e.getTiledByPos=function(t){var i=t.x>0?Math.floor((t.x-this._gridWidth/2)/(this._gridWidth+this._space)):3,e=t.y<0?Math.floor((Math.abs(t.y)-this._gredHeight/2)/(this._gredHeight+this._space)):3,r=new c;return r.row=e,r.col=i,r},e.getTiledIndexByPos=function(t){var i=this.getTiledByPos(t);return i.col<0||i.row<0||i.col>this._gridRowLen-1||i.row>this._gridColLen-1?-1:this.getGridIndexByTiled(i.row,i.col)},e.checkSameWeapoIdByKey=function(t,i){if(this._gridItemData.has(t)&&i==this._gridItemData.get(t).wid)return!0;return!1},e.checkPointinGrid=function(t,i){for(var e=!1,r=0;r<i.length;r++){var a=i[r],d=this.getGridPosByTiled(a);if(new n(d.x-this._gridWidth/2,d.y-this.gridHeight/2,this.gridWidth,this.gridHeight).contains(t)){e=!0;break}}return e},e.getGridBgIndexByTiled=function(t,i){var e=this._bagCfg.max_gridLen.split("_");return t*Number(e[1])+i},e.clear=function(){this._gridItemData.clear(),this._curWeaponTildeIndex=[],this._bagCfg=null,this._gridEditMode=!1},i(t,[{key:"gridEditMode",get:function(){return this._gridEditMode},set:function(t){this._gridEditMode=t}},{key:"iconScale",get:function(){return this._bagCfg.picture}},{key:"space",get:function(){return this._space}},{key:"bagCfg",get:function(){return this._bagCfg}},{key:"curWeaponTildeIndex",get:function(){return this._curWeaponTildeIndex},set:function(t){this._curWeaponTildeIndex=t}},{key:"gridWidth",get:function(){return this._gridWidth}},{key:"gridHeight",get:function(){return this._gredHeight}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=null;var o=t("WeaponObj",(function(){this.id=void 0,this.wid=void 0,this.gid=void 0,this.data=void 0})),c=t("GridObj",(function(){this.row=void 0,this.col=void 0}));e._RF.pop()}}}));

System.register("chunks:///_virtual/GridItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GridData.ts"],(function(t){var e,n,o,r,i,c,s,d,a,u,l;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){o=t.cclegacy,r=t._decorator,i=t.UITransform,c=t.UIOpacity,s=t.Sprite,d=t.Color,a=t.Component},function(t){u=t.GridData,l=t.GridObj}],execute:function(){var g;o._RF.push({},"56899LXxFdFn6T5DajIIE2O","GridItem",void 0);var f=r.ccclass;r.property,t("GridItem",f("GridItem")(g=function(t){function o(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))||this)._gridObj=new l,e._gridValue="0",e}e(o,t);var r=o.prototype;return r.init=function(t,e,n){this.node.getComponent(i).setContentSize(u.instance.gridWidth,u.instance.gridHeight),this._gridObj.row=t,this._gridObj.col=e,this._gridValue=n,this.node.getComponent(c).opacity=n?255:0},r.setDeafult=function(){this.node.getComponent(s).color=(new d).fromHEX("FFFFFF")},r.setGreen=function(){this.node.getComponent(s).color=(new d).fromHEX("7ed263")},r.setRed=function(){this.node.getComponent(s).color=(new d).fromHEX("dd6662")},r.setYellow=function(){this.node.getComponent(s).color=(new d).fromHEX("dbc464")},n(o,[{key:"gridObj",get:function(){return this._gridObj}},{key:"gridValue",get:function(){return this._gridValue}}]),o}(a))||g);o._RF.pop()}}}));

System.register("chunks:///_virtual/GridManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GridData.ts","./EventListener.ts","./GameEvent.ts","./GridItem.ts","./WeaponData.ts","./GridBgItem.ts"],(function(e){var t,i,n,r,a,o,s,l,c,d,u,f,g,p,h,v,G,m,b,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,s=e.Node,l=e.Prefab,c=e.instantiate,d=e.Rect,u=e.v2,f=e.UITransform,g=e.Component},function(e){p=e.GridData,h=e.GridObj},function(e){v=e.EventListener},function(e){G=e.GameEvent},function(e){m=e.GridItem},function(e){b=e.WeaponData},function(e){I=e.GridBgItem}],execute:function(){var L,y,C,P,_,w,T,W,A,D,E;a._RF.push({},"40e3bgPqJ9JEqCu6pQ/roWG","GridManager",void 0);var N=o.ccclass,S=o.property;e("GridManager",(L=N("GridManager"),y=S(s),C=S(s),P=S(l),_=S(l),L((W=t((T=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,n(t,"allGridList",W,r(t)),n(t,"gridList",A,r(t)),n(t,"gridPrefab",D,r(t)),n(t,"gridBgPrefab",E,r(t)),t}i(t,e);var a=t.prototype;return a.init=function(){p.instance.init(),this.initGridList(),this.initAllGridList()},a.initAllGridList=function(){for(var e=p.instance.bagCfg.max_grid,t=0;t<e.length;t++)for(var i=e[t],n=0;n<i.length;n++){var r=i[n],a=c(this.gridBgPrefab);a.parent=this.allGridList,a.getComponent(I).init(t,n,r)}},a.initGridList=function(){this.gridList.removeAllChildren();for(var e=p.instance.getGridMapData(),t=0;t<e.length;t++)for(var i=e[t],n=0;n<i.length;n++){var r=i[n],a=c(this.gridPrefab);a.parent=this.gridList,a.getComponent(m).init(t,n,r)}},a.initGridStatus=function(){for(var e=this.gridList.children,t=0;t<e.length;t++){e[t].getComponent(m).setDeafult()}},a.cherGridStatus=function(e,t){for(var i=t.weaponCfg.Id,n=[],r=this.gridList.children,a=p.instance.getGridMapData(),o=0;o<e.length;o++){for(var s=e[o],l=-1,c=0;c<r.length;c++){var f=r[c],g=f.getComponent(m).gridObj,h=f.getComponent(m).gridValue,I=p.instance.getGridPosByTiled(g),L=p.instance.gridWidth,y=p.instance.gridHeight;if(new d(I.x-L/2,I.y-y/2,L,y).contains(u(s.x,s.y))&&h){l=c;break}}n.push(l)}p.instance.curWeaponTildeIndex=n;var C=[];if(n.includes(-1))for(var P=0;P<r.length;P++){var _=r[P];if(n.includes(P)){var w=p.instance.getGridTiledByIndex(P);if(a[w.row][w.col]){_.getComponent(m).setRed();var T=a[w.row][w.col];C.includes(T)||C.push(T)}else _.getComponent(m).setYellow()}else _.getComponent(m).setDeafult()}else{for(var W=0,A="",D=0;D<r.length;D++){var E=r[D];if(n.includes(D)){E.getComponent(m).setGreen();var N=p.instance.getGridTiledByIndex(D);A=a[N.row][N.col],p.instance.checkSameWeapoIdByKey(A,i)&&W++,C.includes(A)||C.push(A)}else E.getComponent(m).setDeafult()}if(W==n.length){var S=t.weaponCfg.Level,B=t.weaponCfg.weaponGroupNum;b.instance.checkWeaponByLevel(S+1,B)&&(C=[],t.setIconYellow(),v.emit(G.WEAPON_ICON_STATUS,A,!0))}}for(var O=0;O<C.length;O++){var M=C[O];v.emit(G.WEAPON_SHAKE,M)}},a.onWeaponMove=function(e){var t=e.weaponKey,i=e.weaponCfg,n=i.Type.split("_"),r=Number(n[0]),a=Number(n[1]),o=[],s=i.Points;p.instance.deletGridDataByWeaponId(t);for(var l=0;l<r;l++)for(var c=0;c<a;c++)if(s[l][c]){var d=new h;d.row=l,d.col=c;var u=p.instance.getGridPosByTiled(d),g=e.point.getComponent(f).convertToWorldSpaceAR(u),m=e.node.parent.getComponent(f).convertToNodeSpaceAR(g);o.push(m)}v.emit(G.WEAPON_ICON_STATUS_INIT),this.cherGridStatus(o,e)},a.onEnable=function(){v.on(G.WEAPON_MOVE,this.onWeaponMove,this),v.on(G.WEAPON_PlACE,this.initGridStatus,this),v.on(G.INIT_BUILD_GRID_LIST,this.initGridList,this)},a.onDisable=function(){v.off(G.WEAPON_MOVE,this.onWeaponMove,this),v.off(G.WEAPON_PlACE,this.initGridStatus,this),v.off(G.INIT_BUILD_GRID_LIST,this.initGridList,this)},a.clear=function(){p.instance.clear()},t}(g)).prototype,"allGridList",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(T.prototype,"gridList",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(T.prototype,"gridPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(T.prototype,"gridBgPrefab",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=T))||w));a._RF.pop()}}}));

System.register("chunks:///_virtual/GridMapManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./EventListener.ts","./ResourcesUtil.ts","./Util.ts","./GridData.ts","./GameEvent.ts","./GridBgItem.ts","./WeaponItem.ts"],(function(t){var e,i,n,o,a,r,s,h,d,l,c,g,p,u,f,_,m,v,G,A,L,C,b,w,P;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){a=t.cclegacy,r=t._decorator,s=t.Node,h=t.Vec3,d=t.UITransform,l=t.Layout,c=t.v3,g=t.UIOpacity,p=t.Rect,u=t.v2,f=t.Component,_=t.Sprite},function(t){m=t.Constants},function(t){v=t.EventListener},function(t){G=t.ResourcesUtil},function(t){A=t.Util},function(t){L=t.GridData,C=t.GridObj},function(t){b=t.GameEvent},function(t){w=t.GridBgItem},function(t){P=t.WeaponItem}],execute:function(){var y,T,S,E,R,M,D,I,N,O,B,x,W,K,k,H,z,U,j;a._RF.push({},"c4c63CTU+5Nc5yMg+A5m9eD","GridMapManager",void 0);var F=r.ccclass,V=r.property,Z=(t("GridMapManager",(y=F("GridMapManager"),T=V(s),S=V(s),E=V(s),R=V(s),M=V(s),D=V(s),I=V(s),N=V(s),y((x=e((B=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,n(e,"bgs",x,o(e)),n(e,"bg",W,o(e)),n(e,"gridList",K,o(e)),n(e,"allGridList",k,o(e)),n(e,"weaponList",H,o(e)),n(e,"removeWeaponList",z,o(e)),n(e,"preWeaponList",U,o(e)),n(e,"preBg",j,o(e)),e._gridRes=["bag1","bag1","bag3","bag5","bag5","bag6","bag6","bag7","bag7","bag8","bag8","bag9","bag"],e._padding=90,e.startPoint=null,e._isTouch=!1,e._offfSet=new h(0,0,0),e._startPos=new h(0,0,0),e._placeStatus=!1,e._temPos=new h(0,0,0),e._temPoint=null,e._temAddPoint=null,e._mainAreaKey="1",e._addPlaceAreaData=new Map,e}i(e,t);var a=e.prototype;return a.init=function(){this.initGridRes(),this.initStatPoint()},a.initStatPoint=function(){var t=L.instance.bagCfg.max_gridLen.split("_"),e=L.instance.bagCfg.private_gridLen.split("_"),i=Math.floor((Number(t[0])-Number(e[0]))/2),n=Math.floor((Number(t[1])-Number(e[1]))/2),o=new C;o.row=i,o.col=n,this.startPoint=o},a.initAllGridRes=function(){var t=this,e=L.instance.space,i=L.instance.getMaxGridMapSize(),n=L.instance.gridWidth;this.allGridList.getComponent(d).setContentSize(i),this.allGridList.getComponent(l).spacingX=e,this.allGridList.getComponent(l).spacingY=e,this.bg.getComponent(d).setContentSize(i.width+this._padding,i.height+this._padding),this.bg.getComponent(l).paddingTop=this._padding/2,this.bg.getComponent(l).paddingBottom=this._padding/2,this.bg.getComponent(l).paddingLeft=this._padding/2,this.bg.getComponent(l).paddingRight=this._padding/2,this.allGridList.getComponent(l).updateLayout(!0),this.bg.getComponent(l).updateLayout(!0),this.allGridList.setPosition(-i.width/2,i.height/2),this.removeWeaponList.setPosition(0,-i.height/2-100);for(var o=function(e){var o=t._gridRes[e],a=t.bgs[e].getComponent(_),r=m.gridPath+o+"/spriteFrame";G.geSpriteFrame(r).then((function(o){a.spriteFrame=o;var r=t.resNodePos(e,i,t._padding,n);r.equals(h.ZERO)||t.bgs[e].setPosition(r)}))},a=0;a<this._gridRes.length;a++)o(a)},a.initGridRes=function(){var t=this,e=L.instance.space,i=L.instance.getGridMapSize(),n=L.instance.gridWidth,o=L.instance.bagCfg.private_gridLen.split("_");this.gridList.getComponent(d).setContentSize(i),this.gridList.getComponent(l).spacingX=e,this.gridList.getComponent(l).spacingY=e,this.bg.getComponent(d).setContentSize(i.width+this._padding,i.height+this._padding),this.bg.getComponent(l).paddingTop=this._padding/2,this.bg.getComponent(l).paddingBottom=this._padding/2,this.bg.getComponent(l).paddingLeft=this._padding/2,this.bg.getComponent(l).paddingRight=this._padding/2,this.gridList.getComponent(l).updateLayout(!0),this.bg.getComponent(l).updateLayout(!0),this.gridList.setPosition(-i.width/2,i.height/2),this.weaponList.setPosition(-i.width/2,i.height/2),this.preWeaponList.setPosition(-i.width/2,i.height/2),this.weaponList.getComponent(d).setContentSize(i.width,i.height),this.preWeaponList.getComponent(d).setContentSize(i.width,i.height);var a=Number(o[0])>5?100:200;this.removeWeaponList.setPosition(0,-i.height/2-a);for(var r=function(e){var o=t._gridRes[e],a=t.bgs[e].getComponent(_),r=m.gridPath+o+"/spriteFrame";G.geSpriteFrame(r).then((function(o){a.spriteFrame=o;var r=t.resNodePos(e,i,t._padding,n);r.equals(h.ZERO)||t.bgs[e].setPosition(r)}))},s=0;s<this._gridRes.length;s++)r(s)},a.resNodePos=function(t,e,i,n){var o=h.ZERO;switch(t){case 0:o=c(-(e.width-100)/2,-e.height/2-10,0);break;case 1:o=c((e.width-100)/2,-e.height/2-10,0);break;case 2:o=c(0,e.height/2+i/2-i/2/3,0);break;case 3:o=c(e.width/2+i/2/3,e.height/2,0);break;case 4:o=c(-(e.width/2+i/2/3),e.height/2,0);break;case 5:o=c(10-(n/2+n),e.height/2+i/2,0);break;case 6:o=c(n/2+n-10,e.height/2+i/2,0);break;case 7:o=c(-e.width/2-i/4,-e.height/2+n/2+i/4,0);break;case 8:o=c(e.width/2+i/4,-e.height/2+n/2+i/4,0);break;case 9:o=c(-(e.width/2+i/2/3),e.height/2-30,0);break;case 10:o=c(e.width/2+i/2/3,e.height/2-30,0);break;case 11:o=c(0,e.height/2-i/2+20,0),this.bgs[t].getComponent(d).width=e.width}return o},a.setNodeOpacity=function(t){this.weaponList.getComponent(g).opacity=t;for(var e=0;e<this.removeWeaponList.children.length;e++){var i=this.removeWeaponList.children[e];i.getComponent(P)&&(i.getComponent(g).opacity=t)}},a.setMainPlaceAreaKey=function(t){for(var e=this.getGridMapObjArr(),i=this.allGridList.children,n=[],o=0;o<e.length;o++){var a=e[o],r=L.instance.getGridMapData()[a.row][a.col],s=t.row+a.row,h=t.col+a.col,d=new C;d.row=s,d.col=h,n.push(d);var l=i[L.instance.getGridBgIndexByTiled(s,h)];l.getComponent(w).placeAreaKey=this._mainAreaKey,l.getComponent(w).gridValue=r}var c=new Z;c.item=this.weaponList,c.data=n,this._addPlaceAreaData.set(this._mainAreaKey,c)},a.setAddPlaceAreaKey=function(t){for(var e=this._temAddPoint,i=this.getPointGridObjArr(t.weaponCfg),n=this.allGridList.children,o=[],a=0;a<i.length;a++){var r=i[a],s=e.row+r.row,h=e.col+r.col,d=new C;d.row=s,d.col=h,o.push(d),n[L.instance.getGridBgIndexByTiled(s,h)].getComponent(w).placeAreaKey=t.weaponKey}var l=new Z;l.item=t.node,l.data=o,this._addPlaceAreaData.set(t.weaponKey,l)},a.delPlaceAreaKey=function(t){for(var e=this.allGridList.children,i=0;i<e.length;i++){e[i].getComponent(w).delPlaceAreaKey(t)}},a.getConnectStatus=function(t){var e=!1,i=L.instance.bagCfg.max_gridLen.split("_");if(t.row>=0&&t.col>=0&&t.row<=Number(i[0])-1&&t.col<=Number(i[1])-1){var n=L.instance.getGridBgIndexByTiled(t.row,t.col);this.allGridList.children[n].getComponent(w).placeAreaKey==this._mainAreaKey&&(e=!0)}return e},a.checkAddAreaGridData=function(){var t=this;this._addPlaceAreaData.forEach((function(e,i){if(i!=t._mainAreaKey){for(var n=e.item,o=e.data,a=!1,r=0;r<o.length;r++){var s=o[r],h=new C;h.row=s.row-1,h.col=s.col,a||(a=t.getConnectStatus(h));var d=new C;d.row=s.row+1,d.col=s.col,a||(a=t.getConnectStatus(d));var l=new C;l.row=s.row,l.col=s.col-1,a||(a=t.getConnectStatus(l));var c=new C;if(c.row=s.row,c.col=s.col+1,a||(a=t.getConnectStatus(c)),a)break}a?(n.destroy(),t.rebuildGridData()):(v.emit(b.ADD_REMOVE_WEAPON_LIST,n),t._addPlaceAreaData.delete(i),t.delPlaceAreaKey(i))}}))},a.rebuildGridData=function(){var t=[];this._addPlaceAreaData.forEach((function(e,i){var n=e.data;t=t.concat(n)}));var e=[],i=[];t.sort((function(t,e){return t.row-e.row})),e.push(t[0].row),e.push(t[t.length-1].row),t.sort((function(t,e){return t.col-e.col})),i.push(t[0].col),i.push(t[t.length-1].col);for(var n=[],o=this.allGridList.children,a=e[0];a<=e[1];a++){for(var r=[],s=i[0];s<=i[1];s++){var h=o[L.instance.getGridBgIndexByTiled(a,s)],d=h.getComponent(w).placeAreaKey?h.getComponent(w).gridValue:"";r.push(d)}n.push(r)}L.instance.setRebuildGridMapData(n),v.emit(b.INIT_BUILD_GRID_LIST),v.emit(b.INIT_BUILD_WEAPON_POS),this.startPoint.row=e[0],this.startPoint.col=i[0]},a.debugAllList=function(){for(var t=this.allGridList.children,e=0;e<7;e++)for(var i=[],n=0;n<5;n++){var o=t[L.instance.getGridBgIndexByTiled(e,n)].getComponent(w).placeAreaKey;i.push(o)}},a.debugAllListValue=function(){for(var t=this.allGridList.children,e=0;e<7;e++)for(var i=[],n=0;n<5;n++){var o=t[L.instance.getGridBgIndexByTiled(e,n)].getComponent(w).gridValue;i.push(o)}},a.debugAllListGridObj=function(){for(var t=this.allGridList.children,e=0;e<7;e++)for(var i=[],n=0;n<5;n++){var o=t[L.instance.getGridBgIndexByTiled(e,n)].getComponent(w).gridObj;i.push(o)}},a.onPlaceGridStart=function(t){if(!this.allGridList.active){this.initAllGridListPlaceValue(),L.instance.gridEditMode=!0,this.gridList.parent=this.preBg,t.node.parent=this.node,this.allGridList.active=!0,this.setNodeOpacity(100),this.initAllGridRes(),this.node.parent.getComponent(d).height=this.allGridList.getComponent(d).height,v.emit(b.SHOW_HIDE_PLACE_LIST,!0);var e=L.instance.getGridPosByTiled(this.startPoint),i=this.allGridList.getComponent(d).convertToWorldSpaceAR(e),n=this.node.parent.getComponent(d).convertToNodeSpaceAR(i),o=L.instance.gridWidth,a=L.instance.gridHeight;this.gridList.setPosition(n.x-o/2,n.y+a/2),this.weaponList.setPosition(n.x-o/2,n.y+a/2),this.setMainPlaceAreaKey(this.startPoint)}this.delPlaceAreaKey(t.weaponKey)},a.onPlaceGridMove=function(t){t.node.parent=this.node,this.initAllGridListTips();var e=new C;e.row=0,e.col=0;var i=L.instance.getGridPosByTiled(e),n=t.point.getComponent(d).convertToWorldSpaceAR(i),o=this.allGridList.getComponent(d).convertToNodeSpaceAR(n),a=this.allGridList.children,r=L.instance.bagCfg.max_gridLen.split("_");this._placeStatus=!1;for(var s=0;s<a.length;s++){var l=a[s].getComponent(w).gridObj,c=L.instance.getGridPosByTiled(l),g=L.instance.gridWidth,f=L.instance.gridHeight;if(new p(c.x-g/2,c.y-f/2,g,f).contains(u(o.x,o.y))){for(var _=this.getPointGridObjArr(t.weaponCfg),m=[],v=0;v<_.length;v++){var G=_[v],b=l.row+G.row,P=l.col+G.col;if(b<Number(r[0])&&P<Number(r[1])){var y=a[L.instance.getGridBgIndexByTiled(b,P)];y.getComponent(w).placeAreaKey?m.push(0):(y.getComponent(w).setTipsGreen(),m.push(1))}else m.push(0)}if(m.includes(0))this._placeStatus=!1;else{this._placeStatus=!0;for(var T=this.allGridList.getComponent(d).convertToWorldSpaceAR(c),S=this.node.parent.getComponent(d).convertToNodeSpaceAR(T),E=t.weaponCfg.Points,R=[],M=0;M<E.length;M++)for(var D=E[M],I=0;I<D.length;I++){var N=new C;N.row=M,N.col=I,R.push(N)}var O=R[R.length-1],B=new C;B.row=l.row+O.row,B.col=l.col+O.col;var x=L.instance.getGridPosByTiled(B),W=this.allGridList.getComponent(d).convertToWorldSpaceAR(x),K=this.node.parent.getComponent(d).convertToNodeSpaceAR(W),k=new h(0,0,0);k.x=(S.x+K.x)/2,k.y=(S.y+K.y)/2,this._temPos=k,this._temAddPoint=A.clone(l)}break}}},a.onPlaceGridEnd=function(t){var e=t.node;this.initAllGridListTips(),this._placeStatus?(e.setPosition(this._temPos),this.setAddPlaceAreaKey(t)):(v.emit(b.ADD_REMOVE_WEAPON_LIST,e),this._addPlaceAreaData.delete(t.weaponKey)),this._placeStatus=!1},a.onPlaceGridFinish=function(){this.allGridList.active&&(this.checkAddAreaGridData(),L.instance.gridEditMode=!1,this.allGridList.active=!1,this.gridList.parent=this.bg,this.setNodeOpacity(255),this.initGridRes(),v.emit(b.SHOW_HIDE_PLACE_LIST,!1))},a.getFirstGridObj=function(){for(var t=L.instance.getGridMapData(),e=null,i=0;i<t.length;i++){for(var n=t[i],o=0;o<n.length;o++){if(n[o]){(e=new C).row=i,e.col=o;break}}if(e)break}return e},a.getGridMapObjArr=function(){for(var t=L.instance.getGridMapData(),e=[],i=0;i<t.length;i++)for(var n=t[i],o=0;o<n.length;o++){if(n[o]){var a=new C;a.row=i,a.col=o,e.push(a)}}return e},a.getPointGridObjArr=function(t){for(var e=t.Points,i=[],n=0;n<e.length;n++)for(var o=e[n],a=0;a<o.length;a++){if(o[a]){var r=new C;r.row=n,r.col=a,i.push(r)}}return i},a.initAllGridListTips=function(){for(var t=this.allGridList.children,e=0;e<t.length;e++){t[e].getComponent(w).setTipsDefault()}},a.initAllGridListPlaceValue=function(){for(var t=this.allGridList.children,e=0;e<t.length;e++){t[e].getComponent(w).placeAreaKey=""}},a.checkAllGridListByPos=function(t){var e=this.allGridList.children,i=L.instance.bagCfg.max_gridLen.split("_");this._placeStatus=!1;for(var n=0;n<e.length;n++){var o=e[n].getComponent(w).gridObj,a=L.instance.getGridPosByTiled(o),r=L.instance.gridWidth,s=L.instance.gridHeight;if(new p(a.x-r/2,a.y-s/2,r,s).contains(u(t.x,t.y))){for(var h=this.getGridMapObjArr(),l=[],c=0;c<h.length;c++){var g=h[c],f=o.row+g.row,_=o.col+g.col;if(f<Number(i[0])&&_<Number(i[1])){var m=e[L.instance.getGridBgIndexByTiled(f,_)];m.getComponent(w).placeAreaKey?l.push(0):(m.getComponent(w).setTipsGreen(),l.push(1))}else l.push(0)}if(l.includes(0))this._placeStatus=!1;else{this._placeStatus=!0;var v=this.allGridList.getComponent(d).convertToWorldSpaceAR(a),G=this.node.parent.getComponent(d).convertToNodeSpaceAR(v),C=L.instance.gridWidth,b=L.instance.gridHeight;this._temPos.x=G.x-C/2,this._temPos.y=G.y+b/2,this._temPoint=A.clone(o)}break}}},a.setGridMoveTips=function(){this.initAllGridListTips();var t=new C;t.row=0,t.col=0;var e=L.instance.getGridPosByTiled(t),i=this.gridList.getComponent(d).convertToWorldSpaceAR(e),n=this.allGridList.getComponent(d).convertToNodeSpaceAR(i);this.checkAllGridListByPos(n)},a.onTouchStart=function(t){for(var e=this.node.parent.getComponent(d).convertToNodeSpaceAR(new h(t.x,t.y,0)),i=L.instance.getGridMapData(),n=!1,o=0;o<i.length;o++){for(var a=i[o],r=0;r<a.length;r++){if(a[r]){var s=new C;s.row=o,s.col=r;var l=L.instance.getGridPosByTiled(s),c=this.gridList.getComponent(d).convertToWorldSpaceAR(l),g=this.node.parent.getComponent(d).convertToNodeSpaceAR(c),f=L.instance.gridWidth,_=L.instance.gridHeight;if(new p(g.x-f/2,g.y-_/2,f,f).contains(u(e.x,e.y))){n=!0;break}}}if(n)break}L.instance.gridEditMode&&n&&(this._isTouch=!0,this._offfSet=this.weaponList.getComponent(d).convertToNodeSpaceAR(new h(t.x,t.y,0)),this._startPos=this.weaponList.getPosition(),this.delPlaceAreaKey(this._mainAreaKey))},a.onTouchMove=function(t){if(this._isTouch){var e=this.node.parent.getComponent(d).convertToNodeSpaceAR(new h(t.x,t.y,0)),i=new h(e.x-this._offfSet.x,e.y-this._offfSet.y);this.gridList.setPosition(i),this.weaponList.setPosition(i),this.setGridMoveTips()}},a.onTouchEnd=function(t){this._isTouch&&(this._isTouch=!1,this._placeStatus&&(this._startPos=this._temPos,this.startPoint=this._temPoint),this.gridList.setPosition(this._startPos),this.weaponList.setPosition(this._startPos),this._placeStatus=!1,this.initAllGridListTips(),this.setMainPlaceAreaKey(this.startPoint))},a.onTouchCancle=function(t){this._isTouch&&(this._isTouch=!1,this._placeStatus=!1,this.gridList.setPosition(this._startPos),this.weaponList.setPosition(this._startPos),this.initAllGridListTips())},a.onClearAreaData=function(){this._addPlaceAreaData.clear()},a.onEnable=function(){v.on(b.PLACE_GRID_START,this.onPlaceGridStart,this),v.on(b.PLACE_GRID_MOVE,this.onPlaceGridMove,this),v.on(b.PLACE_GRID_END,this.onPlaceGridEnd,this),v.on(b.GAME_TOUCH_START,this.onTouchStart,this),v.on(b.GAME_TOUCH_MOVE,this.onTouchMove,this),v.on(b.GAME_TOUCH_END,this.onTouchEnd,this),v.on(b.GAME_TOUCH_CANCLE,this.onTouchEnd,this),v.on(b.CLEAR_AREA_DATA,this.onClearAreaData,this),v.on(b.PLACE_GRID_FINISH,this.onPlaceGridFinish,this)},a.onDisable=function(){v.off(b.PLACE_GRID_START,this.onPlaceGridStart,this),v.off(b.PLACE_GRID_MOVE,this.onPlaceGridMove,this),v.off(b.PLACE_GRID_END,this.onPlaceGridEnd,this),v.off(b.GAME_TOUCH_START,this.onTouchStart,this),v.off(b.GAME_TOUCH_MOVE,this.onTouchMove,this),v.off(b.GAME_TOUCH_END,this.onTouchEnd,this),v.off(b.GAME_TOUCH_CANCLE,this.onTouchEnd,this),v.off(b.CLEAR_AREA_DATA,this.onClearAreaData,this),v.off(b.PLACE_GRID_FINISH,this.onPlaceGridFinish,this)},e}(f)).prototype,"bgs",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),W=e(B.prototype,"bg",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(B.prototype,"gridList",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(B.prototype,"allGridList",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(B.prototype,"weaponList",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(B.prototype,"removeWeaponList",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(B.prototype,"preWeaponList",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(B.prototype,"preBg",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=B))||O)),t("GridBgObj",(function(){this.data=void 0,this.item=void 0})));a._RF.pop()}}}));

System.register("chunks:///_virtual/HeroBase.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts","./EventListener.ts","./GameEvent.ts","./HeroData.ts","./SkillData.ts","./MonsterData.ts","./AudioManager.ts"],(function(e){var t,i,n,o,r,l,a,s,c,u,f,h,p,k,S,g,d,y,v,H,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,a=e.sp,s=e.Node,c=e.Prefab,u=e.Vec3,f=e.color,h=e.tween},function(e){p=e.default},function(e){k=e.EventListener},function(e){S=e.GameEvent},function(e){g=e.HeroData,d=e.HeroAnim},function(e){y=e.SkillData,v=e.SkillBulletObj},function(e){H=e.MonsterData},function(e){m=e.AudioManager}],execute:function(){var b,E,_,A,T,P,C,D,R;r._RF.push({},"52b720GqCpG9oe8aaI0Em0S","HeroBase",void 0);var O=l.ccclass,w=l.property;e("HeroBase",(b=O("HeroBase"),E=w(a.Skeleton),_=w(s),A=w(c),b((C=t((P=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,n(t,"heroSpine",C,o(t)),n(t,"skillTypeList",D,o(t)),n(t,"skillTypePrefab",R,o(t)),t._firePos=new u(0,70,0),t.isCollider=void 0,t.heroKey="",t.releaseSkillStatus=!0,t._showHitTotalTime=.15,t}i(t,e);var r=t.prototype;return r.initBorn=function(){k.emit(S.SHOW_HERO_HP,this.node.getPosition()),this.heroKey=g.instance.heroKey,this.heroSpine.setAnimation(0,d.IDLE,!0),this.insertRectCircleObj()},r.getFirePos=function(){var e=this.node.getPosition();return new u(e.x+this._firePos.x,e.y+this._firePos.y,0)},r.updateSkillDamageInterval=function(){},r.insertRectCircleObj=function(){k.emit(S.INSERT_HERO_CIRCLE_OBJ,this.heroKey,this)},r.onAttacked=function(e){this.playHit(),g.instance.curHp=e,k.emit(S.UPDATE_HERO_HP)},r.playHit=function(){var e=this.heroSpine;e.color=f(255,255,255,1);var t=f(255,255,255,50);h(e).to(this._showHitTotalTime,{},{onUpdate:function(e,i){t=f(255,255,255,50*i),e.color=t}}).call((function(){t=f(255,255,255,255),e.color=t})).start()},r.releaseSkill=function(){var e=this;if(this.releaseSkillStatus){var t=g.instance.getQueueSkill();t&&(this.releaseSkillStatus=!1,m.instance.playSound(5),this.unschedule(this.initHeroAnim),this.heroSpine.setAnimation(0,d.ATK,!1),this.scheduleOnce((function(){var i=new v;i.skillKey=t.skillKey,i.skillCfg=y.instance.getUpgradeSkillBySkillId(t.skillCfg),i.pos=e.getFirePos(),i.targetPos=new u(0,-200,0);for(var n=i.skillCfg.Salvo,o=0;o<n;o++){var r=H.instance.getNearMonster(i.skillKey);if(r.length)for(var l=i.skillCfg.BulletCount,a=0;a<l;a++)for(var s=0;s<1;s++){var c=i.skillCfg.IntervalAngle,f=y.instance.getSkillDirAngle(a,c);s<r.length&&k.emit(S.CREATE_SKILL_EFFECT,i,r[s],f,.1*o)}}e.releaseSkillStatus=!0,t.callback&&t.callback(),e.scheduleOnce(e.initHeroAnim,1)}),t.animTime))}},r.initHeroAnim=function(){this.heroSpine.addAnimation(0,d.IDLE,!0)},r.onEnable=function(){k.on(S.HERO_HURT,this.onAttacked,this)},r.onDisable=function(){k.off(S.HERO_HURT,this.onAttacked,this)},r.childUpdate=function(e){},t}(p)).prototype,"heroSpine",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(P.prototype,"skillTypeList",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(P.prototype,"skillTypePrefab",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=P))||T));r._RF.pop()}}}));

System.register("chunks:///_virtual/HeroData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,i,r;return{setters:[function(e){t=e.createClass},function(e){n=e.cclegacy,i=e.Vec2,r=e.Vec3}],execute:function(){n._RF.push({},"bb7bbazU8hHH7H+JeHxuMK9","HeroData",void 0),e("HeroData",function(){function e(){this._heroPoint=new r(0,-620,0),this._heroR=450,this._rangeW=200,this._rangeH=500,this._heroKey="1001",this._ReleaseSkillQueue=[],this._curHp=0,this._maxHp=300}var n=e.prototype;return n.init=function(){this._curHp=500,this._maxHp=500},n.checkInHeroRange=function(e,t){if(i.distance(e,new i(this._heroPoint.x,this._heroPoint.y))<100)return!1;if(e.y-this.heroPoint.y<300){var n=new r,u=r.subtract(n,this._heroPoint.clone(),new r(e.x,e.y,0));t.dir=u.normalize()}return!0},n.addQueueSkill=function(e){this._ReleaseSkillQueue.push(e)},n.getQueueSkill=function(){return this._ReleaseSkillQueue.shift()},n.clear=function(){this._ReleaseSkillQueue=[]},t(e,[{key:"heroPoint",get:function(){return this._heroPoint}},{key:"heroKey",get:function(){return this._heroKey}},{key:"heroR",get:function(){return this._heroR}},{key:"maxHp",get:function(){return this._maxHp}},{key:"curHp",get:function(){return this._curHp},set:function(e){this._curHp-=e,this._curHp<=0&&(this._curHp=0)}}],[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}())._instance=null;e("HeroAnim",function(e){return e.IDLE="Idle",e.ATK="Skill",e.DIE="die",e}({}));n._RF.pop()}}}));

System.register("chunks:///_virtual/HeroHpItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventListener.ts","./GameEvent.ts","./HeroData.ts","./GameDefine.ts","./OpenPopupManager.ts","./Util.ts"],(function(t){var e,n,i,r,o,a,s,p,c,u,l,m,h,f,H,b,g,d,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,s=t.Node,p=t.Label,c=t.UITransform,u=t.ProgressBar,l=t.tween,m=t.Component},function(t){h=t.EventListener},function(t){f=t.GameEvent},function(t){H=t.HeroData,b=t.HeroAnim},function(t){g=t.GameDefine},function(t){d=t.OpenPopupManager},function(t){v=t.Util}],execute:function(){var y,w,D,E,P,A,I,_,C;o._RF.push({},"f84e2Gtlm9LUIZobBtPl4iy","HeroHpItem",void 0);var T=a.ccclass,O=a.property;t("HeroHpItem",(y=T("HeroHpItem"),w=O(s),D=O(s),E=O(p),y((I=e((A=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"barAnim",I,r(e)),i(e,"bar",_,r(e)),i(e,"hpText",C,r(e)),e}n(e,t);var o=e.prototype;return o.init=function(){var t=v.adapterScale();this.barAnim.getComponent(c).width=this.node.getComponent(c).width,this.getComponent(u).progress=1,this.hpText.string=""+H.instance.curHp,this.node.setScale(t,t)},o.setHeroHp=function(){var t=this,e=H.instance.curHp,n=H.instance.maxHp;this.hpText.string=""+H.instance.curHp,e<=0&&(e=0),this.getComponent(u).progress=e/n;var i=this.bar.getComponent(c).width,r=this.barAnim.getComponent(c).width-i;l(this.barAnim.getComponent(c)).by(.2,{width:-r}).call((function(){e<=0&&(g.gameOver=!0,g.gameStart=!1,h.emit(f.HERO_ANIM,b.DIE),d.instance.showGameOverPopup(0),t.node.destroy())})).start()},o.onEnable=function(){h.on(f.UPDATE_HERO_HP,this.setHeroHp,this)},o.onDisable=function(){h.off(f.UPDATE_HERO_HP,this.setHeroHp,this)},e}(m)).prototype,"barAnim",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(A.prototype,"bar",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=e(A.prototype,"hpText",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=A))||P));o._RF.pop()}}}));

System.register("chunks:///_virtual/HeroItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameDefine.ts","./HeroBase.ts"],(function(e){var t,r,n,o,i;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,n=e._decorator},function(e){o=e.GameDefine},function(e){i=e.HeroBase}],execute:function(){var c;r._RF.push({},"2cadejCYdZBKrCfzup7CJ4/","HeroItem",void 0);var s=n.ccclass;n.property,e("HeroItem",s("HeroItem")(c=function(e){function r(){return e.apply(this,arguments)||this}t(r,e);var n=r.prototype;return n.init=function(){this.initBorn()},n.childUpdate=function(e){o.gameStart&&this.releaseSkill()},r}(i))||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/HeroManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourcesUtil.ts","./HeroItem.ts","./HeroData.ts","./Constants.ts"],(function(e){var t,n,r,o,i,a,c,s,u,l,h,f,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,c=e.Node,s=e.instantiate,u=e.Component},function(e){l=e.ResourcesUtil},function(e){h=e.HeroItem},function(e){f=e.HeroData},function(e){p=e.Constants}],execute:function(){var H,g,v,P,y;i._RF.push({},"05904hsJphIWZgNzrf1SUbi","HeroManager",void 0);var d=a.ccclass,b=a.property;e("HeroManager",(H=d("HeroManager"),g=b(c),H((y=t((P=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,r(t,"heroParent",y,o(t)),t}n(t,e);var i=t.prototype;return i.init=function(){f.instance.init(),this.creatHero()},i.creatHero=function(){var e=this,t=p.heroPath;l.getPrefab(t).then((function(t){var n=s(t),r=f.instance.heroPoint;n.parent=e.heroParent,n.setPosition(r),n.getComponent(h).init(),n.active=!1}))},i.showHideHero=function(e){this.heroParent.children[0].active=e},i.clear=function(){f.instance.clear()},t}(u)).prototype,"heroParent",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=P))||v));i._RF.pop()}}}));

System.register("chunks:///_virtual/Load.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./AudioManager.ts","./CfgMgr.ts","./OpenPopupManager.ts","./SystemConstantModel.ts"],(function(t){var e,o,r,n,a,s,i,c,l,u,p,g,f,d,h,y,P;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){a=t.cclegacy,s=t._decorator,i=t.ProgressBar,c=t.Label,l=t.Node,u=t.director,p=t.resources,g=t.Component},function(t){f=t.Constants},function(t){d=t.AudioManager},function(t){h=t.CfgMgr},function(t){y=t.OpenPopupManager},function(t){P=t.SystemConstantCfg}],execute:function(){var C,m,L,v,B,b,M,_,D;a._RF.push({},"47e05tFPodPoaFGg/ApUzzN","Load",void 0);var R=s.ccclass,N=s.property;t("Load",(C=R("Load"),m=N(i),L=N(c),v=N(l),C((M=e((b=function(t){function e(){for(var e,o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,r(e,"progressBar",M,n(e)),r(e,"lbText",_,n(e)),r(e,"PersistRoot",D,n(e)),e._progress=0,e}o(e,t);var a=e.prototype;return a.onLoad=function(){this.initPopupLayer(),this.loadLocalGameConfg()},a.initPopupLayer=function(){u.addPersistRootNode(this.PersistRoot),y.instance.TopLayer=this.PersistRoot.getChildByName("Top"),y.instance.MidLayer=this.PersistRoot.getChildByName("Middle"),y.instance.BottomLayer=this.PersistRoot.getChildByName("Bottom"),y.instance.ToastLayer=this.PersistRoot.getChildByName("Toast")},a.loadLocalGameConfg=function(){var t=this;p.loadDir(f.ConfigPath,(function(e,o,r){var n=80/o;t._progress+=n,t.setProgressBar()}),(function(e,o){for(var r=0;r<o.length;r++){var n=o[r];h.setCfgData(n.name,n.json)}d.instance.init(),t.initData()}))},a.initData=function(){this.convertConstantData(),this.preloadScene()},a.convertConstantData=function(){h.getCfgDataArray(new P).forEach((function(t){f.SysConstant[t.ConstantName]=t}))},a.setProgressBar=function(){this.lbText.string=Math.floor(this._progress)+"%",this.progressBar.progress=this._progress/100},a.preloadScene=function(){var t=this,e="Game";u.preloadScene(e,(function(e,o){var r=Math.floor(e/o*20);t._progress<80+r&&(t._progress=80+r),t.setProgressBar()}),(function(){t._progress=100,t.setProgressBar(),u.loadScene(e)}))},e}(g)).prototype,"progressBar",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(b.prototype,"lbText",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(b.prototype,"PersistRoot",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=b))||B));a._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Constants.ts","./AudioManager.ts","./BackgroundAdapter.ts","./BaseComponent.ts","./CfgMgr.ts","./Configuration.ts","./ContentAdapter.ts","./ContentScale.ts","./ContentWidthAdapter.ts","./Debug.ts","./EventListener.ts","./GameController.ts","./OpenPopupManager.ts","./PoolManager.ts","./PopupManager.ts","./ResourcesUtil.ts","./SpriteEx.ts","./Util.ts","./animationUI.ts","./GameDefine.ts","./BlastItem.ts","./DamageItem.ts","./HeroHpItem.ts","./MonsterHpItem.ts","./Shadow.ts","./SynItem.ts","./ChapterMapData.ts","./GameData.ts","./GridData.ts","./HeroData.ts","./MonsterData.ts","./PlayerData.ts","./SkillData.ts","./SkillUpgradeData.ts","./WeaponData.ts","./GameEvent.ts","./GridBgItem.ts","./GridItem.ts","./HeroBase.ts","./HeroItem.ts","./BattleUIManager.ts","./BgManager.ts","./BoxManager.ts","./GridManager.ts","./GridMapManager.ts","./HeroManager.ts","./MonsterManager.ts","./SkillManager.ts","./WeaponManager.ts","./MonsterEvent.ts","./MonsterBase.ts","./MonsterItem.ts","./SkillBulletBase.ts","./SkillBulletItem.ts","./SkillTypeItem.ts","./WeaponBgItem.ts","./WeaponItem.ts","./SysOpenData.ts","./MainEvent.ts","./BagModel.ts","./BattleLevelModel.ts","./ChapterEventModel.ts","./ChapterModel.ts","./MonsterModel.ts","./SkillModel.ts","./SkillTargetModel.ts","./SkillUpgradeMode.ts","./SoundModel.ts","./SystemConstantModel.ts","./WeaponModel.ts","./ChapterData.ts","./TipsPopup.ts","./Toast.ts","./GameOverPopup.ts","./GamePopup.ts","./PausePopup.ts","./SkillSelectPopup.ts","./SkillSelectItem.ts","./WeaponDetailPopup.ts","./Game.ts","./Load.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainEvent.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"8648axqgfJL17PIoUJZQZGU","MainEvent",void 0),n("MainEvent",(function(){})).SHOW_TOAST="showToast",t._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterBase.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts","./PoolManager.ts","./EventListener.ts","./GameEvent.ts","./MonsterEvent.ts","./MonsterModel.ts","./ChapterEventModel.ts","./MonsterData.ts","./HeroData.ts","./GameDefine.ts"],(function(t){var e,i,s,n,o,r,h,a,c,m,u,l,f,d,p,v,M,E,g,H,C,S,y,_,A,b,B;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,s=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){o=t.cclegacy,r=t._decorator,h=t.AnimationComponent,a=t.v3,c=t.Vec3,m=t.Sprite,u=t.Color,l=t.Animation,f=t.CircleCollider2D,d=t.Vec2,p=t.color,v=t.tween,M=t.UITransform},function(t){E=t.default},function(t){g=t.PoolManager},function(t){H=t.EventListener},function(t){C=t.GameEvent},function(t){S=t.MonsterEvent},function(t){y=t.MonsterAmin},function(t){_=t.MonsterType},function(t){A=t.MonsterData},function(t){b=t.HeroData},function(t){B=t.GameDefine}],execute:function(){var R,T,D,w,I;o._RF.push({},"1634eQBtIVM3bFh1eHG/Url","MonsterBase",void 0);var P=r.ccclass,k=r.property,N=(t("MonsterBase",(R=P("MonsterBase"),T=k(h),R((I=e((w=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o))||this,s(e,"monsterAnim",I,n(e)),e.monsterHpItem=null,e.monsterShadow=null,e.initStatus=!1,e.monsterCfg=null,e.monsterObj=null,e.moveSpeed=80,e.monsterId=101,e.monsterHp=10,e.curHp=10,e.atk=5,e.atkTime=0,e.dir=a(0,-1,0),e.scale=1,e.isMove=!0,e.curAnim="",e.curPos=new c,e.colliderPos=new c,e.boundBox=null,e.monsterKey="",e.isDie=!1,e.isCollider=void 0,e.isHurt=!1,e.isRepulse=!1,e._moveEffect=null,e._showHitTotalTime=.15,e}i(e,t);var o=e.prototype;return o.setMonsterBorn=function(){this.moveSpeed=A.instance.getMonsterSpeed(this.monsterCfg.Speed),this.monsterId=this.monsterCfg.Id,this.monsterHp=A.instance.getMonsterHp(this.monsterCfg.Hp*Number(this.monsterObj.HpUp)),this.curHp=this.monsterHp,this.atk=A.instance.getMonsterAtk(this.monsterCfg.mType),this.dir=a(0,-1,0),this.isMove=!0,this.atkTime=0,this.monsterAnim.getComponent(m).color=new u(255,255,255),this.setMonsterSize();var t=this.monsterCfg.mType==_.BOSS?"boss":"monster";this.monsterKey=t+this.monsterId+Math.random().toString().substring(2,6)+Math.random().toString().substring(2,12),this.setMonsterBoundBox(),A.instance.addMonsterNodeByKey(this),this.isDie=!1,this.isHurt=!1,this.isRepulse=!1,H.emit(C.SHOW_MONSTER_HP,this),H.emit(C.SHOW_MONSTER_SHADOW,this),this.curPos=this.node.getPosition(),this.initStatus=!0},o.setMonsterSize=function(){this.scale=this.monsterCfg.IconScale,this.node.setScale(a(this.scale,this.scale,this.scale))},o.setMonsterAnim=function(t,e){this.curAnim!=t&&this.monsterCfg&&(this.monsterAnim.play(t),this.curAnim=t)},o.setMonsterAnimEvent=function(){var t=this;this.monsterAnim.on(l.EventType.FINISHED,(function(e){t.attackHero(t.atk),t.setMonsterAnim(y.Move)}))},o.attackHero=function(t){H.emit(C.HERO_HURT,t)},o.getColliderPos=function(){var t=this.curPos.clone(),e=this.boundBox.offset;return t.x+=e.x,t.y+=e.y,t},o.setMonsterBoundBox=function(){this.boundBox=this.node.getComponent(f),this.boundBox.radius=this.monsterCfg.ColliderRadius;var t=this.monsterCfg.ColliderOffset?this.monsterCfg.ColliderOffset.split("|"):["0","0"];this.boundBox.offset=new d(Number(t[0]),Number(t[1]))},o.getBoundBoxCircle=function(){return this.boundBox instanceof f?this.boundBox.radius:20},o.monsterMoveFrame=function(t){if(!this.isRepulse)if(this.isMove){this.setMonsterAnim(y.Move);var e=this.node.getPosition(),i=this.dir.clone().multiply(a(this.moveSpeed*t,this.moveSpeed*t,0)),s=e.add(i);this.node.setPosition(s),this.curPos=s,this.isMove=b.instance.checkInHeroRange(new d(s.x,s.y),this)}else this.atkTime-=t,this.atkTime<=0&&(this.setMonsterAnim(y.Atk,!1),this.atkTime=this.monsterCfg.Interval,this.setMonsterAnimEvent())},o.insertRectCircleObj=function(t){this.initStatus&&H.emit(C.INSERT_QUARD_TREE_RECT_CIRCLE,this.monsterKey,this,this.boundBox)},o.onAttacked=function(t,e,i){if(void 0===e&&(e=0),t>0&&!this.isDie){var s=Math.ceil(t);this.curHp-=s,this.monsterHpItem&&this.monsterHpItem.setMonsterHp(this.curHp,this.monsterHp),H.emit(C.CREATE_DAMAGER_NUM,this.getColliderPos(),s,e),this.curHp<=0?(this.curHp=0,this.isDie=!0,this.clear(),H.emit(S.MONSTER_DIE,this.curPos)):this.playHit()}},o.playHit=function(){var t=this.monsterAnim.getComponent(m);t.color=p(255,255,255,1);var e=p(255,255,255,50);v(t).to(this._showHitTotalTime,{},{onUpdate:function(t,i){e=p(255,255,255,50*i),t.color=e}}).call((function(){e=p(255,255,255,255),t.color=e})).start()},o.setMonsterHurtEffect=function(t){var e=this;if(void 0===t&&(t=.3),!this.isDie&&!this.isHurt){this.isHurt=!0;var i=this.monsterAnim.getComponent(m);i.color=(new u).fromHEX("FF4B4B"),this.scheduleOnce((function(){e.isHurt=!1,i.color=new u(255,255,255)}),t)}},o.setMonsterHurtMoveEffect=function(t,e,i,s){if(t.length){var n=t[0],o=Number(n[0]),r=Number(n[1])+e,h=Number(n[2]),a=new N;switch(a.speed=r,a.time=h,o){case 1:a.dir=i;break;case 2:var m=new c;c.subtract(m,this.getColliderPos(),s),a.dir=m.normalize();break;case 3:a.dir=i}this._moveEffect=a,this.isRepulse=!0}},o.moveRepulseEffectFrame=function(t){if(this.isRepulse&&this._moveEffect)if(this._moveEffect.time-=t,this._moveEffect.time<=0)this.isRepulse=!1,this._moveEffect=null;else{var e=this.node.getPosition();if(e.y>B.viewHeight/2+this.monsterAnim.node.getComponent(M).height/2)return this.isRepulse=!1,void(this._moveEffect=null);var i=this._moveEffect.dir,s=this._moveEffect.speed,n=i.multiply(a(s*t,s*t,0)),o=e.add(n);if(Math.abs(o.x)>B.viewWidth/2-this.monsterAnim.node.getComponent(M).width/2)n=new c(0,1,0).multiply(a(s*t,s*t,0)),o=e.add(n);this.node.setPosition(o),this.curPos=o}},o.setBossDie=function(){H.emit(S.MONSTER_DIE,this.curPos),this.clear()},o.checkColliderCount=function(){},o.updateSkillDamageInterval=function(){},o.clear=function(){H.emit(C.SHOW_MONSTER_DIE_EFFECT,this.node.getPosition()),this.monsterShadow&&this.monsterShadow.clear(),this.initStatus=!1,this.monsterCfg=null,this.monsterObj=null,this.monsterHpItem=null,this.monsterShadow=null,this.isDie=!1,this.isMove=!0,this.isHurt=!1,this.isRepulse=!1,A.instance.killNum=1,H.emit(C.DELETE_QUARD_TREE_OBJ,this.monsterKey),A.instance.deleteNearMonster(this.monsterKey),g.instance.putNodeByKey(this.node,this.monsterId.toString()),A.instance.deleteMonsterNodeByKey(this.monsterKey)},o.childUpdate=function(t){},e}(E)).prototype,"monsterAnim",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=w))||D)),t("MoveEffect",(function(){this.speed=void 0,this.time=void 0,this.dir=void 0})));o._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ChapterEventModel.ts","./CfgMgr.ts","./Util.ts","./MonsterModel.ts","./GameDefine.ts"],(function(t){var e,n,s,r,i,a,o,h,u,c,M;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,s=t.Vec3,r=t.Vec2,i=t.v3,a=t.view},function(t){o=t.ChapterEventCfg},function(t){h=t.CfgMgr},function(t){u=t.Util},function(t){c=t.MonsterCfg},function(t){M=t.GameDefine}],execute:function(){n._RF.push({},"43feaU49+ZAJb6zeIrQqFaT","MonsterData",void 0),t("MonsterData",function(){function t(){this._nearMonsterData=new Map,this._monsterNodeMap=new Map,this._maxCheckCont=3,this._brushMonsterPoint=new Map,this._killNum=0,this._killBossNum=0,this._brushMonsterEventData=[],this._wave=0,this._MaxWave=10}var n=t.prototype;return n.init=function(){this._brushMonsterEventData=u.clone(h.getCfgDataArray(new o)),this.MaxWave=this._brushMonsterEventData[this._brushMonsterEventData.length-1].Wave},n.setNearMonster=function(t,e,n){var s=new Map;this._nearMonsterData.has(t)?(s=this._nearMonsterData.get(t)).size<this._maxCheckCont&&this.addSkillRangeMonster(e,n,s):(this._nearMonsterData.set(t,s),this.addSkillRangeMonster(e,n,s))},n.addSkillRangeMonster=function(t,e,n){for(var r=Array.from(this._monsterNodeMap.values()),i=0;i<r.length;i++){var a=r[i],o=a.curPos,h=a.monsterKey;s.distance(t,o)<=e&&n.size<this._maxCheckCont&&n.set(h,a)}},n.getNearMonster=function(t){var e=[];if(this._nearMonsterData.has(t))for(var n=Array.from(this._nearMonsterData.get(t).values()),s=0;s<n.length;s++){var r=n[s];r&&e.push(r.curPos)}return e},n.deleteNearMonster=function(t){this._nearMonsterData.forEach((function(e,n){e.has(t)&&e.delete(t)}))},n.clearNearMonster=function(){this._nearMonsterData.clear()},n.getNearMonsterTarget=function(t){var e=new Map;return this._nearMonsterData.has(t)&&(e=this._nearMonsterData.get(t)),e},n.checkNearMonster=function(t){return!!this._nearMonsterData.has(t)&&!!this._nearMonsterData.get(t).size},n.addMonsterNodeByKey=function(t){t&&this._monsterNodeMap.set(t.monsterKey,t)},n.deleteMonsterNodeByKey=function(t){this._monsterNodeMap.delete(t)},n.checkSkillNearMonster=function(t,e){var n=!1;if(this._monsterNodeMap.size)for(var r=Array.from(this._monsterNodeMap.values()),i=0;i<r.length;i++){var a=r[i];if(a&&a.initStatus){var o=a.curPos;if(s.distance(t,o)<=e){n=!0;break}}}return n},n.setBrushMonsterPoint=function(t,e){this._brushMonsterPoint.set(t,e)},n.setBossBrushPoint=function(t,e){},n.getAppointMonsterPoint=function(t){void 0===t&&(t=new r(0,100));var e=this._brushMonsterPoint.size,n=Math.floor(Math.random()*e),s=this._brushMonsterPoint.get(n),i=u.getRectRandPos(s);return i.x+=t.x,i.y+=t.y,i},n.getBossBrushPoint=function(t){void 0===t&&(t=new r(100,100));var e=M.viewHeight/2+Math.random()*t.x;return i(0,e,0)},n.getScreenUpRandPos=function(t){void 0===t&&(t=new r(60,50));var e=a.getVisibleSize(),n=e.width-t.x,i=new s;return i.x=(Math.random()-.5)*n,i.y=e.height/2+Math.random()*t.y-200,i},n.getMonsterCfgById=function(t){return h.getDataById(new c,t)},n.getMonsterAtk=function(t){return 10},n.getMonsterHp=function(t){return t},n.getMonsterSpeed=function(t){return t},n.clear=function(){this._nearMonsterData.clear(),this._monsterNodeMap.clear(),this._brushMonsterPoint.clear(),this._killNum=0,this._killBossNum=0,this._wave=0,this._MaxWave=15,this._brushMonsterEventData=[]},e(t,[{key:"wave",get:function(){return this._wave},set:function(t){this._wave=t}},{key:"MaxWave",get:function(){return this._MaxWave},set:function(t){this._MaxWave=t}},{key:"killBossNum",get:function(){return this._killBossNum},set:function(t){this._killBossNum+=t}},{key:"killNum",get:function(){return this._killNum},set:function(t){this._killNum+=t}},{key:"brushMonsterEventData",get:function(){return this._brushMonsterEventData}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=null;t("MonsterObj",(function(){this.id=void 0,this.HpUp=1})),t("MonsterEventObj",(function(){this.monsterId=void 0,this.HpUp=void 0,this.startTime=void 0,this.secNum=void 0,this.diffNum=void 0,this.curNum=0,this.totalNum=1}));n._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterEvent.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"57d4aClDBhKubGr6xXTpywI","MonsterEvent",void 0);var n=e("MonsterEvent",(function(){}));n.CREATE_MONSTER="createMonster",n.MONSTER_DIE="monsterDie",n.ADD_NEAR_MONSTER="addNearMonster",t._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterHpItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts","./PoolManager.ts","./GameDefine.ts"],(function(t){var e,n,o,i,r,s,a,c,p,u,l,h,m,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,c=t.UITransform,p=t.ProgressBar,u=t.UIOpacity,l=t.tween},function(t){h=t.default},function(t){m=t.PoolManager},function(t){f=t.GameDefine}],execute:function(){var d,g,b,y,C,M,H;r._RF.push({},"237f5e5BC5FArB67QHuARAX","MonsterHpItem",void 0);var v=s.ccclass,w=s.property;t("MonsterHpItem",(d=v("MonsterHpItem"),g=w(a),b=w(a),d((M=e((C=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,o(e,"barAnim",M,i(e)),o(e,"bar",H,i(e)),e._com=null,e}n(e,t);var r=e.prototype;return r.init=function(t){this.barAnim.getComponent(c).width=this.node.getComponent(c).width,this.getComponent(p).progress=1,this.getComponent(u).opacity=0,this._com=t},r.setMonsterHp=function(t,e){var n=this;t<=0&&(t=0),this.unschedule(this.setMonsterHide),this.getComponent(u).opacity=255,this.getComponent(p).progress=t/e;var o=this.bar.getComponent(c).width,i=this.barAnim.getComponent(c).width-o;this.scheduleOnce(this.setMonsterHide,.5),l(this.barAnim.getComponent(c)).by(.2,{width:-i}).call((function(){t<=0&&n.clear()})).start()},r.setMonsterHide=function(){this.getComponent(u).opacity=0},r.setMonsterHpPos=function(){var t=this._com.getColliderPos(),e=this._com.node.getComponent(c).height;this.node.setPosition(t.x,t.y+2*e/3,0)},r.clear=function(){m.instance.putNode(this.node)},r.childUpdate=function(t){f.gameStart&&this._com&&this.setMonsterHpPos()},e}(h)).prototype,"barAnim",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(C.prototype,"bar",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=C))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MonsterBase.ts","./GameDefine.ts"],(function(t){var e,s,n,i,r,o;return{setters:[function(t){e=t.inheritsLoose},function(t){s=t.cclegacy,n=t._decorator,i=t.director},function(t){r=t.MonsterBase},function(t){o=t.GameDefine}],execute:function(){var c;s._RF.push({},"15d32i74JZKNYfV93JUtcSJ","MonsterItem",void 0);var a=n.ccclass;n.property,t("MonsterItem",a("MonsterItem")(c=function(t){function s(){return t.apply(this,arguments)||this}e(s,t);var n=s.prototype;return n.init=function(t,e){this.monsterCfg=t,this.monsterObj=e,this.initStatus=!1,this.isDie=!1,this.setMonsterBorn()},n.childUpdate=function(t){if(o.gameStart&&this.initStatus){i.getTotalFrames();this.monsterMoveFrame(t),this.moveRepulseEffectFrame(t)}},s}(r))||c);s._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./MonsterItem.ts","./ResourcesUtil.ts","./EventListener.ts","./MonsterEvent.ts","./BaseComponent.ts","./GameEvent.ts","./ChapterEventModel.ts","./MonsterModel.ts","./MonsterData.ts","./Constants.ts","./GameDefine.ts","./OpenPopupManager.ts"],(function(t){var e,n,r,s,i,o,a,u,h,c,l,m,f,M,p,v,_,d,E,g,C,N,T,A,P,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){i=t.cclegacy,o=t._decorator,a=t.Node,u=t.instantiate,h=t.Sprite,c=t.AnimationComponent,l=t.Vec3},function(t){m=t.PoolManager},function(t){f=t.MonsterItem},function(t){M=t.ResourcesUtil},function(t){p=t.EventListener},function(t){v=t.MonsterEvent},function(t){_=t.default},function(t){d=t.GameEvent},function(t){E=t.MonsterType},function(t){g=t.MonsterAmin},function(t){C=t.MonsterData,N=t.MonsterEventObj,T=t.MonsterObj},function(t){A=t.Constants},function(t){P=t.GameDefine},function(t){b=t.OpenPopupManager}],execute:function(){var R,S,B,D,y;i._RF.push({},"bc381bL0FRA+qOjTTLMP7lu","MonsterManager",void 0);var O=o.ccclass,I=o.property;t("MonsterManager",(R=O("MonsterManager"),S=I(a),R((y=e((D=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i))||this,r(e,"monsterParent",y,s(e)),e._monsterPrefabMap=new Map,e._gameTime=0,e._brushMonsterEventArr=[],e._queeuMonsterArr=[],e._curChapterEvent=null,e._curTotalNum=0,e._curKillNum=0,e._screenMonsterCount=0,e._schduleTime=1,e}n(e,t);var i=e.prototype;return i.init=function(){this._schduleTime=1,C.instance.init()},i.setCurChapterEvent=function(){C.instance.brushMonsterEventData.length&&(this._curChapterEvent=C.instance.brushMonsterEventData.shift(),C.instance.wave=this._curChapterEvent.Wave,this.setBrushMonsterEvent())},i.setBrushMonsterEvent=function(){this._curTotalNum=0,this._curKillNum=0;this._curChapterEvent.eType;for(var t=this._curChapterEvent.Event.split(","),e=0;e<t.length;e++){var n=t[e].split("|"),r=Number(n[0]),s=Number(n[1]),i=Number(n[2]),o=Number(n[3])-i,a=Math.floor(s/o),u=s-o*a,h=new N;h.HpUp=this._curChapterEvent.HpUp,h.monsterId=r,h.startTime=i,h.secNum=a,h.diffNum=u,h.curNum=0,h.totalNum=s,this._brushMonsterEventArr.push(h),this._curTotalNum+=s}},i.getBossEventByWeight=function(t){for(var e=0,n=0,r=0,s=[],i=0;i<t.length;i++){var o=t[i].split("|"),a=Number(o[4]);s.push(a),r+=a}var u=Math.floor(Math.random()*r),h=0;return s.some((function(t,r){if(n=e+t,u>=e&&u<n)return h=r,!0;e=n})),t[h]},i.onCreateMonster=function(t){for(var e=this,n=function(){if(e._queeuMonsterArr.length){var t=e._queeuMonsterArr.shift(),n=t.id,r=null,s=new l,i=C.instance.getMonsterCfgById(n);if(e._monsterPrefabMap.has(n))s=i.mType!=E.BOSS?C.instance.getScreenUpRandPos():C.instance.getBossBrushPoint(),r=m.instance.getNodeItemById(e._monsterPrefabMap.get(n),n.toString()),e.monsterParent.addChild(r),r.setPosition(s),r.getComponent(f).init(i,t);else{var o=A.monsterPath;M.getPrefab(o).then((function(n){e.loadMonsterRes(t,i,n)}))}}},r=0;r<t;r++)n()},i.loadMonsterRes=function(t,e,n){var r=this,s=u(n),i=A.monsterIconPath+e.Icon+"/spriteFrame";M.geSpriteFrame(i).then((function(t){s.getChildByName("icon").getComponent(h).spriteFrame=t}));var o=A.monsterAnimPath;M.loadDir(o).then((function(n){if(n.length){var i=e.mType!=E.BOSS?C.instance.getScreenUpRandPos():C.instance.getBossBrushPoint(),o=s.getChildByName("icon").getComponent(c);r.monsterParent.addChild(s),s.setPosition(i);for(var a=0;a<n.length;a++){var u=n[a];o.addClip(n[a]),u.name==g.Move&&(o.defaultClip=u)}s.getComponent(f).init(e,t),r._monsterPrefabMap.set(e.Id,s)}}))},i.onMonsterDie=function(t){if(this._curKillNum++,p.emit(d.UPDATE_MONSTER_PROGRESS,C.instance.killNum,10),!this.monsterParent.children.length)if(C.instance.clearNearMonster(),this._curChapterEvent.Wave>=C.instance.MaxWave)P.gameOver=!0,P.gameStart=!1,b.instance.showGameOverPopup(1);else{var e=this._curChapterEvent.Wave+1;this._curChapterEvent.Box?this.scheduleOnce((function(){p.emit(d.GAME_BATTLE,e),p.emit(d.CREATE_DROP_BOX,t)}),1):(this.setCurChapterEvent(),p.emit(d.GAME_BATTLE,this._curChapterEvent.Wave))}},i.triggleBrushMonsterEvent=function(t){if(this._gameTime+=t,this._schduleTime-=t,this._schduleTime<=0)for(var e=0,n=this._brushMonsterEventArr.length;e<n;e++){var r=this._brushMonsterEventArr[e];if(r.curNum<r.totalNum){if(this._gameTime>=r.startTime){this._schduleTime=1;var s=r.secNum;r.diffNum&&(r.diffNum--,s+=1);for(var i=0;i<s;i++){var o=new T;o.id=r.monsterId,o.HpUp=r.HpUp,this._queeuMonsterArr.push(o)}r.curNum+=s}}else this._brushMonsterEventArr.splice(e,1),e--,n--}},i.onAddNearMonster=function(t,e){},i.onEnable=function(){p.on(v.CREATE_MONSTER,this.onCreateMonster,this),p.on(v.MONSTER_DIE,this.onMonsterDie,this),p.on(v.ADD_NEAR_MONSTER,this.onAddNearMonster,this)},i.onDisable=function(){p.off(v.CREATE_MONSTER,this.onCreateMonster,this),p.off(v.MONSTER_DIE,this.onMonsterDie,this),p.off(v.ADD_NEAR_MONSTER,this.onAddNearMonster,this)},i.setMonsterSort=function(){var t=this.monsterParent.children;t.sort((function(t,e){return Math.round(e.position.y)-Math.round(t.position.y)}));for(var e=0;e<t.length;e++)t[e].setSiblingIndex(e)},i.clear=function(){this._monsterPrefabMap.clear(),C.instance.clear(),this._gameTime=0,this._schduleTime=1,this._brushMonsterEventArr=[],this._queeuMonsterArr=[],this._curChapterEvent=null,this.monsterParent.destroyAllChildren()},i.childUpdate=function(t){if(P.gameStart&&(this.triggleBrushMonsterEvent(t),this.setMonsterSort(),this._queeuMonsterArr.length)){var e=this._queeuMonsterArr.length>60?Math.ceil(this._queeuMonsterArr.length/60):1;this.onCreateMonster(e)}},e}(_)).prototype,"monsterParent",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=D))||B));i._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterModel.ts",["cc"],(function(i){var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"c3918UZqVtApaVupxixI5Ut","MonsterModel",void 0);i("MonsterCfg",(function(){this.ClassName="Monster",this.Id=void 0,this.mType=void 0,this.Name=void 0,this.Dec=void 0,this.Sort=void 0,this.Icon=void 0,this.IconScale=void 0,this.shadeScale=void 0,this.shadeOffsetY=void 0,this.ColliderRadius=void 0,this.ColliderOffset=void 0,this.Speed=void 0,this.Atk=void 0,this.Hp=void 0,this.Grow_Up=void 0,this.Range=void 0,this.Interval=void 0,this.Skill_Immunity=void 0,this.Defense=void 0,this.Skill=void 0,this.Missile_Effect=void 0,this.Move_Def=void 0,this.Status_Def=void 0,this.Status_Resist=void 0,this.Show=void 0,this.Characteristic=void 0,this.Die_Animation=void 0,this.Valid=void 0,this.Version=void 0,this.Volume=void 0,this.Weaken=void 0})),i("MonsterAmin",function(i){return i.Move="Move",i.Atk="Skill",i}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/OpenPopupManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./Toast.ts","./GameController.ts","./PopupManager.ts","./ResourcesUtil.ts"],(function(n){var t,e,o,a,p,s,i,u,r;return{setters:[function(n){t=n.createClass},function(n){e=n.cclegacy,o=n.instantiate},function(n){a=n.Constants},function(n){p=n.Toast},function(n){s=n.default},function(n){i=n.PopupManager,u=n.PopupOptions},function(n){r=n.ResourcesUtil}],execute:function(){e._RF.push({},"2e999vijwZOkpi2Rl4QGn2h","OpenPopupManager",void 0),n("OpenPopupManager",function(){function n(){this.TopLayer=null,this.MidLayer=null,this.BottomLayer=null,this.ToastLayer=null}var e=n.prototype;return e.showSeqPopup=function(n,t,e,o){var a=new u;a.path=n,a.parent=this.TopLayer,i.instance.pushToPopupSeq(a,e,o)},e.hideSeqPopup=function(n,t){i.instance.shiftFromPopupSeq(n,t)},e.addHidePopup=function(n){i.instance.addHidePopup(n)},e.showChapterPopup=function(n){var t=new u;t.path=a.PopupUI.ChapterPopup,t.parent=n,i.instance.show(t)},e.showGamePopup=function(){var n=new u;n.path=a.PopupUI.GamePopup,n.parent=this.BottomLayer,n.closeCur=!0,i.instance.show(n)},e.showGameOverPopup=function(n){var t=new u;t.path=a.PopupUI.GameOverPopup,t.parent=this.TopLayer,i.instance.show(t,[n])},e.showWeaponDetailPopup=function(n){var t=new u;t.path=a.PopupUI.WeaponDetailPopup,t.parent=this.MidLayer,i.instance.show(t,[n])},e.showPausePopup=function(){var n=new u;n.path=a.PopupUI.PausePopup,n.parent=this.MidLayer,s.pause(),i.instance.show(n)},e.showToast=function(n,t){var e=this;void 0===t&&(t=0);var s=a.toastPath;r.getPrefab(s).then((function(a){var s=o(a);s.parent=e.ToastLayer,s.setPosition(0,t),s.getComponent(p).init(n)}))},t(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}())._instance=null,e._RF.pop()}}}));

System.register("chunks:///_virtual/PausePopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./EventListener.ts","./GameController.ts","./PopupManager.ts","./GameEvent.ts"],(function(n){var t,e,o,u,s,r,p,i,a;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator,u=n.Component},function(n){s=n.Constants},function(n){r=n.EventListener},function(n){p=n.default},function(n){i=n.PopupManager},function(n){a=n.GameEvent}],execute:function(){var c;e._RF.push({},"b2536DTNS1Ii5OAmWoVKrzx","PausePopup",void 0);var P=o.ccclass;o.property,n("PausePopup",P("PausePopup")(c=function(n){function e(){return n.apply(this,arguments)||this}t(e,n);var o=e.prototype;return o.show=function(){},o.onReturnBtn=function(){i.instance.hide(s.PopupUI.PausePopup),p.resume()},o.onStartBtn=function(){i.instance.hide(s.PopupUI.PausePopup),p.resume(),r.emit(a.GAME_OVER)},e}(u))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e;return{setters:[function(n){t=n.createClass},function(n){e=n.cclegacy}],execute:function(){e._RF.push({},"2cf576ioxpCAaOFMsTCq3pg","PlayerData",void 0),n("PlayerData",function(){function n(){this._playerInfo=new a}return t(n,[{key:"playerInfo",get:function(){return this._playerInfo}}],[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}())._instance=null;var a=n("PlayerObj",(function(){this.gold=0,this.curChapter=4010101,this.unlockChapter=4010301}));e._RF.pop()}}}));

System.register("chunks:///_virtual/PoolManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,i,e,n,a,r;return{setters:[function(t){o=t.inheritsLoose,i=t.createClass},function(t){e=t.cclegacy,n=t.instantiate,a=t.NodePool,r=t.Component}],execute:function(){e._RF.push({},"fcd3aoftHFN/Iw6BfOJPxdN","PoolManager",void 0),t("PoolManager",function(t){function e(){for(var o,i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return(o=t.call.apply(t,[this].concat(e))||this)._dictPool={},o}o(e,t);var r=e.prototype;return r.getNode=function(t,o){var i=t.name;t.position||(i=t.data.name);var e=null;if(this._dictPool.hasOwnProperty(i)){var r=this._dictPool[i];e=r.size()>0?r.get():n(t)}else{var s=new a;this._dictPool[i]=s,e=n(t)}return e.parent=o,e.setPosition(1e4,1e5),e.active=!0,e},r.getNodeItem=function(t){var o=t.name;t.position||(o=t.data.name);var i=null;if(this._dictPool.hasOwnProperty(o)){var e=this._dictPool[o];i=e.size()>0?e.get():n(t)}else{var r=new a;this._dictPool[o]=r,i=n(t)}return i.setPosition(1e4,1e5),i.active=!0,i},r.getNodeItemById=function(t,o){var i=null;if(this._dictPool.hasOwnProperty(o)){var e=this._dictPool[o];i=e.size()>0?e.get():n(t)}else{var r=new a;this._dictPool[o]=r,i=n(t)}return i.setPosition(1e4,1e5),i.active=!0,i},r.putNodeByKey=function(t,o){var i=new a;this._dictPool.hasOwnProperty(o)?i=this._dictPool[o]:this._dictPool[o]=i,t.active=!1,i.put(t)},r.getPoolSizeByPrefab=function(t){var o=0,i=t.name;(t.position||(i=t.data.name),this._dictPool.hasOwnProperty(i))&&(o=this._dictPool[i].size());return o},r.putPool=function(t){if(t){var o=t.name,i=null;this._dictPool.hasOwnProperty(o)?i=this._dictPool[o]:(i=new a,this._dictPool[o]=i),t.active=!1,i.put(t)}},r.putNode=function(t){if(t){var o=t.name,i=new a;this._dictPool.hasOwnProperty(o)?i=this._dictPool[o]:this._dictPool[o]=i,t.active=!1,i.put(t)}},r.clearPool=function(t){this._dictPool.hasOwnProperty(t)&&this._dictPool[t].clear()},r.clear=function(){for(var t in this._dictPool){if(this._dictPool.hasOwnProperty(t))this._dictPool[t].clear()}},r.prePool=function(t,o){var i=t.data.name,e=new a;this._dictPool[i]=e;for(var r=0;r<o;r++){var s=n(t);e.put(s)}},i(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}(r))._instance=void 0,e._RF.pop()}}}));

System.register("chunks:///_virtual/PopupManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourcesUtil.ts"],(function(i){var t,o,n,e,a,s,p;return{setters:[function(i){t=i.createClass},function(i){o=i.cclegacy,n=i._decorator,e=i.isValid,a=i.find,s=i.Vec3},function(i){p=i.ResourcesUtil}],execute:function(){var r,h;o._RF.push({},"eb72adhUm1IXpHlO5jdi3i9","PopupManager",void 0);var c=n.ccclass;n.property,i("PopupManager",c("PopupManager")(((h=function(){function i(){this._dictSharedPanel={},this._dictLoading={},this._arrPopupDialog=[],this._hidePopupArr=[],this._showTipsTime=0}var o=i.prototype;return o.isDialogVisible=function(i){if(!this._dictSharedPanel.hasOwnProperty(i))return!1;var t=this._dictSharedPanel[i];return e(t)&&t.active&&e(t.parent)},o.show=function(i,t,o){var n=this,s=i.path;if(!this._dictLoading[s]){i.closeCur&&this.hideJoinPopup(s);var r=s.lastIndexOf("/"),h=s.slice(r+1);if(t||(t=[]),this._dictSharedPanel.hasOwnProperty(s)){var c=this._dictSharedPanel[s];if(e(c)){var u;c.parent=null!=(u=i.parent)?u:a("Canvas"),c.active=!0;var l=c.getComponent(h),d=c.getComponent(h.charAt(0).toUpperCase()+h.slice(1)),f=c.getComponent("animationUI");if(l&&l.show)l.show.apply(l,t),f?f.open((function(){o&&o(l)})):o&&o(l);else{if(!d||!d.show)throw"查找不到脚本文件"+h;d.show.apply(d,t),f?f.open((function(){o&&o(d)})):o&&o(d)}return}}this._dictLoading[s]=!0,p.createUI(s,i.parent).then((function(i){var e=!1;n._dictLoading[s]||(e=!0),n._dictLoading[s]=!1,n._dictSharedPanel[s]=i;var a=i.getComponent("animationUI"),p=i.getComponent(h),r=i.getComponent(h.charAt(0).toUpperCase()+h.slice(1));if(p&&p.show)p.show.apply(p,t),a?a.open((function(){o&&o(p)})):o&&o(p);else{if(!r||!r.show)throw"查找不到脚本文件"+h+" 或 未定义show方法";r.show.apply(r,t),a?a.open((function(){o&&o(r)})):o&&o(r)}e&&n.hide(s)}))}},o.hide=function(i,t){if(this._dictSharedPanel.hasOwnProperty(i)){var o=this._dictSharedPanel[i];if(o&&e(o)){var n=o.getComponent("animationUI");n?n.close((function(){o.parent=null,t&&"function"==typeof t&&t()})):(o.parent=null,t&&"function"==typeof t&&t())}else t&&"function"==typeof t&&t()}this._dictLoading[i]=!1},o.hideAll=function(){for(var i in this._dictSharedPanel){if(Object.prototype.hasOwnProperty.call(this._dictSharedPanel,i))this._dictSharedPanel[i].parent=null}},o.addHidePopup=function(i){this._hidePopupArr.includes(i)||this._hidePopupArr.push(i)},o.hideJoinPopup=function(i){if(this._hidePopupArr.length)for(var t=0,o=this._hidePopupArr.length;t<o;t++){var n=this._hidePopupArr[t];n!=i&&(this.hide(n),this._hidePopupArr.splice(t,1),t--,o--)}},o.pushToPopupSeq=function(i,t,o){var n={options:i,callBack:o,param:t,isShow:!1};this._arrPopupDialog.push(n),this._checkPopupSeq()},o.insertToPopupSeq=function(i,t,o,n){var e={options:t,callBack:n,param:o,isShow:!1};this._arrPopupDialog.splice(i,0,e)},o.shiftFromPopupSeq=function(i,t){var o=this;this._arrPopupDialog[0]&&this._arrPopupDialog[0].options.path===i?this.hide(i,(function(){o._arrPopupDialog.shift(),o._checkPopupSeq()})):this.hide(i,t)},o._checkPopupSeq=function(){if(this._arrPopupDialog.length>0){var i=this._arrPopupDialog[0];i.isShow||(this.show(i.options,i.param,i.callBack),this._arrPopupDialog[0].isShow=!0)}},o.showTips=function(i,t,o,n,e){var a=this;void 0===t&&(t="txt"),void 0===o&&(o=new s),void 0===n&&(n=1),void 0===e&&(e=function(){});var p=String(i),r=function(){a._showTipsAni(p,t,o,n,e)},h=Date.now();if(h-this._showTipsTime<800&&"gold"!==t&&"heart"!==t){var c=800-(h-this._showTipsTime);setTimeout((function(){r()}),c),this._showTipsTime=h+c}else r(),this._showTipsTime=h},o._showTipsAni=function(i,t,o,n,e){},t(i,null,[{key:"instance",get:function(){return this._instance||(this._instance=new i),this._instance}}]),i}())._instance=void 0,r=h))||r),i("PopupOptions",(function(){this.path=void 0,this.parent=void 0,this.closeCur=!1}));o._RF.pop()}}}));

System.register("chunks:///_virtual/ResourcesUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,r,o,i,a,u,f,s,l,c,d,m,p,v,g,R,h,F;return{setters:[function(e){n=e.inheritsLoose,t=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){o=e.cclegacy,i=e.isValid,a=e.Sprite,u=e.assetManager,f=e.Texture2D,s=e.SpriteFrame,l=e.resources,c=e.Prefab,d=e.Material,m=e.error,p=e.SpriteAtlas,v=e.sp,g=e.TiledMapAsset,R=e.Component,h=e.instantiate,F=e.find}],execute:function(){o._RF.push({},"85b9dh82G1BfaMK6OYv6K+u","ResourcesUtil",void 0);e("ResourcesUtil",function(e){function o(){for(var n,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(n=e.call.apply(e,[this].concat(r))||this).cache={},n}n(o,e),o.loadRes=function(e,n,t){void 0===t&&(t=function(){}),l.load(e,(function(e,n){e?t(e,n):t&&t(null,n)}))},o.loadEffectRes=function(e){var n=this;return new Promise((function(t,r){n.loadRes("prefab/effect/"+e,c,(function(n,o){if(n)return console.info("effect load failed",e),void(r&&r());t&&t(o)}))}))},o.loadModelRes=function(e){var n=this;return new Promise((function(t,r){n.loadRes(""+e,c,(function(n,o){if(n)return console.info("model load failed",e),void(r&&r());t&&t(o)}))}))},o.loadMatRes=function(e){var n=this;return new Promise((function(t,r){n.loadRes(""+e,d,(function(n,o){if(n)return console.info("mat load failed",e),void(r&&r());t&&t(o)}))}))},o.loadModelResArr=function(e,n,t,r){var o=n.map((function(n){return e+"/"+n}));l.load(o,c,t,r)},o.getMapObj=function(e,n,t,r){for(var o=[],i=0;i<n.length;i++)o.push("map/"+e+"/"+n[i]);l.load(o,c,t,r)},o.getJsonData=function(e,n){this.loadRes("datas/"+e,null,(function(e,t){e?m(e.message||e):t.json?n(e,t.json):n("failed!!!")}))},o.getTextData=function(e,n){this.loadRes("datas/"+e,null,(function(e,t){if(e)m(e.message||e);else{var r=t.text;n(e,r)}}))},o.loadFile=function(e,n){return new Promise((function(t,r){if(e){var o=l.get(e);o?t([e,o]):l.load(e,n,(function(n,r){null==n?t([e,r]):console.info("下载资源错误："+n)}))}else t([])}))},o.loadDir=function(e){return new Promise((function(n,t){e?l.loadDir(e,(function(e,t){null==e?n(t):console.info("下载资源错误："+e)})):n([])}))},o.loadRemote=function(e,n){return new Promise((function(n,t){if(!e)return n([]),void console.info("路径错误："+e);u.loadRemote(e,(function(e,t){null==e?n(t):console.info("下载资源错误："+e)}))}))},o.loadResNew=function(e,n){return new Promise((function(t,r){l.load(e,n,(function(e,n){if(e)return m(e.message||e),void(r&&r(e));t&&t(n)}))}))},o.getUIPrefabRes=function(e){return this.loadResNew(e,c)},o.createUI=function(){var e=t(r().mark((function e(n,t){var o,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getUIPrefabRes(n);case 2:return o=e.sent,(i=h(o)).setPosition(0,0,0),t||(t=F("Canvas")),t.addChild(i),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}(),o.setSpriteFrame=function(e,n,t,r){void 0===t&&(t=!0),void 0===r&&(r=null),n?(t&&(n.spriteFrame=null),l.load(e,s,(function(t,o){if(t)return console.info("set sprite frame failed! err:",e,t),void(r&&r());n&&n&&(n.spriteFrame=o),r&&r()}))):r&&r()},o.geSpriteFrame=function(e){return new Promise((function(n,t){l.load(e,s,(function(t,r){if(t)return console.info("set sprite frame failed! err:",e),void n(null);n(r)}))}))},o.setSpriteAtlasSpriteFrame=function(e,n,t){t&&l.load(e,p,(function(r,o){if(r)console.info("set spriteAtlas frame failed! err:",e,r);else{var i=o.getSpriteFrame(n);t.spriteFrame=i}}))},o.getSpriteAtlasSpriteFrame=function(e,n){return new Promise((function(t){l.load(e,p,(function(r,o){if(r)return console.info("get SpriteAtlasSprite failed! err:",e),void t(null);var i=o.getSpriteFrame(n);t(i)}))}))},o.getSpriteFrame=function(e){return new Promise((function(n){l.load(e,s,(function(e,t){n(t)}))}))},o.getSkeletonData=function(e){return new Promise((function(n){l.load(e,v.SkeletonData,(function(t,r){t?console.info("get SkeletonData failed! err:",e):n(r)}))}))},o.getPrefab=function(e){return new Promise((function(n,t){l.load(e,c,(function(r,o){r&&(console.info("get Prefab failed! err:",e),t(null)),n(o)}))}))},o.releaseRes=function(e){var n=e.spriteFrame;e.spriteFrame=null,n.decRef()},o.getTiledMap=function(e){return new Promise((function(n){l.load(e,g,(function(t,r){t?console.info("get Prefab failed! err:",e):n(r)}))}))};var R=o.prototype;return R.releaseSprite=function(e){if(i(e)){var n=e.getComponent(a);n&&n.spriteFrame&&(n.spriteFrame.decRef(),n.spriteFrame=null)}},R.loadRemoteImg=function(e){var n=this;u.loadRemote(e,(function(e,t){if(!e&&t){var r=n.cache[t._uuid];if(!r){var o=new f;o.image=t,(r=new s).texture=o,t.addRef(),n.cache[t._uuid]=r}r.addRef()}}))},R.releaseRemoteSprite=function(e){if(i(e)){var n=e.getComponent(a);if(n&&n.spriteFrame){var t=n.spriteFrame;if(n.spriteFrame.decRef(!1),n.spriteFrame=null,t.refCount<=0){var r,o,u=t.texture;if(t.packable)u=null==(r=t.original)?void 0:r._texture;if(u)delete this.cache[u.image._uuid],null==(o=u.image)||o.decRef(),u.destroy();t.destroy()}}}},o}(R));o._RF.pop()}}}));

System.register("chunks:///_virtual/Shadow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts","./PoolManager.ts","./GameDefine.ts"],(function(t){var o,e,n,s,a,i;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator},function(t){s=t.default},function(t){a=t.PoolManager},function(t){i=t.GameDefine}],execute:function(){var c;e._RF.push({},"12edahXWHVEuIb79B8twMAT","Shadow",void 0);var r=n.ccclass;n.property,t("Shadow",r("Shadow")(c=function(t){function e(){for(var o,e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return(o=t.call.apply(t,[this].concat(n))||this)._com=null,o}o(e,t);var n=e.prototype;return n.init=function(t){this._com=t;var o=t.monsterCfg.shadeScale;this.node.setScale(o,o,o)},n.setMonsterShadownPos=function(){var t=this._com.node.getPosition();this.node.setPosition(t.x,t.y+this._com.monsterCfg.shadeOffsetY,0)},n.clear=function(){a.instance.putNode(this.node)},n.childUpdate=function(t){i.gameStart&&this._com&&this.setMonsterShadownPos()},e}(s))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/SkillBulletBase.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./BaseComponent.ts","./EventListener.ts","./GameEvent.ts","./Util.ts","./SkillData.ts","./GameDefine.ts"],(function(t){var e,i,l,n,s,a,o,r,u,c,h,d,g,p,m,f,y,v,k,B,S,_,T;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,l=t.initializerDefineProperty,n=t.assertThisInitialized,s=t.createClass},function(t){a=t.cclegacy,o=t._decorator,r=t.Node,u=t.Vec3,c=t.v2,h=t.v3,d=t.tween,g=t.Vec2,p=t.misc,m=t.Rect,f=t.bezier},function(t){y=t.PoolManager},function(t){v=t.default},function(t){k=t.EventListener},function(t){B=t.GameEvent},function(t){S=t.Util},function(t){_=t.AtkObj},function(t){T=t.GameDefine}],execute:function(){var b,x,C,w,E;a._RF.push({},"8f7c12DY8NE1LdJCAb4kT1q","SkillBulletBase",void 0);var P=o.ccclass,D=o.property;t("SkillBulletBase",(b=P("SkillBulletBase"),x=D(r),b((E=e((w=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return e=t.call.apply(t,[this].concat(s))||this,l(e,"icon",E,n(e)),e.skillBulletObj=null,e.initStatus=!1,e.bulletId=101,e.during=10,e.damageR=30,e.damageInterval=void 0,e.damageTimes=void 0,e.isCollider=void 0,e.LoopCount=0,e.moveSpeed=1500,e.initSpeed=1500,e.isEasing=!1,e.scale=1,e._dir=new u,e.curPos=new u,e.targetPos=new u,e.quadBoundBox=null,e.boundBox=null,e._skillBulletKey="",e.type=0,e._minY=5,e._maxY=300,e._minX=0,e._maxX=0,e._playTime=1,e}i(e,t);var a=e.prototype;return a.initSkillBullet=function(t,e){void 0===e&&(e=0),this.type=this.skillBulletObj.skillCfg.Type;var i=this.node.getPosition(),l=new u;this.targetPos=t.clone(),u.subtract(l,t,i);var n=S.vector_to_angle(c(l.x,l.y)),s=S.angle_to_vector(n+e);l.set(s.x,s.y),this._dir=l.normalize(),this.isEasing=!1,this.curPos=this.node.getPosition(),this.scale=1,this.setSkillSize(),this.during=10,this.moveSpeed=this.getSkillMoveSpeedByType(),this.initSpeed=this.moveSpeed,this.damageTimes=1,this.damageInterval=0,this.isCollider=!0,this.LoopCount=0,this._skillBulletKey="skillBullet"+this.bulletId+Math.random().toString().substring(2,6)+Math.random().toString().substring(2,12),this.setSkillBulletAnim(),this.initStatus=!0},a.setSkillSize=function(){this.node.setScale(h(this.scale,this.scale,this.scale))},a.setSkillBulletAnim=function(){},a.easingSpeed=function(t,e){var i=this;if(this.isEasing){var l=new function(){this.t=void 0};l.t=0,d(l).to(t,{t:1},{onUpdate:function(t,e){var l=c(0,0),n=c(0,.4),s=c(.2,1),a=c(1,1),o=(l.x,n.x,s.x,a.x,l.y*(1-e)*(1-e)*(1-e)+3*n.y*e*(1-e)*(1-e)+3*s.y*e*e*(1-e)+a.y*e*e*e);i.moveSpeed=i.initSpeed+500*o}}).start()}},a.setBulletMove=function(t){if(this.skillBulletObj.skillCfg.Speed>0){var e=this.node.getPosition(),i=h(this._dir.x,this._dir.y,0).multiply(h(this.moveSpeed*t,this.moveSpeed*t,0)),l=e.add(i);this.node.setPosition(l),this.curPos=l,this.setBulletAngle(this.skillBulletObj.skillCfg.Type)}},a.setBulletAngle=function(t){switch(t){case 1:var e=new g(this._dir.x,this._dir.y).signAngle(new g(0,1)),i=p.radiansToDegrees(e);this.node.angle=-i;break;case 2:this.node.angle=this.node.angle-20}},a.playBulletTween=function(t){var e=this;this.node.eulerAngles=new u(0,0,0);var i=this.node,l=i.position,n=i.eulerAngles,s=d(l);this._minY=l.y+(t.y-l.y)/2+100,this._maxY=l.y+(t.y-l.y)/2+100,this._maxX=l.x+(t.x-l.x)/2+100,this._minX=l.x+(t.x-l.x)/2+100;var a=this._minY,o=this._maxY,r=this._minX,c=this._maxX;s.parallel(d().to(this._playTime,{x:t.x},{progress:function(t,e,i,l){return f(t,r,c,e,l)},easing:"smooth",onUpdate:function(){i.setPosition(l),e.curPos=l}}),d().to(this._playTime,{y:t.y},{progress:function(t,e,i,l){return f(t,a,o,e,l)},easing:"smooth",onUpdate:function(){i.setPosition(l),e.curPos=l}})).call((function(){})).start(),d(n).to(this._playTime,{z:-1440},{onUpdate:function(){i.eulerAngles=n}}).start()},a.updateSkillBulletScreen=function(t){var e=new m(-T.viewWidth/2,-T.viewHeight/2,T.viewWidth,T.viewHeight),i=this.curPos;e.contains(c(i.x,i.y))?this.duringTriggleClearByType(t):this.clear()},a.updateSkillDamageInterval=function(t){this.skillBulletObj.skillCfg.Damage_interval&&(this.damageInterval-=t,this.isCollider=!1,this.damageInterval<=0&&(this.isCollider=!0,this.damageInterval=this.skillBulletObj.skillCfg.Damage_interval))},a.insertRectCircleObj=function(){if(this.initStatus)switch(this.type){case 10:break;default:k.emit(B.INSERT_QUARD_TREE_RECT_CIRCLE,this._skillBulletKey,this,this.quadBoundBox,1)}},a.onAttacked=function(){},a.triggleSkillBySkillId=function(){},a.colliderTriggleSkill=function(t,e){},a.checkColliderCount=function(t,e){1==t&&e.node.parent,this.damageTimes?(this.colliderTriggleSkill(t,this.damageTimes),t>=this.damageTimes&&this.damageTimeClearByType()):this.colliderTriggleClearByType(t,this.damageTimes)},a.colliderTriggleClearByType=function(t,e){},a.duringTriggleClearByType=function(t){this.during-=t,this.during<=0&&this.clear()},a.damageTimeClearByType=function(){this.clear()},a.getSkillMoveSpeedByType=function(){var t=0;switch(this.type){case 99:t=0;break;default:t=this.skillBulletObj.skillCfg.Speed}return t},a.onEnable=function(){},a.onDisable=function(){},a.clear=function(){this.initStatus=!1,this.boundBox=null,this.quadBoundBox=null,this.skillBulletObj.callback&&this.skillBulletObj.callback(),k.emit(B.DELETE_QUARD_TREE_OBJ,this._skillBulletKey),y.instance.putNode(this.node)},a.childUpdate=function(t){},s(e,[{key:"atkObj",get:function(){var t=new _;return t.atk=Math.floor(S.getRandomInt(5,15)),t}}]),e}(v)).prototype,"icon",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=w))||C));a._RF.pop()}}}));

System.register("chunks:///_virtual/SkillBulletItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SkillBulletBase.ts","./GameDefine.ts","./MonsterBase.ts"],(function(t){var e,i,l,n,o,s,u,a,r;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,l=t._decorator,n=t.Collider2D,o=t.Contact2DType,s=t.director},function(t){u=t.SkillBulletBase},function(t){a=t.GameDefine},function(t){r=t.MonsterBase}],execute:function(){var c;i._RF.push({},"a6484nUmyVJOrVFOypCdAIm","SkillBulletItem",void 0);var B=l.ccclass;l.property,t("SkillBulletItem",B("SkillBulletItem")(c=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var l=i.prototype;return l.init=function(t,e,i){this.initStatus=!1,this.skillBulletObj=t,this.initSkillBullet(e,i)},l.start=function(){var t=this.getComponent(n);t&&t.on(o.BEGIN_CONTACT,this.onBeginContact,this)},l.onBeginContact=function(t,e,i){e.node.getComponent(r).onAttacked(this.skillBulletObj.skillCfg.Damage),this.clear()},l.childUpdate=function(t){if(a.gameStart&&this.initStatus){s.getTotalFrames();this.updateSkillBulletScreen(t),this.setBulletMove(t)}},i}(u))||c);i._RF.pop()}}}));

System.register("chunks:///_virtual/SkillData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CfgMgr.ts","./Util.ts","./SkillModel.ts","./SkillTargetModel.ts","./MonsterData.ts"],(function(t){var e,a,n,r,i,l,s,o;return{setters:[function(t){e=t.createClass},function(t){a=t.cclegacy,n=t.Vec3},function(t){r=t.CfgMgr},function(t){i=t.Util},function(t){l=t.SkillCfg},function(t){s=t.SkillTargetCfg},function(t){o=t.MonsterData}],execute:function(){a._RF.push({},"d47c0P8lLFPJqDru2of1KHi","SkillData",void 0),t("SkillData",function(){function t(){this._battleSkillUpgradeData=new Map}var a=t.prototype;return a.getSkillCfgById=function(t){return r.getDataById(new l,t)},a.upgradeSkillObjAtt=function(t){var e=t.aim_skill;if(e)for(var a=0;a<e.length;a++){var n=e[a],r=this._battleSkillUpgradeData.has(n)?this._battleSkillUpgradeData.get(n):new g;r.skillId=n,r.Hp+=t.hp_up,r.Exp+=t.exp_up,r.Gold+=t.gold_up,r.CdPer+=t.cd_shorten,r.DamageRange+=t.damageRange_up,r.DamageNum+=t.damageNum_up,r.Damage+=t.damage_up,r.Range+=t.range_up,r.Speed+=t.speed_up,r.Salvo+=t.salvo_up,r.BulletCount+=t.intensity_up,this._battleSkillUpgradeData.has(n)||this._battleSkillUpgradeData.set(n,r)}},a.getUpgradeSkillBySkillId=function(t){var e=i.clone(t);if(this._battleSkillUpgradeData.has(e.Id)){var a=this._battleSkillUpgradeData.get(e.Id);for(var n in a)if(Object.prototype.hasOwnProperty.call(a,n)){var r=a[n];e.hasOwnProperty(n)&&(e[n]+=r)}}return e},a.getSkillTargetId=function(t,e){return t.length?e<t.length?t[e]:t[t.length-1]:0},a.getSkillBulletCount=function(t){if(t){var e=r.getDataById(new s,t);if(e.random){var a=e.random.split(":");return Number(a[1])}return 1}return 1},a.getSkillDirAngle=function(t,e){var a=0;return t&&(a=t%2==0?t/2*e:-Math.ceil(t/2)*e),a},a.getSkillAtkTargetPos=function(t,e,a){var n=[];if(t){var i=r.getDataById(new s,t),l=i.type,o=i.random.split(":"),g=Number(o[0]),h=Number(o[1]);if(l.length)switch(l[0]){case 1:case 2:n=this.getHeroNearTargetPos(!0,g,h,a,e);break;case 3:case 4:n=this.getMonsterHpTargetPos(!0,g,h,a,e);break;case 7:n=this.getScreenTargetPos(g,h,a);break;case 8:case 9:n=this.getSelfTargetPos(!0,g,h,a,e);break;default:n=this.getScreenTargetPos(g,h,a)}n=n.length?n:this.getRandPos(e,h)}else n=[e];return n},a.getHeroNearTargetPos=function(t,e,a,n,r){var i=[],l=o.instance.getNearMonsterTarget(n),s=[],g=[];if(l.size&&(l.forEach((function(t){var e=t.getColliderPos().x;s.push({monsterBase:t,distance:e})})),s.sort((function(e,a){return t?e.distance-a.distance:a.distance-e.distance})),e=e>=s.length?s.length:e,(g=s.slice(0,e)).length))for(var h=0;h<a;h++){var u=g[h<g.length?Math.floor(Math.random()*g.length):0];i.push(u.monsterBase.getColliderPos())}return i},a.getMonsterHpTargetPos=function(t,e,a,n,r){var i=[],l=o.instance.getNearMonsterTarget(n),s=[],g=[];if(l.size&&(l.forEach((function(t){var e=t.curHp;s.push({monsterBase:t,hp:e})})),s.sort((function(e,a){return t?a.hp-e.hp:e.hp-a.hp})),e=e>=s.length?s.length:e,(g=s.slice(0,e)).length))for(var h=0;h<a;h++){var u=g[h<g.length?Math.floor(Math.random()*g.length):0];i.push(u.monsterBase.getColliderPos())}return i},a.getScreenTargetPos=function(t,e,a){var n=[],r=o.instance.getNearMonsterTarget(a);if(r.size)for(var i=Array.from(r.values()),l=0;l<e;l++){var s=Math.floor(Math.random()*i.length);n.push(i[s].getColliderPos())}return n},a.getSelfTargetPos=function(t,e,a,r,i){var l=[],s=o.instance.getNearMonsterTarget(r),g=[],h=[];if(s.size&&(s.forEach((function(t){var e=n.distance(t.getColliderPos(),i);e>50&&g.push({monsterBase:t,distance:e})})),g.sort((function(e,a){return t?e.distance-a.distance:a.distance-e.distance})),e=e>=g.length?g.length:e,(h=g.slice(0,e)).length))for(var u=0;u<a;u++){var c=h[u<h.length?Math.floor(Math.random()*h.length):0];l.push(c.monsterBase.getColliderPos())}return l},a.getRandPos=function(t,e){for(var a=[],r=0;r<e;r++){var i=new n;i.x=0,i.y=2*(Math.random()-.5)*200,a.push(i)}return a},a.checkColliderTriggleSkill=function(t,e,a){var n=!1;switch(t){case 1:n=1==e;break;case 2:n=e==a;break;case 3:n=!0;break;default:n=!1}return n},a.clear=function(){this._battleSkillUpgradeData.clear()},e(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=null;t("SkillBulletObj",(function(){this.skillKey=void 0,this.skillCfg=void 0,this.layer=1,this.pos=void 0,this.callback=void 0,this.targetPos=void 0,this.param=void 0,this.scale=1})),t("ReleaseSkillObj",(function(){this.skillKey=void 0,this.skillCfg=void 0,this.animTime=.2,this.releaseTimes=1,this.bulletCount=1,this.callback=void 0})),t("AtkObj",(function(){this.atk=0,this.type=0}));var g=t("SkillUpgradeObj",(function(){this.skillId=0,this.Hp=0,this.Exp=0,this.Gold=0,this.CdPer=0,this.DamageRange=0,this.DamageNum=0,this.Damage=0,this.Range=0,this.Speed=0,this.Salvo=0,this.BulletCount=0}));a._RF.pop()}}}));

System.register("chunks:///_virtual/SkillManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameEvent.ts","./EventListener.ts","./SkillData.ts","./ResourcesUtil.ts","./PoolManager.ts","./Constants.ts","./SkillUpgradeData.ts"],(function(t){var e,n,i,a,l,o,r,s,c,f,u,p,g,k,d,h,S;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){l=t.cclegacy,o=t._decorator,r=t.Node,s=t.instantiate,c=t.Sprite,f=t.Component},function(t){u=t.GameEvent},function(t){p=t.EventListener},function(t){g=t.SkillData},function(t){k=t.ResourcesUtil},function(t){d=t.PoolManager},function(t){h=t.Constants},function(t){S=t.SkillUpgradeData}],execute:function(){var C,m,v,P,E;l._RF.push({},"bfbb4uHJ+JKjq7N/Z8t/KLe","SkillManager",void 0);var b=o.ccclass,M=o.property;t("SkillManager",(C=b("SkillManager"),m=M(r),C((E=e((P=function(t){function e(){for(var e,n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return e=t.call.apply(t,[this].concat(l))||this,i(e,"skillParentUp",E,a(e)),e._skillPrefabItemMap=new Map,e}n(e,t);var l=e.prototype;return l.init=function(){S.instance.init()},l.onEnable=function(){p.on(u.CREATE_SKILL_EFFECT,this.onCreateSkillEffect,this)},l.onDisable=function(){p.off(u.CREATE_SKILL_EFFECT,this.onCreateSkillEffect,this)},l.onCreateSkillEffect=function(t,e,n,i){var a=this;void 0===i&&(i=0),this.scheduleOnce((function(){var i=null,l=t.skillCfg.Id;if(a._skillPrefabItemMap.has(l))i=d.instance.getNodeItemById(a._skillPrefabItemMap.get(l),l.toString()),a.skillParentUp.addChild(i),i.setPosition(t.pos),i.components[1].init(t,e,n);else{var o=h.battSkillPath;k.getPrefab(o).then((function(o){var r=h.weaponIconPath+t.skillCfg.Bullet+"/spriteFrame";k.getSpriteFrame(r).then((function(r){var f=(i=s(o)).getChildByName("icon").getComponent(c);f.spriteFrame=r,f.node.angle=t.skillCfg.Angle,f.node.setScale(t.skillCfg.Scale,t.skillCfg.Scale),a.skillParentUp.addChild(i),i.setPosition(t.pos),i.components[1].init(t,e,n),a._skillPrefabItemMap.set(l,i)}))}))}}),i)},l.clear=function(){g.instance.clear(),S.instance.clear()},e}(f)).prototype,"skillParentUp",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=P))||v));l._RF.pop()}}}));

System.register("chunks:///_virtual/SkillModel.ts",["cc"],(function(i){var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"e96c1LMiTlDMYmCWtHlD/ym","SkillModel",void 0);i("SkillCfg",(function(){this.ClassName="Skill",this.Id=void 0,this.Name=void 0,this.Quality=void 0,this.Res=void 0,this.Bullet=void 0,this.Type=void 0,this.Scale=void 0,this.Angle=void 0,this.Speed=void 0,this.Range=void 0,this.Cd=void 0,this.Damage=void 0,this.DamageRange=void 0,this.DamageNum=void 0,this.Damage_interval=void 0,this.Salvo=void 0,this.BulletCount=void 0,this.IntervalAngle=void 0}));t._RF.pop()}}}));

System.register("chunks:///_virtual/SkillSelectItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./ResourcesUtil.ts","./SpriteEx.ts","./SkillData.ts","./SkillUpgradeData.ts"],(function(t){var e,i,l,n,r,a,c,s,o,u,p,f,g,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,l=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,c=t.Sprite,s=t.RichText,o=t.Component},function(t){u=t.Constants},function(t){p=t.ResourcesUtil},function(t){f=t.SpriteEx},function(t){g=t.SkillData},function(t){h=t.SkillUpgradeData}],execute:function(){var d,k,S,y,m,b,_,U,v,C,z;r._RF.push({},"d2164JsWmlHK60Q7+zA/GgW","SkillSelectItem",void 0);var B=a.ccclass,D=a.property;t("SkillSelectItem",(d=B("SkillSelectItem"),k=D(f),S=D(f),y=D(c),m=D(s),d((U=e((_=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,l(e,"frame",U,n(e)),l(e,"quality",v,n(e)),l(e,"icon",C,n(e)),l(e,"desc",z,n(e)),e._callBack=null,e._skillUpgradeCfg=null,e._selectObj=null,e}i(e,t);var r=e.prototype;return r.init=function(t,e){var i=this,l=h.instance.getSkillUpgradeCfgById(t.id);this._selectObj=t,this._callBack=e,this._skillUpgradeCfg=l,this.frame.index=l.quality,this.quality.index=l.quality,this.desc.string=l.desc;var n=u.skillSelectIconPath+l.icon+"/spriteFrame";p.geSpriteFrame(n).then((function(t){i.icon.spriteFrame=t}))},r.setUpgradeSkill=function(){switch(this._skillUpgradeCfg.type){case 0:g.instance.upgradeSkillObjAtt(this._skillUpgradeCfg)}},r.onTouchBtn=function(){this._callBack&&this._callBack(),this._selectObj.options_num--,this.setUpgradeSkill()},e}(o)).prototype,"frame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=e(_.prototype,"quality",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=e(_.prototype,"icon",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(_.prototype,"desc",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=_))||b));r._RF.pop()}}}));

System.register("chunks:///_virtual/SkillSelectPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./GameController.ts","./PopupManager.ts","./SkillUpgradeData.ts","./SkillSelectItem.ts"],(function(e){var t,n,i,r,o,l,c,a,s,u,p,f,S,h,k,g,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,l=e.regeneratorRuntime},function(e){c=e.cclegacy,a=e._decorator,s=e.Node,u=e.Component,p=e.tween,f=e.v3},function(e){S=e.Constants},function(e){h=e.default},function(e){k=e.PopupManager},function(e){g=e.SkillUpgradeData},function(e){v=e.SkillSelectItem}],execute:function(){var d,b,m,y,P,w,C;c._RF.push({},"6da23yMgY1B+pjD6+TmVFFj","SkillSelectPopup",void 0);var I=a.ccclass,x=a.property;e("SkillSelectPopup",(d=I("SkillSelectPopup"),b=x(s),m=x(s),d((w=t((P=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return t=e.call.apply(e,[this].concat(o))||this,i(t,"content",w,r(t)),i(t,"block",C,r(t)),t}n(t,e);var c=t.prototype;return c.show=function(e){this.setSkillSelectInfo(e)},c.setSkillSelectInfo=function(){var e=o(l().mark((function e(t){var n,i,r,o,c=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.content.children,this.block.active=!0,i=0;i<n.length;i++)n[i].active=!1;r=l().mark((function e(i){var r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[i],(o=n[i]).getComponent(v).init(r,c.onCloseBtn.bind(c)),e.next=5,new Promise((function(e){o.setScale(.5,.5),o.active=!0,p(o).to(.05,{scale:f(1.1,1.1,1.1)}).to(.05,{scale:f(1,1,1)}).call((function(){2==i&&(c.block.active=!1),e(0)})).start()}));case 5:case"end":return e.stop()}}),e)})),o=0;case 5:if(!(o<t.length)){e.next=10;break}return e.delegateYield(r(o),"t0",7);case 7:o++,e.next=5;break;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),c.onCloseBtn=function(){h.resume(),k.instance.hide(S.PopupUI.SkillSelectPopup)},c.onChangeBtn=function(){var e=g.instance.getSelectSkillListByWeight();this.setSkillSelectInfo(e)},t}(u)).prototype,"content",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(P.prototype,"block",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=P))||y));c._RF.pop()}}}));

System.register("chunks:///_virtual/SkillTargetModel.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"44ac058KoRK5JPZE8lOhCeF","SkillTargetModel",void 0);t("SkillTargetCfg",(function(){this.ClassName="SkillTarget",this.Id=void 0,this.type=void 0,this.stress=void 0,this.random=void 0,this.targetCamp=void 0,this.targetHp=void 0,this.targetStatus=void 0,this.condition=void 0,this.notargetStatus=void 0}));i._RF.pop()}}}));

System.register("chunks:///_virtual/SkillTypeItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts","./SkillData.ts","./MonsterData.ts","./HeroData.ts","./GameDefine.ts","./Constants.ts","./ResourcesUtil.ts"],(function(e){var t,i,n,l,s,a,r,o,c,u,f,h,k,p,g,d,_;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,l=e.assertThisInitialized,s=e.createClass},function(e){a=e.cclegacy,r=e._decorator,o=e.Sprite,c=e.UITransform},function(e){u=e.default},function(e){f=e.SkillData,h=e.ReleaseSkillObj},function(e){k=e.MonsterData},function(e){p=e.HeroData},function(e){g=e.GameDefine},function(e){d=e.Constants},function(e){_=e.ResourcesUtil}],execute:function(){var y,C,S,m,I,R,v;a._RF.push({},"f6d1449qq9HZJX0i4z/zLFB","SkillTypeItem",void 0);var b=r.ccclass,D=r.property;e("SkillTypeItem",(y=b("SkillTypeItem"),C=D(o),S=D(o),y((R=t((I=function(e){function t(){for(var t,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return t=e.call.apply(e,[this].concat(s))||this,n(t,"quality",R,l(t)),n(t,"skilIcon",v,l(t)),t._skillCfg=null,t._cd=0,t._initRelease=!0,t._weaponKey="",t}i(t,e);var a=t.prototype;return a.init=function(e,t){this._weaponKey=e,this._skillCfg=f.instance.getSkillCfgById(t.SkillId),this._cd=this._skillCfg.Cd,this.setSkillTypeInfo(this._skillCfg)},a.setSkillTypeInfo=function(e){var t=this,i=d.weaponIconPath+e.Res+"/spriteFrame",n=d.qualityPath+e.Quality+"/spriteFrame";_.geSpriteFrame(n).then((function(e){t.quality.spriteFrame=e})),_.geSpriteFrame(i).then((function(e){t.skilIcon.spriteFrame=e;var i=t.skilIcon.getComponent(c).contentSize,n=Math.min(80/i.width,80/i.height);t.skilIcon.node.setScale(n,n),t._initRelease=!0}))},a.initSkillCd=function(){this._cd=this._skillCfg.Cd,this._initRelease=!0},a.setSkillProgressBar=function(e){var t=e/this._skillCfg.Cd;this.node.getChildByName("bar").getComponent(o).fillRange=t},a.createQueueSkill=function(){var e=new h;e.skillCfg=this._skillCfg,e.callback=this.initSkillCd.bind(this),e.skillKey=this._weaponKey,p.instance.addQueueSkill(e)},a.childUpdate=function(e){if(g.gameStart){var t=p.instance.heroPoint;this._initRelease&&(this._cd-=e,this.setSkillProgressBar(this._cd),this._cd<0&&(k.instance.checkSkillNearMonster(t,this._skillCfg.Range)?(this._initRelease=!1,this.createQueueSkill()):this._cd=this._skillCfg.Cd),k.instance.setNearMonster(this._weaponKey,t,this._skillCfg.Range))}},s(t,[{key:"range",get:function(){return this._skillCfg.Range}}]),t}(u)).prototype,"quality",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(I.prototype,"skilIcon",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=I))||m));a._RF.pop()}}}));

System.register("chunks:///_virtual/SkillUpgradeData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CfgMgr.ts","./BattleLevelModel.ts","./SkillUpgradeMode.ts"],(function(t){var e,n,a,i,r;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy},function(t){a=t.CfgMgr},function(t){i=t.BattleLevelCfg},function(t){r=t.SkillUpgradeCfg}],execute:function(){n._RF.push({},"0197azBjyNEkIhWWJCAKOOQ","SkillUpgradeData",void 0),t("SkillUpgradeData",function(){function t(){this._BattleLevelData=new Map,this._unlockUpgradeOptionsPoolData=new Map}var n=t.prototype;return n.init=function(){for(var t=a.getCfgDataArray(new i),e=0;e<t.length;e++){var n=t[e];this._BattleLevelData.set(n.Level,n)}for(var l=a.getCfgDataArray(new r),s=0;s<l.length;s++){var u=l[s];if(u.options_num){var c=new o;c.id=u.Id,c.premise=u.premise,c.options_num=u.options_num,this._unlockUpgradeOptionsPoolData.set(u.Id,c)}}},n.getSkillUpgradeCfgById=function(t){return a.getDataById(new r,t)},n.getBattleLevelByLevel=function(t){var e=100;return this._BattleLevelData.has(t)&&(e=this._BattleLevelData.get(t).Exp),e},n.getUnlockUpgradeOptionsData=function(){return Array.from(this._unlockUpgradeOptionsPoolData.values())},n.getSelectObjByWeight=function(t,e){for(var n=0,a=0,i=0,r=0,o=[],l=0;l<t.length;l++){var s=t[l];if(s.options_num){for(var u=!1,c=0;c<e.length;c++){var g=e[c];if(s.id==g.id){u=!0;break}}if(!u){var f=t[l];r+=f.options_num,o.push(f)}}}if(o.length){var p=Math.random()*r;return o.some((function(t,e){if(a=n+t.options_num,p>=n&&p<a)return i=e,!0;n=a})),o[i]}return null},n.getSelectSkillListByWeight=function(){for(var t=[],e=0;e<3;e++){var n=this.getSelectObjByWeight(this.getUnlockUpgradeOptionsData(),t);n&&t.push(n)}return t},n.clear=function(){this._BattleLevelData.clear()},e(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=null;var o=t("SelectObj",(function(){this.id=void 0,this.premise=void 0,this.options_num=void 0}));n._RF.pop()}}}));

System.register("chunks:///_virtual/SkillUpgradeMode.ts",["cc"],(function(i){var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"75927nW+7xGjJxEldfRVtSD","SkillUpgradeMode",void 0);i("SkillUpgradeCfg",(function(){this.ClassName="SkillUpgrade",this.Id=void 0,this.name=void 0,this.desc=void 0,this.icon=void 0,this.type=void 0,this.premise=void 0,this.aim_skill=void 0,this.options_num=void 0,this.quality=void 0,this.hp_up=void 0,this.exp_up=void 0,this.gold_up=void 0,this.cd_shorten=void 0,this.damageRange_up=void 0,this.damageNum_up=void 0,this.damage_up=void 0,this.range_up=void 0,this.speed_up=void 0,this.salvo_up=void 0,this.intensity_up=void 0,this.unlock=void 0}));t._RF.pop()}}}));

System.register("chunks:///_virtual/SoundModel.ts",["cc"],(function(i){var o;return{setters:[function(i){o=i.cclegacy}],execute:function(){o._RF.push({},"da0b587TatEfYOmhgmfwcge","SoundModel",void 0);i("SoundCfg",(function(){this.ClassName="Sound",this.Id=void 0,this.Name=void 0,this.Desc=void 0,this.Group=void 0,this.Type=void 0,this.Volume=void 0,this.Delay=void 0,this.Mp3=void 0}));o._RF.pop()}}}));

System.register("chunks:///_virtual/SpriteEx.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,i,n,o,p,s,a,c,u,l;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized,o=e.createClass},function(e){p=e.cclegacy,s=e._decorator,a=e.Sprite,c=e.SpriteFrame,u=e.CCInteger,l=e.Component}],execute:function(){var d,x,y,f,h,m,g,F;p._RF.push({},"a7351A5vfBG26Vq3Fx4Zzzr","SpriteEx",void 0);var _=s.ccclass,b=s.property,v=s.executeInEditMode,S=s.requireComponent,z=s.menu;e("SpriteEx",(d=S(a),x=z("UI/SpriteEx Index(帧图改变)"),y=b({type:[c],tooltip:"sprite将会用到帧图片"}),f=b({type:u,tooltip:"当前显示的帧图"}),_(h=v(h=d(h=x((g=t((m=function(e){function t(){for(var t,r=arguments.length,o=new Array(r),p=0;p<r;p++)o[p]=arguments[p];return t=e.call.apply(e,[this].concat(o))||this,i(t,"spriteFrames",g,n(t)),i(t,"_index",F,n(t)),t}return r(t,e),o(t,[{key:"index",get:function(){return this._index},set:function(e){e<0||(this._index=e%this.spriteFrames.length,this.node.getComponent(a).spriteFrame=this.spriteFrames[this._index])}}]),t}(l)).prototype,"spriteFrames",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[null]}}),t(m.prototype,"index",[f],Object.getOwnPropertyDescriptor(m.prototype,"index"),m.prototype),F=t(m.prototype,"_index",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),h=m))||h)||h)||h)||h));p._RF.pop()}}}));

System.register("chunks:///_virtual/SynItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o,r,i;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,r=t.dragonBones,i=t.Component}],execute:function(){var s;e._RF.push({},"6f664azpR1P674rPvf42GZp","SynItem",void 0);var c=o.ccclass;o.property,t("SynItem",c("SynItem")(s=function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){var t=this,n=this.node.getComponent(r.ArmatureDisplay);n.addEventListener(r.EventObject.COMPLETE,(function(){t.node.destroy()}),n)},e}(i))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/SysOpenData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e;return{setters:[function(n){t=n.createClass},function(n){e=n.cclegacy}],execute:function(){e._RF.push({},"63bbcBqI+ZE/66F0uXhki5z","SysOpenData",void 0),n("SysOpenData",function(){function n(){this._sysOpenId=[2]}return n.prototype.checkSysOpen=function(n){return!!this._sysOpenId.includes(n)},t(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}())._instance=null,e._RF.pop()}}}));

System.register("chunks:///_virtual/SystemConstantModel.ts",["cc"],(function(t){var s;return{setters:[function(t){s=t.cclegacy}],execute:function(){s._RF.push({},"4905eDmeYhEfpQXfWDy9VDm","SystemConstantModel",void 0);t("SystemConstantCfg",(function(){this.ClassName="SystemConstant",this.Id=void 0,this.ConstantName=void 0,this.ConstantValue=void 0,this.ConstantValue2=void 0,this.Explain=void 0}));s._RF.pop()}}}));

System.register("chunks:///_virtual/TipsPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./EventListener.ts","./PopupManager.ts","./GameEvent.ts"],(function(t){var n,e,i,o,s,r,p,c,u,a,l,f;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,r=t._decorator,p=t.Label,c=t.Component},function(t){u=t.Constants},function(t){a=t.EventListener},function(t){l=t.PopupManager},function(t){f=t.GameEvent}],execute:function(){var h,v,y,d,P;s._RF.push({},"177d1C/dg5OWZknvJEioKJs","TipsPopup",void 0);var g=r.ccclass,E=r.property;t("TipsPopup",(h=g("TipsPopup"),v=E(p),h((P=n((d=function(t){function n(){for(var n,e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return n=t.call.apply(t,[this].concat(s))||this,i(n,"desc",P,o(n)),n._skipType=1,n}e(n,t);var s=n.prototype;return s.show=function(t,n){this._skipType=n,this.desc.string=t},s.onEscBtn=function(){l.instance.hide(u.PopupUI.tipsPopup)},s.onEnterBtn=function(){switch(this._skipType){case 1:a.emit(f.GAME_OVER)}},n}(c)).prototype,"desc",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=d))||y));s._RF.pop()}}}));

System.register("chunks:///_virtual/Toast.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,s,a,c,l,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Label,c=t.tween,l=t.v3,u=t.Component}],execute:function(){var p,f,d,h,y;r._RF.push({},"ddfe1rgxVxEoZW8/Ku88Xn7","Toast",void 0);var b=s.ccclass,g=s.property;t("Toast",(p=b("Toast"),f=g(a),p((y=e((h=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"lbText",y,o(e)),e}n(e,t);var r=e.prototype;return r.init=function(t){this.lbText.string=t,this.node.setScale(.5,.5),this.setAnim()},r.setAnim=function(){var t=this;c(this.node).to(.2,{scale:l(1.1,1.1,1.1)},{easing:"sineIn"}).to(.2,{scale:l(1,1,1)},{easing:"sineOut"}).delay(.2).by(.5,{position:l(0,100,0)}).call((function(){t.node.destroy()})).start()},e}(u)).prototype,"lbText",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=h))||d));r._RF.pop()}}}));

System.register("chunks:///_virtual/Util.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var r,e,n,o,a,i,u,f,h,c,g,l,s,M,d;return{setters:[function(t){r=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Vec3,o=t.Quat,a=t.Vec2,i=t.v2,u=t.Color,f=t.Rect,h=t.screen,c=t.v3,g=t.tween,l=t.misc,s=t.view,M=t.Component,d=t.bezier}],execute:function(){e._RF.push({},"2e632+VYKdG5qMiRPU5yd+n","Util",void 0);t("Util",function(t){function e(){return t.apply(this,arguments)||this}return r(e,t),e.isEmptyObject=function(t){var r=!0;if(t&&t.constructor===Object){for(var e in t)if(t.hasOwnProperty(e)){r=!1;break}}else r=!1;return r},e.getStringLength=function(t){for(var r=t,e=0,n=0,o=r.length;n<o;n++){e+=r.charCodeAt(n)<=255?1:2}return Math.ceil(e/2)},e.getRandomNFromM=function(t,r){for(var e=[],n=0,o=0;o<r&&!(o>=t+1);){n=this.getRandomInt(0,t);for(var a=0,i=0;i<o;i++)if(e[i]===n){a=1;break}0===a&&(e[o]=n,o++)}return e},e.getRandomInt=function(t,r){var e=Math.random()*(r-t+1)+t;return Math.floor(e)},e.arrayToObject=function(t,r){var e={};for(var n in t)t.hasOwnProperty(n)&&t[n][r]&&(e[t[n][r]]=t[n])},e.clone=function(t){if(null===t||"object"!=typeof t)return t;var r={};for(var e in t.constructor===Array&&(r=[]),t)t.hasOwnProperty(e)&&(r[e]=this.clone(t[e]));return r},e.objectToArray=function(t){var r=[];for(var e in t)t.hasOwnProperty(e)&&r.push(t[e]);return r},e.formatMoney=function(t){for(var r=["","K","M","G","T","P","E","Z","Y","B","N","D"],e="",n=0;n<r.length;n++){if(!(t>=1e4)){e=Math.floor(t)+r[n];break}t/=1e3}return""===e&&(e=Math.floor(t)+"U"),e},e.newFormatMoney=function(t){if(t<1e4)return t.toString();for(var r=["","K","M","G","T","P","E","Z","Y","B","N","D"],e="",n=0;n<r.length;n++){if(!(t>=1e4)){e=t.toFixed(1)+r[n];break}t/=1e3}return""===e&&(e=Math.floor(t)+"U"),e},e.isNewDay=function(t){var r=new Date(t),e=new Date,n=r.getYear(),o=r.getMonth(),a=r.getDate(),i=e.getYear(),u=e.getMonth(),f=e.getDate();return i>n||(u>o||f>a)},e.getPropertyCount=function(t){var r,e=0;for(r in t)t.hasOwnProperty(r)&&e++;return e},e.difference=function(t,r){var e=[];if(t.constructor!==Array||r.constructor!==Array)return e;for(var n=t.length,o=0;o<n;o++)-1===r.indexOf(t[o])&&e.push(t[o]);return e},e.trim=function(t){return t.replace(/(^\s*)|(\s*$)/g,"")},e.format=function(t,r){return t=t.replace(new RegExp("\\{0\\}","gm"),r)},e.format1=function(t,r){for(var e=r.length;e--;)t=t.replace(new RegExp("\\{"+e+"\\}","gm"),r[e]);return t},e.isNowValid=function(t,r){var e=new Date(t),n=new Date(r),o=!1;if(e.getDate()+""!="NaN"&&n.getDate()+""!="NaN"){var a=new Date;o=a<n&&a>e}return o},e.getDeltaDays=function(t,r){t=new Date(t),r=new Date(r);var e=t.getFullYear(),n=t.getMonth()+1,o=t.getDate(),a=r.getFullYear(),i=r.getMonth()+1,u=r.getDate();t=new Date(e+"/"+n+"/"+o+" GMT+0800").getTime();var f=(r=new Date(a+"/"+i+"/"+u+" GMT+0800").getTime())-t;return Math.floor(f/864e5)},e.getMin=function(t){var r=null;if(t.constructor===Array)for(var e=t.length,n=0;n<e;n++)r=0===n?Number(t[0]):r>Number(t[n])?Number(t[n]):r;return r},e.formatTwoDigits=function(t){return(Array(2).join(0)+t).slice(-2)},e.getDay=function(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},e.formatDate=function(t){var r=new Date(t);return r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()},e.formatTimeForMillisecond=function(t){var r=Math.floor(t/1e3%60),e=Math.floor(t/1e3/60%60);return{hour:Math.floor(t/1e3/60/60),minute:e,second:r}},e.rand=function(t){for(var r=this.clone(t),e=r.length-1;e>=0;e--){var n=Math.floor(Math.random()*(e+1)),o=r[n];r[n]=r[e],r[e]=o}return r},e.getOffsetMimutes=function(t,r){var e=r-t;return Math.floor(e%36e5/6e4)},e.formatNumToFixed=function(t,r){return void 0===r&&(r=0),Number(t.toFixed(r))},e.dayRemainingTime=function(){var t="",r="",e=(new Date).getTime(),n=new Date((new Date).toLocaleDateString()).getTime()+864e5-e,o=Math.floor(n/1e3%60);r=o>=10?o.toString():"0"+o;var a=Math.floor(n/1e3/60%60);t=a>=10?a.toString():"0"+a;var i=Math.floor(n/1e3/60/60);return[i>=10?i.toString():"0"+i,t,r]},e.lerp=function(t,r,e){void 0===e&&(e=.25);var n=r;return t>r?n=r+(t-r)*e:t<r&&(n=r-(r-t)*e),n},e.base64ToArrayBuffer=function(t){t.split(",");for(var r=atob(t),e=r.length,n=new Uint8Array(e),o=0;o<e;o++)n[o]=r.charCodeAt(o);return n.buffer},e.uint8arrayToBase64=function(t){for(var r,e=0,n=t.length,o="";e<n;)r=t.subarray(e,Math.min(e+32768,n)),o+=String.fromCharCode.apply(null,r),e+=32768;return btoa(o)},e.base64ToUint8Array=function(t){for(var r=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),e=window.atob(r),n=new Uint8Array(e.length),o=0;o<e.length;++o)n[o]=e.charCodeAt(o);return n},e.arrayBufferToBase64=function(t){for(var r="",e=new Uint8Array(t),n=e.byteLength,o=0;o<n;o++)r+=String.fromCharCode(e[o]);return window.btoa(r)},e.encrypt=function(t){var r=this._base64encode(t),e=6;r.length%2==0&&(e=7);for(var n="",o=0;o<(r.length-e+1)/2;o++)n+=r[2*o+1],n+=r[2*o];return n+=r.slice(r.length-e+1)},e.decrypt=function(t){var r=6;t.length%2==0&&(r=7);for(var e="",n=0;n<t.length-r;n+=2)e+=t[n+1],e+=t[n];return e+=t.slice(t.length-r+1),e=this._base64Decode(e)},e._base64encode=function(t){var r,e,n,o,a,i,u,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="",c=0;for(t=this._utf8Encode(t);c<t.length;)o=(r=t.charCodeAt(c++))>>2,a=(3&r)<<4|(e=t.charCodeAt(c++))>>4,i=(15&e)<<2|(n=t.charCodeAt(c++))>>6,u=63&n,isNaN(e)?i=u=64:isNaN(n)&&(u=64),h=h+f.charAt(o)+f.charAt(a)+f.charAt(i)+f.charAt(u);return h},e._utf8Encode=function(t){t=t.replace(/\r\n/g,"\n");for(var r="",e=0;e<t.length;e++){var n=t.charCodeAt(e);n<128?r+=String.fromCharCode(n):n>127&&n<2048?(r+=String.fromCharCode(n>>6|192),r+=String.fromCharCode(63&n|128)):(r+=String.fromCharCode(n>>12|224),r+=String.fromCharCode(n>>6&63|128),r+=String.fromCharCode(63&n|128))}return r},e._utf8Decode=function(t){for(var r="",e=0,n=0,o=0,a=0;e<t.length;)(n=t.charCodeAt(e))<128?(r+=String.fromCharCode(n),e++):n>191&&n<224?(o=t.charCodeAt(e+1),r+=String.fromCharCode((31&n)<<6|63&o),e+=2):(o=t.charCodeAt(e+1),a=t.charCodeAt(e+2),r+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&a),e+=3);return r},e._base64Decode=function(t){var r,e,n,o,a,i,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="",h=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<t.length;)r=u.indexOf(t.charAt(h++))<<2|(o=u.indexOf(t.charAt(h++)))>>4,e=(15&o)<<4|(a=u.indexOf(t.charAt(h++)))>>2,n=(3&a)<<6|(i=u.indexOf(t.charAt(h++))),f+=String.fromCharCode(r),64!=a&&(f+=String.fromCharCode(e)),64!=i&&(f+=String.fromCharCode(n));return f=this._utf8Decode(f)},e.checkTwoPosEulRad=function(t,r,e,n){return Math.atan2(t-e,r-n)},e.getTwoPosXZLength=function(t,r,e,n){var o=t-e,a=r-n;return Math.sqrt(o*o+a*a)},e.setStringToVec3=function(t){var r=t.split(",");return new n(Number(r[0]),Number(r[1]),Number(r[2]))},e.setStringToQuate=function(t){var r=t.split(",");return new o(Number(r[0]),Number(r[1]),Number(r[2]),Number(r[3]))},e.getRandomRange=function(t,r){return r?(Math.random()>.5?1:-1)*Math.random()*t:Math.random()*t},e.getDirectionOfDistanceX=function(t,r){return t*Math.sin(r)},e.getDirectionOfDistanceZ=function(t,r){return t*Math.cos(r)},e.angle_to_radian=function(t){return Math.PI/180*t},e.radian_to_angle=function(t){return 180/Math.PI*t},e.angle_to_vector=function(t){var r=this.angle_to_radian(t),e=Math.cos(r),n=Math.sin(r);return new a(e,n).normalize()},e.vector_to_angle=function(t){if(0==t.x&&0==t.y)return null;var r=i(t.x,t.y).normalize().signAngle(new a(1,0));return-this.radian_to_angle(r)},e.timeToString=function(t){var r=Math.floor(t/3600)<10?"0"+Math.floor(t/3600):Math.floor(t/3600),e=Math.floor(t/60%60)<10?"0"+Math.floor(t/60%60):Math.floor(t/60%60),n=Math.floor(t%60)<10?"0"+Math.floor(t%60):Math.floor(t%60);return"00"!=r?r+":"+e+":"+n:e+":"+n},e.timeToStrings=function(t){return(Math.floor(t/3600)<10?"0"+Math.floor(t/3600):Math.floor(t/3600))+":"+(Math.floor(t/60%60)<10?"0"+Math.floor(t/60%60):Math.floor(t/60%60))+":"+(Math.floor(t%60)<10?"0"+Math.floor(t%60):Math.floor(t%60))},e.getTimeToString=function(t){var r=Math.floor(t/3600)<10?"0"+Math.floor(t/3600):Math.floor(t/3600),e=Math.floor(t/60%60)<10?"0"+Math.floor(t/60%60):Math.floor(t/60%60),n=Math.floor(t%60)<10?"0"+Math.floor(t%60):Math.floor(t%60);return"00"!=r?r+"时"+e+"分":"00"!=e?e+"分"+n+"秒":n+"秒"},e.getTodayRemainingtime=function(){var t=(new Date).getTime(),r=(new Date((new Date).toLocaleDateString()).getTime()-t)/1e3/3600/24,e=24*(r-Math.floor(r)),n=Math.floor(e),o=60*(e-n),a=Math.floor(o),i=60*(o-a),u=Math.floor(i);return n>0?(n=n<10?"0"+n:n)+":"+(a=a<10?"0"+a:a)+":"+(u=u<10?"0"+u:u)+":":(a=a<10?"0"+a:a)+":"+(u=u<10?"0"+u:u)+":"},e.getMonthDay=function(){var t=new Date,r=t.getFullYear(),e=t.getMonth()+1;return new Date(r,e,0).getDate()},e.getMonth=function(){return(new Date).getMonth()+1},e.stringToColor=function(t){var r=this.hex2int(t[0],16)+this.hex2int(t[1],1),e=this.hex2int(t[2],16)+this.hex2int(t[3],1),n=this.hex2int(t[4],16)+this.hex2int(t[5],1);return new u(r,e,n,255)},e.hex2int=function(t,r){var e=t.charCodeAt(0);return 48<=e&&e<58?e-=48:e=(223&e)-65+10,e*r},e.getDateDetail=function(t){return new Date(1e3*t).toLocaleString()},e.parseTimeTwo=function(t){if(t){var r=new Date(1e3*t);return r.getFullYear()+"年"+(r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1)+"月"+(r.getDate()<10?"0"+r.getDate():r.getDate())+"日 "+(r.getHours()<10?"0"+r.getHours():r.getHours())+":"+(r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes())}return""},e.getCircleRandPoint=function(t,r){var e=r.x+2*(Math.random()-.5)*t,n=r.y+2*(Math.random()-.5)*t;return new a(e,n)},e.getCirclePoints=function(t,r,e,n,o){void 0===n&&(n=60),void 0===o&&(o=1);for(var i=[],u=o*(Math.PI/180)*Math.round(360/e),f=0;f<e;f++){var h=r.x+t*Math.sin(u*f),c=r.y+t*Math.cos(u*f);i.unshift(new a(h+Math.random()*n,c+Math.random()*n))}return i},e.getCircleRandomPoints=function(t,r,e,o){void 0===o&&(o=60);for(var a=[],i=Math.PI/180*Math.round(360/e),u=Math.random()*Math.PI,f=0;f<e;f++){var h=r.x+t*Math.sin(i*f+u),c=r.y+t*Math.cos(i*f+u);a.unshift(new n(h+Math.random()*o,c+Math.random()*o,0))}return a},e.getCirclePos=function(t,r,e){var o=Math.PI/180*e,a=r.y+t*Math.cos(o),i=r.x+t*Math.sin(o);return new n(a,i,0)},e.getUpDownRandomPoints=function(t,r,e,o){void 0===o&&(o=300);for(var a=[],i=0;i<e;i++){var u=Math.floor(100*Math.random())<=50?1:-1,f=2*(Math.random()-.5)*o,h=r.y+(t+60*Math.random())*u;a.unshift(new n(f,h,0))}return a},e.getLeftRightRectRandomPoints1=function(t,r,e,o,i,u){void 0===u&&(u=20);var h=[];t=o>i?i/2-u:o/2-u,t=o/2-u;for(var c=Math.PI/180*Math.round(360/e),g=Math.random()*Math.PI,l=new f(-o/2,-i/2,o,i),s=0,M=0;M<e;M++){var d=r.x+t*Math.sin(c*M+g),v=r.y+t*Math.cos(c*M+g),m=new a(d+Math.random()*u,v+Math.random()*u);if(l.contains(m))h.unshift(new n(m.x,m.y,0));else if(h.length){s=Math.floor(Math.random()*h.length);var y=this.clone(h[s]),w=new n(y.x+2*(Math.random()-.5)*20,y.y+2*(Math.random()-.5)*20,0);h.unshift(w)}else{t=i/2-u;var x=this.getCircleRandomPoints(t,new n(0,0,0),10,20);s=Math.floor(Math.random()*x.length),h.unshift(x[s])}}return h},e.uuid=function(){for(var t=[],r="0123456789abcdef",e=0;e<36;e++)t[e]=r.substr(Math.floor(16*Math.random()),1);t[14]="4",t[19]=r.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-";var n=t.join("");return n},e.getUuid=function(t){return Number(Math.random().toString().substr(2,t)+Date.now()).toString(36)},e.getMonthDays=function(t,r){return new Date(t,r,0).getDate()},e.getMonthDayMilliseconds=function(t,r){return new Date(t,r,1).getTime()},e.getDayHour=function(t){var r=new Date(t),e=r.getDate()<10?"0"+r.getDate():r.getDate(),n=r.getHours()<10?"0"+r.getHours():r.getHours();r.getMinutes(),r.getMinutes();return e+"天"+n+"时"},e.getWinSize=function(){return h.windowSize},e.getBezierPoint=function(t,r,e,n,o){var a=t.x*(1-o)*(1-o)*(1-o)+3*r.x*o*(1-o)*(1-o)+3*e.x*o*o*(1-o)+n.x*o*o*o,u=t.y*(1-o)*(1-o)*(1-o)+3*r.y*o*(1-o)*(1-o)+3*e.y*o*o*(1-o)+n.y*o*o*o;return i(a,u)},e.bezierTo=function(t,r,e,n,o,a){a=a||Object.create(null);return a.onUpdate=function(r,a){var i,u,f,h,g,l;t.position=(f=n,h=o,g=(1-(i=a))*(1-i)*(u=e).x+2*i*(1-i)*f.x+i*i*h.x,l=(1-i)*(1-i)*u.y+2*i*(1-i)*f.y+i*i*h.y,c(g,l,0))},g(t).to(r,{},a)},e.playTargetTween=function(t,r,e){return new Promise((function(e,n){var o=t.position,i=t.eulerAngles,u=g(o);new a;u.parallel(g().to(r,{x:-t.position.x},{progress:function(t,r,e,n){return d(t,100,200,r,n)},easing:"smooth",onUpdate:function(){t.setPosition(o)}}),g().to(r,{y:0},{progress:function(t,r,e,n){return d(t,100,200,r,n)},easing:"smooth",onUpdate:function(){t.setPosition(o)}})).start(),g(i).to(r,{z:360},{onUpdate:function(){t.eulerAngles=i}}).call((function(){e(1)})).start()}))},e.targetBezier=function(t,r,e,n,o,u,f,h){return new Promise((function(c,s){var M=new a(r.x,r.y);g({t:0}).to(n,{t:1},{onUpdate:function(n,c){var g=i(0,0),s=i(o,u),d=i(f,h),v=i(1,1),m=g.x*(1-c)*(1-c)*(1-c)+3*s.x*c*(1-c)*(1-c)+3*d.x*c*c*(1-c)+v.x*c*c*c,y=g.y*(1-c)*(1-c)*(1-c)+3*s.y*c*(1-c)*(1-c)+3*d.y*c*c*(1-c)+v.y*c*c*c,w=(e.x-r.x)*m+r.x,x=(e.y-r.y)*y+r.y,D=new a(w,x);t.setPosition(w,x);var p=new a;a.subtract(p,D,M);var C=p.signAngle(i(0,1)),b=l.radiansToDegrees(C);t.angle=-b,M=D.clone()}}).call((function(){c(1)})).start()}))},e.targetScaleBezier=function(t,r,e,n,o,a,u,f,h,c){return new Promise((function(l,s){var M=g(t).to(o,{t:1},{onUpdate:function(t,o){var a=i(0,0),g=i(u,f),l=i(h,c),s=i(1,1),M=a.x*(1-o)*(1-o)*(1-o)+3*g.x*o*(1-o)*(1-o)+3*l.x*o*o*(1-o)+s.x*o*o*o,d=a.y*(1-o)*(1-o)*(1-o)+3*g.y*o*(1-o)*(1-o)+3*l.y*o*o*(1-o)+s.y*o*o*o,v=(n.x-e.x)*M+e.x,m=(n.y-e.y)*d+e.y;r.setPosition(v,m)}}),d=g(t).to(o,{scale:a},{onUpdate:function(t,e){r.setScale(t.scale,t.scale,t.scale)}});g(t).parallel(M,d).call((function(){l(1)})).start()}))},e.PFromC=function(t){for(var r=0,e=0,n=0,o=Math.ceil(1/t),a=1;a<=o;++a)e+=r=Math.min(1,a*t)*(1-e),n+=a*r;return 1/n},e.CFromP=function(t){for(var r=t,e=0,n=t,o=1;;){n=(r+e)/2;var a=this.PFromC(n);if(Math.abs(a-o)<=5e-5)break;a>t?r=n:e=n,o=a}return n},e.segmentsIntr=function(t,r,e,n){var o=(t.x-e.x)*(r.y-e.y)-(t.y-e.y)*(r.x-e.x),a=(t.x-n.x)*(r.y-n.y)-(t.y-n.y)*(r.x-n.x);if(o*a>=0)return!1;var u=(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x);if(u*(u+o-a)>=0)return!1;var f=u/(a-o),h=f*(r.x-t.x),c=f*(r.y-t.y);return i(t.x+h,t.y+c)},e.bezier_length=function(t,r,e,n,o){for(var i=t,u=0,f=.05,h=0;h<20;h++){var c=t.x*(1-f)*(1-f)*(1-f)+3*r.x*f*(1-f)*(1-f)+3*e.x*f*f*(1-f)+n.x*f*f*f,g=t.y*(1-f)*(1-f)*(1-f)+3*r.y*f*(1-f)*(1-f)+3*e.y*f*f*(1-f)+n.y*f*f*f,l=new a(c,g),s=l.subtract(i);i=l,u+=s.length(),f+=.05}return u},e.weightRandomIdx=function(t){if(t.length<=1)return 0;for(var r=0,e=0;e<t.length;e++)r+=t[e];for(var n=Math.random()*r,o=0,a=0,i=0;i<t.length;i++){if(a=o+t[i],o<n&&n<=a)return i;o=a}return 0},e.numMoveZoro=function(t){return t.indexOf(".")<0||"."==(t=t.replace(/0+?$/g,""))[t.length-1]&&(t=t.replace(/[.$]/,"")),t},e.getRectRandPos=function(t){var r=new n,e=Math.random()*t.width,o=Math.random()*t.height;return r.x=t.x+e,r.y=t.y+o,r},e.adapterScale=function(){var t=s.getDesignResolutionSize();return s.getVisibleSize().width/t.width},e}(M));e._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponBgItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameEvent.ts","./EventListener.ts","./ResourcesUtil.ts","./BaseComponent.ts","./WeaponData.ts","./GridData.ts","./Constants.ts"],(function(t){var n,e,i,o,s,a,c,h,r,u,p,_,f,l,T,d,C,E,g,S,A,v;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,s=t.createClass},function(t){a=t.cclegacy,c=t._decorator,h=t.Sprite,r=t.UITransform,u=t.Layout,p=t.instantiate,_=t.UIOpacity,f=t.Vec3,l=t.v2},function(t){T=t.GameEvent},function(t){d=t.EventListener},function(t){C=t.ResourcesUtil},function(t){E=t.default},function(t){g=t.WeaponData},function(t){S=t.GridData,A=t.GridObj},function(t){v=t.Constants}],execute:function(){var m,y,w,G,N;a._RF.push({},"f96cd2ocN1Av7siZ2Mlbz07","WeaponBgItem",void 0);var O=c.ccclass,D=c.property,R=(t("WeaponBgItem",(m=O("WeaponItem"),y=D(h),m((N=n((G=function(t){function n(){for(var n,e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return n=t.call.apply(t,[this].concat(s))||this,i(n,"icon",N,o(n)),n._touchStatus=0,n._weaponKey="",n._weaponCfg=null,n._point=null,n._pointGridObj=[],n._placeStatus=!0,n._isTouch=!1,n}e(n,t);var a=n.prototype;return a.init=function(t,n,e){this._pointGridObj=[],this._placeStatus=e,this._weaponKey=n,this._weaponCfg=t,this._point=this.node.getChildByName("point"),this.initWeaponSize(),this.setPointPosArr(),this.setGridIcon(),this.setNodeAngel()},a.initWeaponSize=function(){var t=this._weaponCfg.Type.split("_"),n=Number(t[1]),e=Number(t[0]),i=S.instance.getGridSizeByRowCol(n,e),o=S.instance.iconScale;this.node.getComponent(r).setContentSize(i),this.point.setPosition(-i.width/2,i.height/2),this.icon.node.setScale(o,o,o)},a.setPointPosArr=function(){this._pointGridObj=[];for(var t=this._weaponCfg.Points,n=0;n<t.length;n++)for(var e=t[n],i=0;i<e.length;i++){if(e[i]){var o=new A;o.row=n,o.col=i,this._pointGridObj.push(o)}}},a.setGridIcon=function(){var t=this,n=v.weaponIconPath+this.weaponCfg.Res+"/spriteFrame";C.getSpriteFrame(n).then((function(n){t.icon.spriteFrame=n;var e=t.icon.node.parent,i=t.weaponCfg.Type.split("_"),o=S.instance.getGridSizeByRowCol(Number(i[1]),Number(i[0])),s=t.weaponCfg.Points;e.getComponent(u).spacingX=S.instance.space,e.getComponent(u).spacingY=S.instance.space,e.getComponent(r).width=o.width,e.getComponent(u).updateLayout(!0);for(var a=0;a<s.length;a++)for(var c=s[a],h=0;h<c.length;h++){var f=c[h],l=p(t.icon.node);l.active=!0,l.parent=e,l.getComponent(_).opacity=f?255:0}}))},a.setNodeAngel=function(){var t=this._placeStatus?0:10;this.node.angle=t},a.onGridRemove=function(t){this.weaponKey==t&&(d.emit(T.ADD_REMOVE_WEAPON_LIST,this.node),this.placeStatus=!1,this.setNodeAngel())},a.onPlaceFinish=function(){d.emit(T.PLACE_GRID_END,this)},a.onTouchStart=function(t){var n=this.point.getComponent(r).convertToNodeSpaceAR(new f(t.x,t.y,0));if(S.instance.checkPointinGrid(l(n.x,n.y),this._pointGridObj)&&!g.instance.isSelect){this._isTouch=!0,g.instance.isSelect=!0,this._touchStatus=R.START,this.placeStatus=!0,this.setNodeAngel(),d.emit(T.PLACE_GRID_START,this);var e=this.node.parent.getComponent(r).convertToNodeSpaceAR(new f(t.x,t.y,0));this.node.setPosition(e.x,e.y)}},a.onTouchMove=function(t){if(this._isTouch){this._touchStatus=R.MOVE;var n=this.node.parent.getComponent(r).convertToNodeSpaceAR(new f(t.x,t.y,0));this.node.setPosition(n.x,n.y),d.emit(T.PLACE_GRID_MOVE,this)}},a.onTouchEnd=function(t){this._isTouch&&(this._isTouch=!1,g.instance.isSelect=!1,this.onPlaceFinish(),this._touchStatus=R.END)},a.onTouchCancle=function(t){this._isTouch&&(this._isTouch=!1,g.instance.isSelect=!1,this._touchStatus=R.CANCEL,d.emit(T.ADD_REMOVE_WEAPON_LIST,this.node))},a.onEnable=function(){d.on(T.GAME_TOUCH_START,this.onTouchStart,this),d.on(T.GAME_TOUCH_MOVE,this.onTouchMove,this),d.on(T.GAME_TOUCH_END,this.onTouchEnd,this),d.on(T.GAME_TOUCH_CANCLE,this.onTouchEnd,this)},a.onDisable=function(){d.off(T.GAME_TOUCH_START,this.onTouchStart,this),d.off(T.GAME_TOUCH_MOVE,this.onTouchMove,this),d.off(T.GAME_TOUCH_END,this.onTouchEnd,this),d.off(T.GAME_TOUCH_CANCLE,this.onTouchEnd,this)},s(n,[{key:"point",get:function(){return this._point}},{key:"weaponCfg",get:function(){return this._weaponCfg}},{key:"weaponKey",get:function(){return this._weaponKey}},{key:"placeStatus",set:function(t){this._placeStatus=t}}]),n}(E)).prototype,"icon",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=G))||w)),t("TouchStatus",function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.START=1]="START",t[t.MOVE=2]="MOVE",t[t.END=3]="END",t[t.CANCEL=4]="CANCEL",t}({})));a._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CfgMgr.ts","./Util.ts","./WeaponModel.ts"],(function(t){var e,n,a,i,r;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy},function(t){a=t.CfgMgr},function(t){i=t.Util},function(t){r=t.WeaponCfg}],execute:function(){n._RF.push({},"91348VvqW5Bi6q8SBb34d+V","WeaponData",void 0),t("WeaponData",function(){function t(){this._isSelect=!1,this._weaponCfgMapData=new Map,this._weaponGridData=new Map}var n=t.prototype;return n.init=function(){for(var t=a.getCfgDataArray(new r),e=0;e<t.length;e++){var n=t[e];if(n.itemType){var i=n.weaponGroupNum+"|"+n.Level;this._weaponCfgMapData.set(i,n)}else this._weaponGridData.set(n.Id,n)}},n.getWeaponCfgByLevel=function(t,e){var n=e+"|"+t;return this._weaponCfgMapData.get(n)},n.checkWeaponByLevel=function(t,e){var n=e+"|"+t;return!!this._weaponCfgMapData.has(n)},n.getWeaponCfgById=function(t){return a.getDataById(new r,t)},n.getWeaponCfgData=function(){for(var t=[],e=a.getCfgDataArray(new r),n=0;n<e.length;n++){var i=e[n];i.itemType&&t.push(i)}return t},n.getWeaponPool=function(){for(var t=[],e=i.rand(this.getWeaponCfgData()),n=0;n<e.length;n++){var a=e[n];if(1==a.Level&&a.itemType&&(t.push(a.Id),3==t.length))break}return t},n.countRegionOccurrences=function(t,e){for(var n=0,a=e.length,i=e[0].length,r=0;r<=t.length-a;r++)for(var o=0;o<=t[0].length-i;o++){for(var s=!0,c=0;c<a;c++){for(var u=0;u<i;u++)if(t[r+c][o+u]!==e[c][u]){s=!1;break}if(!s)break}s&&n++}return n},n.getPlaceGridIdByWeigh=function(t){var e=this,n=[];this._weaponGridData.size&&this._weaponGridData.forEach((function(a,i){e.countRegionOccurrences(t,a.Points)&&n.push(a)}));var a=0;if(n.length){for(var i=0,r=0,o=0,s=0;s<n.length;s++){o+=n[s].options_num}var c=Math.floor(Math.random()*o),u=0;n.some((function(t,e){if(r=i+t.options_num,c>=i&&c<r)return u=e,!0;i=r})),a=n[u].Id}return a},n.clear=function(){this._isSelect=!1},e(t,[{key:"isSelect",get:function(){return this._isSelect},set:function(t){this._isSelect=t}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=null;t("CoinObj",(function(){this.wpos=void 0,this.num=void 0}));n._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponDetailPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constants.ts","./PopupManager.ts","./ResourcesUtil.ts","./SkillData.ts","./GameDefine.ts"],(function(e){var n,t,i,o,a,r,l,u,c,p,s,f,h,m;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,l=e.Sprite,u=e.Label,c=e.Component},function(e){p=e.Constants},function(e){s=e.PopupManager},function(e){f=e.ResourcesUtil},function(e){h=e.SkillData},function(e){m=e.GameDefine}],execute:function(){var g,v,b,y,D,P,d,I,S;a._RF.push({},"53b5dmI111O3KHnPNMMZrj5","WeaponDetailPopup",void 0);var W=r.ccclass,w=r.property;e("WeaponDetailPopup",(g=W("WeaponDetailPopup"),v=w(l),b=w(u),y=w(u),g((d=n((P=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a))||this,i(n,"icon",d,o(n)),i(n,"iconName",I,o(n)),i(n,"level",S,o(n)),n}t(n,e);var a=n.prototype;return a.show=function(e){m.gameTouch=!1,this.setWeaponInfo(e)},a.setWeaponInfo=function(e){var n=this,t=e.SkillId,i=(h.instance.getSkillCfgById(t),p.weaponIconPath+e.Res+"/spriteFrame");this.iconName.string=e.Name,this.level.string="Lv."+e.Level,f.geSpriteFrame(i).then((function(e){n.icon.spriteFrame=e}))},a.onCloseBtn=function(){m.gameTouch=!0,s.instance.hide(p.PopupUI.WeaponDetailPopup)},n}(c)).prototype,"icon",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(P.prototype,"iconName",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=n(P.prototype,"level",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=P))||D));a._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameEvent.ts","./EventListener.ts","./ResourcesUtil.ts","./BaseComponent.ts","./WeaponData.ts","./SynItem.ts","./GridData.ts","./Constants.ts","./AudioManager.ts","./OpenPopupManager.ts"],(function(t){var n,e,o,i,s,a,h,r,c,u,p,f,l,_,S,E,T,g,A,d,C,P,v,O,w,m,y,N,I;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized,s=t.createClass},function(t){a=t.cclegacy,h=t._decorator,r=t.Label,c=t.Sprite,u=t.ProgressBar,p=t.UITransform,f=t.v3,l=t.Color,_=t.Tween,S=t.tween,E=t.instantiate,T=t.Vec3,g=t.v2},function(t){A=t.GameEvent},function(t){d=t.EventListener},function(t){C=t.ResourcesUtil},function(t){P=t.default},function(t){v=t.WeaponData},function(t){O=t.SynItem},function(t){w=t.GridData,m=t.GridObj},function(t){y=t.Constants},function(t){N=t.AudioManager},function(t){I=t.OpenPopupManager}],execute:function(){var W,b,R,D,M,G,U,L,B,k,H;a._RF.push({},"25dfdn2NRZPKLZpIOwY85wi","WeaponItem",void 0);var K=h.ccclass,V=h.property,z=(t("WeaponItem",(W=K("WeaponItem"),b=V(r),R=V(c),D=V(c),M=V(u),W((L=n((U=function(t){function n(){for(var n,e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return n=t.call.apply(t,[this].concat(s))||this,o(n,"level",L,i(n)),o(n,"icon",B,i(n)),o(n,"bar",k,i(n)),o(n,"progressBar",H,i(n)),n._touchStatus=0,n._weaponKey="",n._weaponCfg=null,n._point=null,n._pointGridObj=[],n._isShake=!1,n._placeStatus=!0,n._isTouch=!1,n}e(n,t);var a=n.prototype;return a.init=function(t,n,e){this._pointGridObj=[],this._placeStatus=e,this._weaponKey=n,this._weaponCfg=t,this._isShake=!1,this._point=this.node.getChildByName("point"),this.level.string="Lv"+t.Level,this.progressBar.progress=0,this.initWeaponSize(),this.setPointPosArr(),this.setWeaponIcon(),this.setNodeAngel()},a.initWeaponSize=function(){var t=this._weaponCfg.Type.split("_"),n=Number(t[1]),e=Number(t[0]),o=w.instance.getGridSizeByRowCol(n,e),i=w.instance.iconScale;this.node.getComponent(p).setContentSize(o),this.point.setPosition(-o.width/2,o.height/2),this.icon.node.setScale(i,i,i)},a.setPointPosArr=function(){this._pointGridObj=[];for(var t=this._weaponCfg.Points,n=0;n<t.length;n++)for(var e=t[n],o=0;o<e.length;o++){if(e[o]){var i=new m;i.row=n,i.col=o,this._pointGridObj.push(i)}}},a.setWeaponIcon=function(){var t=this,n=y.weaponIconPath+this.weaponCfg.Res+"/spriteFrame";C.geSpriteFrame(n).then((function(n){t.icon.spriteFrame=n,t.bar.spriteFrame=n;var e=t.icon.getComponent(p).contentSize;t.bar.node.setPosition(f(0,-e.height/2,0))}))},a.setBuildWeaponPos=function(t,n){this._weaponKey==t&&this.node.setPosition(n)},a.setIconYellow=function(){this.icon.getComponent(c).color=(new l).fromHEX("dbc464")},a.setIconDefault=function(){this.icon.getComponent(c).color=(new l).fromHEX("ffffff")},a.onSetIconStatus=function(t,n){this.weaponKey==t&&(n?this.setIconYellow():this.setIconDefault())},a.setNodeAngel=function(){var t=this._placeStatus?0:10;this.node.angle=t},a.onUpdateProgressBar=function(t,n){this.weaponKey==n&&(this.progressBar.progress=t)},a.onSetStatusInit=function(){this.setIconDefault(),this._isShake=!1,_.stopAllByTarget(this.icon.node)},a.onSetIconShake=function(t){if(this.weaponKey==t&&!this._isShake){this._isShake=!0;var n=.1;this.icon.node.setPosition(0,0,0),S(this.icon.node).by(n,{position:f(-5,0,0)}).by(n,{position:f(5,0,0)}).by(n,{position:f(5,0,0)}).by(n,{position:f(-5,0,0)}).union().repeatForever().start()}},a.onPenWeaponPopup=function(){if(this._touchStatus==z.START)y.itemPath,this.weaponCfg.Res},a.onWeaponRemove=function(t){this.weaponKey==t&&(d.emit(A.ADD_REMOVE_WEAPON_LIST,this.node),this.placeStatus=!1,this.setNodeAngel())},a.onWeapoPreRemove=function(){this._touchStatus==z.START&&(d.emit(A.ADD_PRE_WEAPON_LIST,this.node),this.placeStatus=!0,this.setNodeAngel())},a.onPlaceFinish=function(){this._touchStatus==z.MOVE&&d.emit(A.WEAPON_PlACE,this)},a.onWeaponUpgrade=function(t,n){if(this._weaponKey==t){var e=this._weaponCfg.Level+1,o=this._weaponCfg.weaponGroupNum;this._weaponCfg=v.instance.getWeaponCfgByLevel(e,o),this.level.string="Lv"+this._weaponCfg.Level,w.instance.updateGridItemData(t,this._weaponCfg.Id),this.setSynEffect(),this.setWeaponIcon()}},a.setSynEffect=function(){var t=this,n=y.synPath;C.getPrefab(n).then((function(n){N.instance.playSound(4);var e=E(n);e.parent=t.node,e.getComponent(O).init()}))},a.onTouchStart=function(t){var n=this.point.getComponent(p).convertToNodeSpaceAR(new T(t.x,t.y,0));!w.instance.checkPointinGrid(g(n.x,n.y),this._pointGridObj)||v.instance.isSelect||w.instance.gridEditMode||(this._isTouch=!0,v.instance.isSelect=!0,this._touchStatus=z.START)},a.onTouchMove=function(t){if(this._isTouch){this.onWeapoPreRemove(),this._touchStatus=z.MOVE;var n=this.node.parent.getComponent(p).convertToNodeSpaceAR(new T(t.x,t.y,0));this.node.setPosition(n),d.emit(A.WEAPON_MOVE,this)}},a.onTouchEnd=function(t){this._isTouch&&(this._touchStatus==z.START&&I.instance.showWeaponDetailPopup(this.weaponCfg),this._isTouch=!1,v.instance.isSelect=!1,this.onPenWeaponPopup(),this.onPlaceFinish(),this._touchStatus=z.END)},a.onTouchCancle=function(t){this._isTouch&&(this._isTouch=!1,v.instance.isSelect=!1,this._touchStatus=z.CANCEL,d.emit(A.ADD_REMOVE_WEAPON_LIST,this.node),d.emit(A.SET_BATTLE_BTN_STATUS))},a.onEnable=function(){d.on(A.GAME_TOUCH_START,this.onTouchStart,this),d.on(A.GAME_TOUCH_MOVE,this.onTouchMove,this),d.on(A.GAME_TOUCH_END,this.onTouchEnd,this),d.on(A.GAME_TOUCH_CANCLE,this.onTouchEnd,this),d.on(A.WEAPON_REMOVE,this.onWeaponRemove,this),d.on(A.WEAPON_ICON_STATUS,this.onSetIconStatus,this),d.on(A.WEAPON_ICON_STATUS_INIT,this.onSetStatusInit,this),d.on(A.WEAPON_SHAKE,this.onSetIconShake,this),d.on(A.WEAPON_UPGRADE,this.onWeaponUpgrade,this)},a.onDisable=function(){d.off(A.GAME_TOUCH_START,this.onTouchStart,this),d.off(A.GAME_TOUCH_MOVE,this.onTouchMove,this),d.off(A.GAME_TOUCH_END,this.onTouchEnd,this),d.off(A.GAME_TOUCH_CANCLE,this.onTouchEnd,this),d.off(A.WEAPON_REMOVE,this.onWeaponRemove,this),d.off(A.WEAPON_ICON_STATUS,this.onSetIconStatus,this),d.off(A.WEAPON_ICON_STATUS_INIT,this.onSetStatusInit,this),d.off(A.WEAPON_SHAKE,this.onSetIconShake,this),d.off(A.WEAPON_UPGRADE,this.onWeaponUpgrade,this)},s(n,[{key:"point",get:function(){return this._point}},{key:"weaponCfg",get:function(){return this._weaponCfg}},{key:"weaponKey",get:function(){return this._weaponKey}},{key:"placeStatus",set:function(t){this._placeStatus=t}}]),n}(P)).prototype,"level",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(U.prototype,"icon",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=n(U.prototype,"bar",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=n(U.prototype,"progressBar",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=U))||G)),t("TouchStatus",function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.START=1]="START",t[t.MOVE=2]="MOVE",t[t.END=3]="END",t[t.CANCEL=4]="CANCEL",t}({})));a._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GridData.ts","./ResourcesUtil.ts","./WeaponData.ts","./EventListener.ts","./GameEvent.ts","./Util.ts","./Constants.ts","./WeaponItem.ts","./WeaponBgItem.ts"],(function(e){var n,t,o,i,a,s,r,p,c,l,h,u,d,f,v,m,g,W,L,P,E,A,I,y;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,s=e._decorator,r=e.Node,p=e.instantiate,c=e.UITransform,l=e.v3,h=e.Layout,u=e.Intersection2D,d=e.v2,f=e.Component},function(e){v=e.GridData},function(e){m=e.ResourcesUtil},function(e){g=e.WeaponData,W=e.CoinObj},function(e){L=e.EventListener},function(e){P=e.GameEvent},function(e){E=e.Util},function(e){A=e.Constants},function(e){I=e.WeaponItem},function(e){y=e.WeaponBgItem}],execute:function(){var _,w,R,C,O,N,T,D,b;a._RF.push({},"89793GPOqNFqIh+e1RC7vod","WeaponManager",void 0);var S=s.ccclass,B=s.property;e("WeaponManager",(_=S("WeaponManager"),w=B(r),R=B(r),C=B(r),_((T=n((N=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=e.call.apply(e,[this].concat(a))||this,o(n,"weaponList",T,i(n)),o(n,"preWeaponList",D,i(n)),o(n,"removeWeaponList",b,i(n)),n}t(n,e);var a=n.prototype;return a.init=function(){g.instance.init(),this.initWeaponListPos(),this.initWeaponList(),this.initRemoveWeaponList()},a.initWeaponListPos=function(){var e=v.instance.getGridMapSize();this.weaponList.setPosition(-e.width/2,e.height/2),this.preWeaponList.setPosition(-e.width/2,e.height/2)},a.initWeaponList=function(){var e=this;v.instance.getGridItemMapData().forEach((function(n,t){var o=n.data,i=g.instance.getWeaponCfgById(n.wid),a=(i.Type,A.weaponPath),s=v.instance.getItemPosByTiledObj(o);m.getPrefab(a).then((function(n){var o=p(n);o.parent=e.weaponList,o.setPosition(s),o.getComponent(I).init(i,t,!0)}))}))},a.initRemoveWeaponList=function(){var e=this;this.removeWeaponList.removeAllChildren();var n=g.instance.getWeaponPool(),t=this.getPlaceGridId();if(t){var o=Math.floor(Math.random()*n.length);n.splice(o,1,t)}for(var i=function(){var t=g.instance.getWeaponCfgById(n[a]),o=E.getUuid(10),i=t.itemType?A.weaponPath:A.weaponBgPath;m.getPrefab(i).then((function(n){var i=p(n);i.parent=e.removeWeaponList,t.itemType?i.getComponent(I).init(t,o,!1):i.getComponent(y).init(t,o,!1),e.updateRemoveLayOut()}))},a=0;a<n.length;a++)i()},a.getPlaceGridId=function(){for(var e=v.instance.bagCfg.max_gridLen.split("_"),n=Number(e[0]),t=Number(e[1]),o=[],i=0;i<n;i++){for(var a=[],s=0;s<t;s++)a.push(1);o.push(a)}for(var r=v.instance.getGridMapData(),p=0;p<r.length;p++)for(var c=r[p],l=0;l<c.length;l++){c[l]&&(o[p][l]=0)}return g.instance.getPlaceGridIdByWeigh(o)},a.onRebuildWeaponPos=function(){var e=this;v.instance.getGridItemMapData().forEach((function(n,t){for(var o=n.data,i=v.instance.getItemPosByTiledObj(o),a=e.weaponList.children,s=0;s<a.length;s++){a[s].getComponent(I).setBuildWeaponPos(t,i)}}))},a.showFlyGoldAnim=function(){if(this.removeWeaponList.children.length)for(var e=this.removeWeaponList.children,n=0;n<e.length;n++){var t=e[n],o=new W;o.wpos=t.getComponent(c).convertToWorldSpaceAR(l(0,0,0)),o.num=E.getRandomInt(5,10),L.emit(P.WEAPON_CHANGE_COIN,o)}},a.showHideRemoveList=function(e){this.removeWeaponList.active=e},a.updateRemoveLayOut=function(){var e=this.removeWeaponList.children.length,n=0-10*(e-3>0?e-3:0);this.removeWeaponList.getComponent(h).spacingX=n,this.removeWeaponList.getComponent(h).updateLayout(!0)},a.onAddRemoveWeaponList=function(e){e.parent=this.removeWeaponList,this.updateRemoveLayOut()},a.onAddPreWeaponList=function(e){e.parent=this.preWeaponList},a.onWeaponPlace=function(e){var n=v.instance.curWeaponTildeIndex;if(n.includes(-1))this.removeSynAction(e);else{for(var t=!1,o="",i=0,a=[],s=[],r=0;r<n.length;r++){var p=n[r],c=v.instance.getGridTiledByIndex(p),l=v.instance.getGridMapData();if(s.push(c),l[c.row][c.col]){t||(t=!0);var h=l[c.row][c.col];a.push(h),v.instance.checkSameWeapoIdByKey(h,e.weaponCfg.Id)&&(i++,o=h)}}if(t){var u=e.weaponCfg.Level,d=e.weaponCfg.weaponGroupNum;i==n.length&&g.instance.checkWeaponByLevel(u+1,d)?(e.node.removeFromParent(),L.emit(P.WEAPON_UPGRADE,o,!0)):(this.weaponRemove(a),this.weaponPlace(e,s))}else this.weaponPlace(e,s)}L.emit(P.SET_BATTLE_BTN_STATUS),L.emit(P.WEAPON_ICON_STATUS_INIT)},a.weaponRemove=function(e){for(var n=0;n<e.length;n++){var t=e[n];v.instance.deletGridDataByWeaponId(t),L.emit(P.WEAPON_REMOVE,t)}},a.removeSynAction=function(e){for(var n=e.node.getPosition(),t=!1,o="",i=this.removeWeaponList.children,a=0;a<i.length;a++){var s=i[a];if(s.getComponent(I)){var r=s.getChildByName("icon").getComponent(c).convertToWorldSpaceAR(l(0,0,0)),p=this.preWeaponList.getComponent(c).convertToNodeSpaceAR(r);if(u.circleCircle(d(n.x,n.y),100,d(p.x,p.y),100)){var h=s.getComponent(I),f=e.weaponCfg.Level,v=e.weaponCfg.weaponGroupNum;e.weaponCfg.Id==h.weaponCfg.Id&&g.instance.checkWeaponByLevel(f+1,v)&&(t=!0,o=h.weaponKey)}}}t?(e.node.removeFromParent(),L.emit(P.WEAPON_UPGRADE,o,!1)):(e.node.parent=this.removeWeaponList,e.placeStatus=!1,e.setNodeAngel(),this.updateRemoveLayOut())},a.weaponPlace=function(e,n){e.node.parent=this.weaponList,v.instance.addGridDataByWeaponId(n,e.weaponCfg.Id,e.weaponKey);var t=v.instance.getItemPosByTiledObj(n);e.node.setPosition(t),e.placeStatus=!0,e.setNodeAngel()},a.onEnable=function(){L.on(P.ADD_REMOVE_WEAPON_LIST,this.onAddRemoveWeaponList,this),L.on(P.ADD_PRE_WEAPON_LIST,this.onAddPreWeaponList,this),L.on(P.WEAPON_PlACE,this.onWeaponPlace,this),L.on(P.WEAPON_REMOVE_REFRESH,this.initRemoveWeaponList,this),L.on(P.INIT_BUILD_WEAPON_POS,this.onRebuildWeaponPos,this)},a.onDisable=function(){L.off(P.ADD_REMOVE_WEAPON_LIST,this.onAddRemoveWeaponList,this),L.off(P.ADD_PRE_WEAPON_LIST,this.onAddPreWeaponList,this),L.off(P.WEAPON_PlACE,this.onWeaponPlace,this),L.off(P.WEAPON_REMOVE_REFRESH,this.initRemoveWeaponList,this),L.off(P.INIT_BUILD_WEAPON_POS,this.onRebuildWeaponPos,this)},a.clear=function(){g.instance.clear()},n}(f)).prototype,"weaponList",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(N.prototype,"preWeaponList",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=n(N.prototype,"removeWeaponList",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=N))||O));a._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponModel.ts",["cc"],(function(i){var o;return{setters:[function(i){o=i.cclegacy}],execute:function(){o._RF.push({},"cef42/LHrdNd5rGXORftRTM","WeaponModel",void 0);i("WeaponCfg",(function(){this.ClassName="Weapon",this.Id=void 0,this.Name=void 0,this.Res=void 0,this.weaponGroupNum=void 0,this.itemType=void 0,this.Type=void 0,this.SkillId=void 0,this.Level=void 0,this.Points=void 0,this.options_num=void 0}));o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});